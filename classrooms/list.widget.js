System.register(["@beyond-js/widgets@1.1.0/render","@beyond-js/kernel@0.1.9/bundle","@beyond-js/kernel@0.1.9/styles","@beyond-js/react-18-widgets@1.1.2/page","@beyond-js/reactive@1.2.0/model","@aimpact/ailearn-sdk@1.0.0/core","@aimpact/ailearn-app@0.1.6-dev.21/model/gclassroom","@beyond-js/kernel@0.1.9/texts","react@18.3.1","pragmate-ui@1.0.0-beta.6/list","@aimpact/ailearn-app@0.1.6-dev.21/components/ui","pragmate-ui@1.0.0-beta.6/icons","pragmate-ui@1.0.0-beta.6/components","@beyond-js/react-18-widgets@1.1.2/hooks","@aimpact/ailearn-app@0.1.6-dev.21/components/icons","@aimpact/chat-sdk@1.1.0/session","pragmate-ui@1.0.0-beta.6/alert","pragmate-ui@1.0.0-beta.6/modal","pragmate-ui@1.0.0-beta.6/toast"],function(s,e){"use strict";var t,a,n,o,r,i,l,c,m,d,u,p,f,g,h,v,y,E,x,w,_;return s({Controller:void 0,View:void 0}),{setters:[function(e){t=e},function(e){a=e},function(e){n=e},function(e){o=e},function(e){r=e},function(e){i=e},function(e){l=e},function(e){c=e},function(e){m=e},function(e){d=e},function(e){u=e},function(e){p=e},function(e){f=e},function(e){g=e},function(e){h=e},function(e){v=e},function(e){y=e},function(e){E=e},function(e){x=e}],execute:function(){_=a.Bundle,(w=new _({module:{vspecifier:"@aimpact/ailearn-app@0.1.6-dev.21/classrooms/list",multibundle:!0},type:"widget"},e.meta.url).package()).dependencies.update([["@beyond-js/widgets/render",t],["@beyond-js/kernel/styles",n],["@beyond-js/react-18-widgets/page",o],["@beyond-js/reactive/model",r],["@aimpact/ailearn-sdk/core",i],["@aimpact/ailearn-app/model/gclassroom",l],["@beyond-js/kernel/texts",c],["react",m],["pragmate-ui/list",d],["@aimpact/ailearn-app/components/ui",u],["pragmate-ui/icons",p],["pragmate-ui/components",f],["@beyond-js/react-18-widgets/hooks",g],["@aimpact/ailearn-app/components/icons",h],["@aimpact/chat-sdk/session",v],["pragmate-ui/alert",y],["pragmate-ui/modal",E],["pragmate-ui/toast",x]]),brequire("@beyond-js/widgets/render").widgets.register([{name:"ailearn-classroom-list",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.21/classrooms/list.widget",is:"page",route:"/classrooms/list",layout:"main-layout"}]),brequire("@beyond-js/kernel/styles").styles.register("@aimpact/ailearn-app@0.1.6-dev.21/classrooms/list.widget"),(_=new Map).set("./controller",{hash:483575597,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Controller=void 0;var a=e("@beyond-js/react-18-widgets/page"),s=e("./views"),n=e("./store");class o extends a.PageReactWidgetController{#store;createStore(){return this.#store=new n.StoreManager,this.#store}show(){this.#store.load()}get Widget(){return s.View}}t.Controller=o}}),_.set("./store",{hash:3568241119,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.StoreManager=void 0;var a=e("@beyond-js/reactive/model"),s=e("@aimpact/ailearn-sdk/core"),n=e("@aimpact/ailearn-app/model/gclassroom"),o=e("@beyond-js/kernel/texts"),r=e("beyond_context");class i extends a.ReactiveModel{#items=[];get items(){return this.#items}#model;get model(){return this.#model}get gItems(){return 0<n.gclassroom.error.code?[]:n.gclassroom.classes.values().map(e=>({...e,imported:this.model.googleClassroomsIds.has(e.id)}))}#texts=new o.CurrentTexts(r.module.specifier);get texts(){return this.#texts?.value}get ready(){return super.ready&&this.#texts.ready}#itemsSelected=new Map;get itemsSelected(){return this.#itemsSelected}constructor(){super(),this.#model=new s.Classrooms,this.#texts.on("change",this.triggerEvent),this.model.on("change",this.triggerEvent),n.gclassroom.on("change",this.triggerEvent)}async load(){try{this.fetching=!0,await this.model.load(),this.#items=this.model.items,super.ready=!0}catch(e){console.error(e)}finally{this.fetching=!1}}async delete(t){this.#items=this.#items.filter(e=>e.id!==t.id),await t.delete(),this.triggerEvent("items.changed")}loadClasses=async()=>n.gclassroom.courses();async saveItemToImport(e){var t=new s.Classroom;await t.isReady,t.set({external:e.id,name:e.name,description:"It does not have a description"}),this.itemsSelected.set(e.id,t),this.triggerEvent()}toggleItem(e){this.itemsSelected.has(e.id)?(this.#itemsSelected.delete(e.id),this.triggerEvent()):this.saveItemToImport(e)}async saveItems(){try{this.fetching=!0;var e=[...this.#itemsSelected.values()].map(e=>({...e.getProperties()})),{status:t,data:a}=await this.model.importFromGoogleClassroom({items:e});if(t)return this.#itemsSelected=new Map,a;throw new Error("error publishing classroom")}catch(e){console.error(1,e)}finally{this.fetching=!1}}}t.StoreManager=i}}),_.set("./views/classroom-list",{hash:1542119404,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ClassroomsList=function({store:e}){const t=(0,m.useModuleContext)().texts,[a,s]=n.useState(e.items);return(0,d.useBinder)([e],()=>s([...e.items]),"items.changed"),n.createElement(i.PageContainer,{className:"classroom-list__container"},n.createElement(i.PageTitle,{title:t.title},n.createElement("div",{className:"page-title__actions"},n.createElement(c.Link,{className:"add-item",href:"/classrooms/join"},n.createElement(l.Icon,{icon:"entities/classroom"}),t.actions.join),n.createElement(c.Link,{href:"/classrooms/create"},n.createElement(l.Icon,{icon:"add-circle"}),t.actions.create))),n.createElement(r.List,{className:" list-unstyled grid-container g-2-columns mt-1",items:a,control:o.Classroom}))};var n=e("react"),o=e("./item"),r=e("pragmate-ui/list"),i=e("@aimpact/ailearn-app/components/ui"),l=e("pragmate-ui/icons"),c=e("pragmate-ui/components"),m=e("./context"),d=e("@beyond-js/react-18-widgets/hooks")}}),_.set("./views/context",{hash:2192064674,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.useModuleContext=t.ModuleContext=void 0;var a=e("react");const s=t.ModuleContext=a.createContext({});t.useModuleContext=()=>a.useContext(s)}}),_.set("./views/empty",{hash:755154019,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyList=function(){var e=(0,n.useModuleContext)().texts;return a.createElement(o.PageContainer,null,a.createElement(o.PageTitle,{title:e.title},a.createElement("div",{className:"page-title__actions"},a.createElement(s.Link,{className:"add-item",href:"/classrooms/join"},a.createElement(r.AppIcon,{icon:"entities/classroom"}),e.actions.join),a.createElement(s.Link,{href:"/classrooms/create"},a.createElement(r.AppIcon,{icon:"add-circle"}),e.actions.create))),a.createElement(o.EmptyCard,{text:e.empty.title,description:e.empty.description,icon:"edit"},a.createElement("div",{className:"empty__actions"},a.createElement(s.Link,{href:"/classrooms/create",className:"grow btn btn-primary"},e.actions.create))))};var a=e("react"),s=e("pragmate-ui/components"),n=e("./context"),o=e("@aimpact/ailearn-app/components/ui"),r=e("@aimpact/ailearn-app/components/icons")}}),_.set("./views/header",{hash:3207084737,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Header=function(){const{texts:e,fetching:t,store:a}=(0,l.useModuleContext)(),[,s]=(m.sessionWrapper.user.displayName,i.default.useState(t)),[n,o]=i.default.useState(!1),r=!p.gclassroom.authorized;return(0,h.useBinder)([a],()=>s(a.fetching)),i.default.createElement(i.default.Fragment,null,r&&i.default.createElement("div",{className:"alert-extra__container"},i.default.createElement(d.Alert,{type:"info"},e.extraInfo)),a.items&&i.default.createElement(c.PageTitle,{title:e.title},i.default.createElement("div",{className:"page-title__actions"},i.default.createElement(u.Link,{className:"add-item",href:"/classrooms/join"},i.default.createElement(u.Button,{icon:"share-link",variant:"primary"},e.actions.join," 11")),i.default.createElement(u.Link,{className:"add-item",href:"/classrooms/create"},i.default.createElement(u.Button,{icon:"add",variant:"primary"},e.actions.create)))),n&&i.default.createElement(f.Modal,{show:!0,className:"modal-import__general",onClose:function(){o(!n)}},i.default.createElement(g.Import,null)))};var i=e("react"),l=e("./context"),c=e("@aimpact/ailearn-app/components/ui"),m=e("@aimpact/chat-sdk/session"),d=e("pragmate-ui/alert"),u=e("pragmate-ui/components"),p=e("@aimpact/ailearn-app/model/gclassroom"),f=e("pragmate-ui/modal"),g=e("./import"),h=e("@beyond-js/react-18-widgets/hooks")}}),_.set("./views/import/empty",{hash:3044890623,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyExplorer=function({}){var e=(0,n.useModuleContext)().texts;return a.default.createElement("div",{className:"items-modal__empty"},a.default.createElement(s.IconButton,{icon:"circle-exclamation",title:e.empty.titleImport}),a.default.createElement("span",null,e.empty.labelImport))};var a=e("react"),s=e("pragmate-ui/icons"),n=e("../context")}}),_.set("./views/import/index",{hash:947523122,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Import=function(){const{store:e,texts:t}=(0,f.useModuleContext)(),[a,s]=l.default.useState(e.fetching),[n,o]=l.default.useState(e.ready),r=((0,c.useBinder)([e],()=>{o(e.ready),s(e.fetching)}),m.gclassroom.ready&&n);var i;return r?(i=e.gItems.length?p.List:u.EmptyExplorer,l.default.createElement("div",{className:"modal-import__container"},l.default.createElement("h4",null,t.import.title),l.default.createElement(i,null),l.default.createElement(g.ProcessContainer,{fetching:a}))):l.default.createElement(d.Spinner,{active:!0,type:"primary"})};var l=e("react"),c=e("@beyond-js/react-18-widgets/hooks"),m=e("@aimpact/ailearn-app/model/gclassroom"),d=e("pragmate-ui/components"),u=e("./empty"),p=e("./list"),f=e("../context"),g=e("@aimpact/ailearn-app/components/ui")}}),_.set("./views/import/items/index",{hash:1993213349,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Item=void 0;var c=e("react"),m=e("../../context"),d=e("pragmate-ui/icons"),u=e("@beyond-js/react-18-widgets/hooks");t.Item=({item:t})=>{const{store:a,texts:e}=(0,m.useModuleContext)(),[s,n]=c.default.useState(!1),[o,r]=c.default.useState(a.items),i=((0,u.useBinder)([a],()=>r(a.items)),o.some(e=>e.external.id===t.id));var l=a.itemsSelected.has(t.id);return c.default.createElement("li",{key:t.id,className:"gclassroom-item "+(i&&" already"),onClick:e=>{i||(n(!s),a.toggleItem(t))}},c.default.createElement("span",{className:"flex-container flex-space-between"},t.name),l&&c.default.createElement(d.Icon,{icon:"check"}),i&&c.default.createElement("div",{className:"saved__item"},c.default.createElement("span",null,e.actions.imported),c.default.createElement(d.Icon,{icon:"check",className:"disabled-icon"})))}}}),_.set("./views/import/list",{hash:913571725,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.List=function(){const{store:t,texts:e}=(0,i.useModuleContext)(),[a,s]=n.default.useState(t.gItems);return(0,o.useBinder)([t],()=>s(t.gItems)),n.default.createElement(n.default.Fragment,null,n.default.createElement(m.List,{specs:{},items:a,control:r.Item,className:"gclassrooms-modal__list"}),n.default.createElement("div",{className:"gclassroom-modal__action flex-container flex-end"},n.default.createElement(l.Button,{icon:"arrowDownloads",variant:"primary",className:"import-button__action circle",onClick:async e=>{e.preventDefault(),e.stopPropagation();try{await t.saveItems(),c.toast.success("Classroom published successfully")}catch(e){c.toast.error("Error while publishing classroom")}},disabled:t.itemsSelected.size<1},e.actions.import)))};var n=e("react"),o=e("@beyond-js/react-18-widgets/hooks"),r=e("./items"),i=e("../context"),l=e("pragmate-ui/components"),c=e("pragmate-ui/toast"),m=e("pragmate-ui/list")}}),_.set("./views/index",{hash:3114054988,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.View=function({store:e}){const[t,a]=(0,r.useState)(e.ready),[s,n]=(0,r.useState)(e.fetching),o=((0,m.useBinder)([e],()=>{a(e.ready),n(e.fetching)}),e.texts);return t?r.default.createElement(l.ModuleContext.Provider,{value:{texts:o,store:e,fetching:s,totalItems:e.items.length}},e.items.length<1?r.default.createElement(i.EmptyList,null):r.default.createElement(d.ClassroomsList,{store:e})):r.default.createElement(c.PageLoader,{fetching:!0})};var r=e("react"),i=e("./empty"),l=e("./context"),c=e("@aimpact/ailearn-app/components/ui"),m=e("@beyond-js/react-18-widgets/hooks"),d=e("./classroom-list")}}),_.set("./views/item/actions",{hash:1517931771,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({item:e}){const{texts:t,store:a}=(0,n.useModuleContext)();return s.default.createElement("section",{className:"card-footer__actions"},s.default.createElement(o.ConfirmAction,{textPopUp:t?.actions?.delete,icon:"delete",onConfirm:async()=>{await a.delete(e)}}))};var s=e("react"),n=e("../context"),o=e("@aimpact/ailearn-app/components/ui")}}),_.set("./views/item/index",{hash:184380642,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Classroom=function({data:e}){return a.default.createElement(s.Card,null,a.default.createElement(s.CardContent,null,a.default.createElement(n.default,{item:e})),a.default.createElement(s.CardFooter,null,a.default.createElement(o.default,{item:e})))};var a=e("react"),s=e("@aimpact/ailearn-app/components/ui"),n=e("./title"),o=e("./actions")}}),_.set("./views/item/title",{hash:3773496731,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({item:e}){var t=(0,o.useModuleContext)().texts;return a.createElement("section",null,a.createElement("div",{className:"title-card__container flex-container flex-space-between"},a.createElement(s.Link,{href:"/classrooms/view/"+e.id},a.createElement("h4",null,e.name)),e?.external?.id&&a.createElement(n.IconButton,{title:t.actions.gTooltip,icon:"google"})),a.createElement(r.UserData,{data:e.owner}),a.createElement("span",null,e.description))};var a=e("react"),s=e("pragmate-ui/components"),n=e("pragmate-ui/icons"),o=e("../context"),r=e("@aimpact/ailearn-app/components/ui")}}),w.exports.descriptor=[{im:"./controller",from:"Controller",name:"Controller"},{im:"./views/index",from:"View",name:"View"}],w.exports.process=function({require:e,prop:t,value:a}){!e&&"Controller"!==t||s("Controller",e?e("./controller").Controller:a),!e&&"View"!==t||s("View",e?e("./views/index").View:a)},s("__beyond_pkg",w),s("hmr",new function(){this.on=(e,t)=>w.hmr.on(e,t),this.off=(e,t)=>w.hmr.off(e,t)}),w.initialise(_)}}});