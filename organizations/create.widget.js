System.register(["@beyond-js/widgets@1.1.0/render","@beyond-js/kernel@0.1.9/bundle","@beyond-js/kernel@0.1.9/styles","@beyond-js/react-18-widgets@1.1.2/page","@aimpact/ailearn-sdk@1.0.0/core","@beyond-js/reactive@1.1.12/model","@aimpact/chat-sdk@1.0.0/session","react@18.2.0","@aimpact/ailearn-app@0.0.32/components/navbar-header.code","@aimpact/ailearn-app@0.0.32/config","pragmate-ui@0.1.1/form","pragmate-ui@0.1.1/components","@aimpact/ailearn-app@0.0.32/components/ui","pragmate-ui@0.1.1/toast","@beyond-js/kernel@0.1.9/routing","@beyond-js/react-18-widgets@1.1.2/hooks"],function(r,e){"use strict";var t,a,n,o,s,i,c,l,d,u,m,p,h,g,f,v,y,b;return r({Controller:void 0,Header:void 0}),{setters:[function(e){t=e},function(e){a=e},function(e){n=e},function(e){o=e},function(e){s=e},function(e){i=e},function(e){c=e},function(e){l=e},function(e){d=e},function(e){u=e},function(e){m=e},function(e){p=e},function(e){h=e},function(e){g=e},function(e){f=e},function(e){v=e}],execute:function(){b=a.Bundle,(y=new b({module:{vspecifier:"@aimpact/ailearn-app@0.0.32/organizations/create",multibundle:!0},type:"widget"},e.meta.url).package()).dependencies.update([["@beyond-js/widgets/render",t],["@beyond-js/kernel/styles",n],["@beyond-js/react-18-widgets/page",o],["@aimpact/ailearn-sdk/core",s],["@beyond-js/reactive/model",i],["@aimpact/chat-sdk/session",c],["react",l],["@aimpact/ailearn-app/components/navbar-header.code",d],["@aimpact/ailearn-app/config",u],["pragmate-ui/form",m],["pragmate-ui/components",p],["@aimpact/ailearn-app/components/ui",h],["pragmate-ui/toast",g],["@beyond-js/kernel/routing",f],["@beyond-js/react-18-widgets/hooks",v]]),brequire("@beyond-js/widgets/render").widgets.register([{name:"app-organizations-create",vspecifier:"@aimpact/ailearn-app@0.0.32/organizations/create.widget",is:"page",route:"/organizations/create",layout:"general-layout"}]),brequire("@beyond-js/kernel/styles").styles.register("@aimpact/ailearn-app@0.0.32/organizations/create.widget"),(b=new Map).set("./controller",{hash:940274451,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Controller=void 0;var a=e("@beyond-js/react-18-widgets/page"),r=e("./store"),n=e("./views");class o extends a.PageReactWidgetController{#store;createStore(){return this.#store=new r.StoreManager,this.#store}get Widget(){return n.View}show(){this.#store.load(this.uri.qs.get("id"))}hide(){this.#store.clear()}}t.Controller=o}}),b.set("./store",{hash:523044439,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.StoreManager=void 0;var a=e("@aimpact/ailearn-sdk/core"),r=e("@beyond-js/reactive/model"),n=e("@aimpact/chat-sdk/session");class o extends r.ReactiveModel{#model;get model(){return this.#model}clear(){this.#model=void 0,this.ready=!1}async load(){try{this.ready=!1,this.#model=new a.Organization({})}catch(e){console.error(e)}finally{this.ready=!0}}async delete(e){this.#model.classrooms.remove(e),this.trigger("change")}async save(e){try{this.fetching=!0;var{status:t,data:a}=await this.model.save({...e});if(t)return a;throw new Error("error publishing classroom")}catch(e){console.error(1,e)}finally{this.fetching=!1}}async publish(e){try{this.fetching=!0;var{status:t,data:a}=await this.model.save({...e});if(t)return await n.sessionWrapper.user.load(),a;throw new Error("error publishing classroom")}catch(e){console.error(1,e)}finally{this.fetching=!1}}}t.StoreManager=o}}),b.set("./views/context",{hash:952274567,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.useModuleContext=t.ModuleContext=void 0;var a=e("react");const r=t.ModuleContext=a.createContext({});t.useModuleContext=()=>a.useContext(r)}}),b.set("./views/header",{hash:3746281293,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Header=function(){var e=(0,n.useModuleContext)().texts;return r.createElement("section",null,r.createElement(a.NavbarHeader,{breadcrumb:[[e.breadcrumb.organizations,"/organizations/list"],[e.breadcrumb.management,""]]}))};var a=e("@aimpact/ailearn-app/components/navbar-header.code"),r=e("react"),n=e("./context")}}),b.set("./views/index",{hash:1305740004,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.View=function({store:e}){var{ready:t,texts:a}=(0,p.useModel)(e),{fetching:r,values:n,onChange:o,onSubmit:s}=(0,h.useForm)(t,e,a);return t?(t={disabled:r||""===n.name||""===n.description},i.createElement(u.ModuleContext.Provider,{value:e={texts:a,store:e}},i.createElement(m.Header,null),i.createElement(d.PageContainer,{className:"form-page-container",fetching:r},i.createElement("header",{className:"page__header"},i.createElement("h3",null,a.create.title)),i.createElement(c.Form,{onSubmit:s,className:"form__container"},i.createElement(c.Input,{label:a.create.name.label,placeholder:a.create.name.placeholder,value:n.name,name:"name",type:"text",onChange:o,required:!0}),i.createElement(c.Textarea,{label:a.create.description.label,name:"description",value:n.description,placeholder:a.create.description.placeholder,onChange:o,required:!0}),i.createElement("div",{className:"form__footer"},i.createElement(l.Button,{fetching:r,...t,variant:"primary",type:"submit"},a.create.actions.save)))))):null};var i=e("react"),c=e("pragmate-ui/form"),l=e("pragmate-ui/components"),d=e("@aimpact/ailearn-app/components/ui"),u=e("./context"),m=e("./header"),p=e("./use-model"),h=e("./use-form")}}),b.set("./views/use-form",{hash:1912930700,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.useForm=function(e,t,a){const r={name:t?.model?.name||"",description:t?.model?.description||""},[n,o]=d.useState(r),[s,i]=d.useState(!1),[,c]=d.useState("");if((0,p.useBinder)([t],()=>{t.ready||o(r)}),!e)return{};const l=t.model;return{values:n,fetching:s,setFetching:i,onChange:({currentTarget:e})=>{var t={...n};t[e.name]=e.value,o(t),c("")},onSubmit:async e=>{e.preventDefault(),e.stopPropagation(),i(!0);try{await t.publish(n),u.toast.success(a.create.success),m.routing.replaceState({},null,"/organizations/view/"+l.id)}catch(e){c(e.message),u.toast.error(a.create.error)}finally{i(!1)}}}};var d=e("react"),u=e("pragmate-ui/toast"),m=e("@beyond-js/kernel/routing"),p=e("@beyond-js/react-18-widgets/hooks")}}),b.set("./views/use-model",{hash:1182693627,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.useModel=function(t){var[e,,]=o.useState(t.ready),[a,r]=(0,n.useTexts)(s.module.specifier);return o.useEffect(()=>{const e=()=>{};return t.on("change",e),()=>t.off("change",e)}),{ready:e&&a,store:t,texts:r}};var n=e("@beyond-js/react-18-widgets/hooks"),o=e("react"),s=e("beyond_context")}}),y.exports.descriptor=[{im:"./controller",from:"Controller",name:"Controller"},{im:"./views/header",from:"Header",name:"Header"}],y.exports.process=function({require:e,prop:t,value:a}){!e&&"Controller"!==t||r("Controller",e?e("./controller").Controller:a),!e&&"Header"!==t||r("Header",e?e("./views/header").Header:a)},r("__beyond_pkg",y),r("hmr",new function(){this.on=(e,t)=>y.hmr.on(e,t),this.off=(e,t)=>y.hmr.off(e,t)}),y.initialise(b)}}});