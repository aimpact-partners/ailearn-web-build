System.register(["@beyond-js/widgets@1.1.0/render","@beyond-js/kernel@0.1.9/bundle","@beyond-js/kernel@0.1.9/styles","@beyond-js/react-18-widgets@1.1.2/page","@aimpact/ailearn-sdk@1.0.0/entities/organizations","@beyond-js/reactive@1.2.0/model","@aimpact/chat-sdk@1.3.0/session","@aimpact/ailearn-app@0.1.13/main-layout.widget","@beyond-js/kernel@0.1.9/texts","react@18.2.0","pragmate-ui@1.0.0-beta.6/form","pragmate-ui@1.0.0-beta.6/components","@aimpact/ailearn-app@0.1.13/components/ui","@beyond-js/react-18-widgets@1.1.2/hooks","pragmate-ui@1.0.0-beta.6/toast","@beyond-js/kernel@0.1.9/routing"],function(r,e){var t,a,n,o,s,i,l,c,d,u,m,p,g,h,f,y,b,v;return r("Controller",void 0),{setters:[function(e){t=e},function(e){a=e},function(e){n=e},function(e){o=e},function(e){s=e},function(e){i=e},function(e){l=e},function(e){c=e},function(e){d=e},function(e){u=e},function(e){m=e},function(e){p=e},function(e){g=e},function(e){h=e},function(e){f=e},function(e){y=e}],execute:function(){v=a.Bundle,(b=new v({module:{vspecifier:"@aimpact/ailearn-app@0.1.13/organizations/management",multibundle:!0},type:"widget"},e.meta.url).package()).dependencies.update([["@beyond-js/widgets/render",t],["@beyond-js/kernel/styles",n],["@beyond-js/react-18-widgets/page",o],["@aimpact/ailearn-sdk/entities/organizations",s],["@beyond-js/reactive/model",i],["@aimpact/chat-sdk/session",l],["@aimpact/ailearn-app/main-layout.widget",c],["@beyond-js/kernel/texts",d],["react",u],["pragmate-ui/form",m],["pragmate-ui/components",p],["@aimpact/ailearn-app/components/ui",g],["@beyond-js/react-18-widgets/hooks",h],["pragmate-ui/toast",f],["@beyond-js/kernel/routing",y]]),brequire("@beyond-js/widgets/render").widgets.register([{name:"app-organizations-management",vspecifier:"@aimpact/ailearn-app@0.1.13/organizations/management.widget",is:"page",route:"/organizations/management",layout:"main-layout"}]),brequire("@beyond-js/kernel/styles").styles.register("@aimpact/ailearn-app@0.1.13/organizations/management.widget"),(v=new Map).set("./controller",{hash:940274451,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Controller=void 0;var a=e("@beyond-js/react-18-widgets/page"),r=e("./store"),n=e("./views");class o extends a.PageReactWidgetController{#store;createStore(){return this.#store=new r.StoreManager,this.#store}get Widget(){return n.View}show(){this.#store.load(this.uri.qs.get("id"))}hide(){this.#store.clear()}}t.Controller=o}}),v.set("./store",{hash:3090235510,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.StoreManager=void 0;var a=e("@aimpact/ailearn-sdk/entities/organizations"),r=e("@beyond-js/reactive/model"),n=e("@aimpact/chat-sdk/session"),o=e("@beyond-js/kernel/texts"),s=e("beyond_context");class i extends r.ReactiveModel{#model;get model(){return this.#model}#texts=new o.CurrentTexts(s.module.specifier);get texts(){return this.#texts?.value}get ready(){return super.ready&&this.#texts.ready}constructor(){super(),this.#texts.on("change",this.triggerEvent)}clear(){this.#model=void 0,super.ready=!1}async load(e){try{e&&this.#model&&this.#model.id===e||(this.#model&&(this.#model.off("change",this.triggerEvent),this.#model=void 0),this.#model=new a.Organization({id:e}),this.#model.on("change",this.triggerEvent),e&&(await this.#model.load(e),console.log(this.#model.getProperties())))}catch(e){console.error(e)}finally{super.ready=!0}}async save(e){try{this.fetching=!0;var{status:t,data:a}=await this.model.save({...e});if(n.sessionWrapper.user.load(),t)return a;throw new Error("error publishing classroom")}catch(e){console.error(1,e)}finally{this.fetching=!1}}async publish(e){this.fetching=!0,await this.model.publish(e),await n.sessionWrapper.user.load()}}t.StoreManager=i}}),v.set("./views/context",{hash:952274567,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.useModuleContext=t.ModuleContext=void 0;var a=e("react");let r=t.ModuleContext=a.createContext({});t.useModuleContext=()=>a.useContext(r)}}),v.set("./views/index",{hash:2538735134,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.View=function({store:e}){let[t,a]=c.useState(e.ready),r=((0,h.useBinder)([e],()=>a(e.ready)),e.texts),{fetching:n,values:o,onChange:s,onSubmit:i}=(0,g.useForm)(t,e,r),l;return t?(l={disabled:n||""===o.name},c.createElement(p.ModuleContext.Provider,{value:{texts:r,store:e}},c.createElement(m.PageContainer,{className:"form-page-container",fetching:n},c.createElement("header",{className:"page__header"},c.createElement("h3",null,r.create.title)),c.createElement("div",{className:"mt-15"}),c.createElement(d.Form,{onSubmit:i,className:"form__container"},c.createElement(d.Input,{label:r.create.name.label,placeholder:r.create.name.placeholder,value:o.name,name:"name",type:"text",onChange:s,required:!0}),c.createElement(d.Textarea,{label:r.create.description.label,name:"description",value:o.description,placeholder:r.create.description.placeholder,onChange:s}),c.createElement("div",{className:"form__footer"},c.createElement(u.Button,{fetching:n,...l,variant:"primary",type:"submit"},r.create.actions.save)))))):null};var c=e("react"),d=e("pragmate-ui/form"),u=e("pragmate-ui/components"),m=e("@aimpact/ailearn-app/components/ui"),p=e("./context"),g=e("./use-form"),h=e("@beyond-js/react-18-widgets/hooks")}}),v.set("./views/use-form",{hash:3582432434,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.useForm=function(e,t,a){let r={name:t?.model?.name||"",description:t?.model?.description||""},[n,o]=d.useState(r),[s,i]=d.useState(!1),[,l]=d.useState("");if((0,p.useBinder)([t],()=>{t.ready||o(t.model?.getProperties()??r)}),!e)return{};let c=t.model;return{values:n,fetching:s,setFetching:i,onChange:({currentTarget:e})=>{var t={...n};t[e.name]=e.value,o(t),l("")},onSubmit:async e=>{e.preventDefault(),e.stopPropagation(),i(!0);try{await t.publish(n),u.toast.success(a.create.success),m.routing.replaceState({},null,"/organizations/view/"+c.id)}catch(e){l(e.message),u.toast.error(a.create.error)}finally{i(!1)}}}};var d=e("react"),u=e("pragmate-ui/toast"),m=e("@beyond-js/kernel/routing"),p=e("@beyond-js/react-18-widgets/hooks")}}),v.set("./views/use-model",{hash:1182693627,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.useModel=function(t){var[e,,]=o.useState(t.ready),[a,r]=(0,n.useTexts)(s.module.specifier);return o.useEffect(()=>{let e=()=>{};return t.on("change",e),()=>t.off("change",e)}),{ready:e&&a,store:t,texts:r}};var n=e("@beyond-js/react-18-widgets/hooks"),o=e("react"),s=e("beyond_context")}}),b.exports.descriptor=[{im:"./controller",from:"Controller",name:"Controller"}],b.exports.process=function({require:e,prop:t,value:a}){!e&&"Controller"!==t||r("Controller",e?e("./controller").Controller:a)},r("__beyond_pkg",b),r("hmr",new function(){this.on=(e,t)=>b.hmr.on(e,t),this.off=(e,t)=>b.hmr.off(e,t)}),b.initialise(v)}}});