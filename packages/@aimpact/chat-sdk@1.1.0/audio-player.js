System.register(["@beyond-js/kernel@0.1.9/bundle","@beyond-js/kernel@0.1.9/styles","react@18.2.0","@beyond-js/kernel@0.1.9/core","wavesurfer.js@7.8.4","pragmate-ui@1.0.0-beta.2/icons"],function(r,e){var t,a,n,o,u,i,l,s;return r("AudioPlayer",void 0),{setters:[function(e){t=e},function(e){a=e},function(e){n=e},function(e){o=e},function(e){u=e},function(e){i=e}],execute:function(){s=t.Bundle,(l=new s({module:{vspecifier:"@aimpact/chat-sdk@1.1.0/audio-player"},type:"code"},e.meta.url).package()).dependencies.update([["@beyond-js/kernel/styles",a],["react",n],["@beyond-js/kernel/core",o],["wavesurfer.js",u],["pragmate-ui/icons",i]]),brequire("@beyond-js/kernel/styles").styles.register("@aimpact/chat-sdk@1.1.0/audio-player"),(s=new Map).set("./context",{hash:1420102872,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.useComponentAudioContext=t.ComponentAudioContext=void 0;var a=e("react");let r=t.ComponentAudioContext=(0,a.createContext)({});t.useComponentAudioContext=()=>(0,a.useContext)(r)}}),s.set("./hooks/get-element-context",{hash:3733522732,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getAudioContext=void 0,t.getAudioContext=o=>n=>new Promise((e,t)=>{let a=new AudioContext,r=new FileReader;r.onload=()=>{var e=r.result;a.decodeAudioData(e).then(o).catch(e=>{t(e)})},r.readAsArrayBuffer(n)})}}),s.set("./hooks/use-audio",{hash:4293597558,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.useAudio=function(t,e){let a=m.default.useRef(null),[r,n]=m.default.useState(null),[o,,]=m.default.useState(),[u,i]=m.default.useState(),[l,s]=m.default.useState({src:t}),[d,c]=m.default.useState(!1),f=a.current;return m.default.useEffect(()=>{try{if(t instanceof Blob){let e=new Audio;e.addEventListener("loadedmetadata",()=>{l.duration=parseFloat(e.duration.toFixed(2)),l.fileName=t.name,s(l),n(e),(0,p.getAudioContext)(t).then(()=>{i(!0)})}),e.addEventListener("error",e=>{console.warn("error",e),c(!0)}),e.src=URL.createObjectURL(t),e.load()}}catch(e){console.error("capturado",e.message),c(!0)}},[t]),{ready:u,audioRef:f,buffer:o,audio:r,data:l,error:d}};var m=e("react"),p=e("./get-element-context")}}),s.set("./index",{hash:1486404008,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AudioPlayer=function({src:e,convert:t}){let{ready:a,error:r,audio:n,data:o,buffer:u}=(0,_.useAudio)(e,t),[i,l]=p.default.useState(!1),[s,d]=p.default.useState(0);if(!a||r)return p.default.createElement(E.Preload,null);let c={play:e=>{e.stopPropagation(),n.play(),l(!0)},pause:e=>{e.stopPropagation(),n.pause(),l(!1)},restart:e=>{e.stopPropagation()}},f=i?"pause":"play",m={audio:n,data:o,playing:i,buffer:u,setPlaying:l,currentTime:s,setCurrentTime:d};return p.default.createElement(y.ComponentAudioContext.Provider,{value:m},p.default.createElement("div",{className:"audio-player__container"},p.default.createElement(v.IconButton,{icon:f,"data-action":f,onClick:e=>{var t=e.currentTarget.dataset.action;c[t](e)}}),p.default.createElement("div",{className:"audio__container"},p.default.createElement("div",{className:"audio__thumb"},p.default.createElement(b.Visualizer,null)),p.default.createElement(h.Timer,null))))};var p=e("react"),_=e("./hooks/use-audio"),v=e("pragmate-ui/icons"),y=e("./context"),h=e("./timer"),b=e("./visualizer"),E=e("./preload")}}),s.set("./preload",{hash:258477212,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Preload=function({}){return a.default.createElement("div",{className:"player__container player__container--preload"},a.default.createElement(r.IconButton,{disabled:!0,icon:"play"}),a.default.createElement("div",{className:"audio__container"},a.default.createElement("div",{className:"audio__thumb"},a.default.createElement("div",{className:"range__preload"})),a.default.createElement("div",{className:"timer__container"},a.default.createElement("span",{className:"timer__numbers"},"00"),a.default.createElement("div",{className:"timer__separator"},":"),a.default.createElement("span",{className:"timer__numbers"},"00"))))};var a=e("react"),r=e("pragmate-ui/icons")}}),s.set("./progressbar",{hash:2365172175,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressBar=function(){let e=(0,l.useRef)(null),{audio:a,setCurrentTime:t,setPlaying:r,data:{duration:n}}=(0,s.useComponentAudioContext)(),[o,u]=(0,l.useState)(0),i=((0,l.useEffect)(()=>{let e=()=>{var e=a.currentTime;u(e)};return a.addEventListener("timeupdate",e),a.addEventListener("ended",e=>{r(!1),u(.1),t(.1)}),()=>{a.removeEventListener("timeupdate",e)}},[a,n]),e=>{e.stopPropagation();var t=parseFloat(e.currentTarget.value);for(let e=0;e<a.buffered.length;e++)if(a.buffered.start(e)<=t&&a.buffered.end(e)>=t)return a.currentTime=t,void u(t);console.warn("Desired time not in buffered range",a.buffered.length)});return l.default.createElement("input",{type:"range",name:"rang",onClick:i,onChange:i,title:"audio duration",value:o,ref:e,max:n})};var l=e("react"),s=e("./context")}}),s.set("./timer",{hash:2388829827,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Timer=function(){let{data:{duration:e},audio:t}=(0,s.useComponentAudioContext)();if([1/0,void 0].includes(e))return null;let[a,r]=l.default.useState(e),n=(l.default.useEffect(()=>{t.addEventListener("play",()=>{r(t.currentTime)}),t.addEventListener("pause",()=>{r(e)}),t.addEventListener("stop",()=>{r(e)}),t.addEventListener("timeupdate",()=>{r(t.currentTime)})},[]),Math.floor(a/3600)),o=Math.floor(a%3600/60),u=Math.round(a%60),i=[];return 0<n&&i.push(l.default.createElement("span",{key:"hours",className:"timer__numbers timer__numbers--hours"},n)),o<10&&(o="0"+o),i.push(l.default.createElement(l.default.Fragment,{key:"minutes"},l.default.createElement("span",{className:"timer__numbers timer__number--minutes"},o??"00"),l.default.createElement("span",{className:"timer__separator"},":"))),u<10&&(u="0"+u),i.push(l.default.createElement("span",{key:"seconds",className:"timer__numbers timer__number--seconds"},u??"00")),l.default.createElement("section",{className:"timer__container"},i)};var l=e("react"),s=e("./context")}}),s.set("./types/IAudioInterface",{hash:377341658,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}}),s.set("./visualizer",{hash:2343976179,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Visualizer=function(){let t=(0,n.useComponentAudioContext)().audio,a=r.default.useRef(null);return r.default.useEffect(()=>{let e=o.default.create({container:a.current,waveColor:"#f0f0f0",progressColor:"#007bff",barWidth:2,barHeight:1,cursorWidth:0,height:20,normalize:!0,hideScrollbar:!0,backend:"MediaElement",barGap:1,barRadius:2});return e.load(t.src),()=>{e.destroy()}},[{}]),r.default.createElement(r.default.Fragment,null,r.default.createElement("div",{className:"element",ref:a}))};var r=e("react"),n=e("./context"),o=e("wavesurfer.js")}}),l.exports.descriptor=[{im:"./index",from:"AudioPlayer",name:"AudioPlayer"}],l.exports.process=function({require:e,prop:t,value:a}){!e&&"AudioPlayer"!==t||r("AudioPlayer",e?e("./index").AudioPlayer:a)},r("__beyond_pkg",l),r("hmr",new function(){this.on=(e,t)=>l.hmr.on(e,t),this.off=(e,t)=>l.hmr.off(e,t)}),l.initialise(s)}}});