System.register(["@beyond-js/kernel@0.1.9/bundle","@aimpact/ailearn-sdk@1.0.0/reactive/model","uuid@10.0.0"],function(i,e){var t,r,s,a,o;return i({Item:void 0,RegistryFactory:void 0,ItemId:void 0,IItemProps:void 0,IEntityProvider:void 0}),{setters:[function(e){t=e},function(e){r=e},function(e){s=e}],execute:function(){o=t.Bundle,(a=new o({module:{vspecifier:"@aimpact/ailearn-sdk@1.0.0/reactive/entities/item"},type:"ts"},e.meta.url).package()).dependencies.update([["@aimpact/ailearn-sdk/reactive/model",r],["uuid",s]]),(o=new Map).set("./index",{hash:2990452684,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Item=void 0;var r=e("@aimpact/ailearn-sdk/reactive/model"),s=e("./registry/factory");class i extends r.ReactiveModel{#factory;static entity;#registry;#dataProvider;#fetched;get fetched(){return this.#fetched}#found=!1;get found(){return this.#found}get dataProvider(){return this.#dataProvider}get registry(){return this.#registry}constructor({entity:e,dataProvider:t,properties:r,...i}){if(super({...i,properties:r}),!e)throw new Error("Entity is required");this.#dataProvider=t,this.#factory=s.RegistryFactory.getInstance(e),r=this.#factory.get(this.id,i),t=(this.#registry=r).getValues(),this.setInitialValues(t),this.#registry.on("change",this.registryListener.bind(this)),this.properties.forEach(e=>{"string"==typeof e&&this.on(e+".changed",()=>{this.#registry.setValues({[e]:this.getProperty(e)})})})}registryListener(e){super.set(this.#registry.getValues())}set(e){var t=super.set(e);return t.updated&&this.#registry.setValues(e),t}_load(e){}async load(e){if(!this.#dataProvider||"function"!=typeof this.#dataProvider.load)throw new Error("DataProvider is not defined or does not implement the load() method.");try{var t=await this.#dataProvider.load(e);if(!t)throw this.#found=!1,new Error("DataProvider.load() did not return an item.");this.#found=!0,this.#fetched=!0,this.set(t),this.triggerEvent("load",{...this.getProperties()}),this.trigger("change")}catch(e){throw new Error(e.message)}finally{this.#fetched=!0}}save(e){this.set(e)}async publish(e){return this.set(e),this.#dataProvider&&"function"==typeof this.#dataProvider.publish?(e=await this.#dataProvider.publish(e),this.set(e),e):this.getProperties()}async delete(e){try{if(e=e??this.id,this.#dataProvider&&"function"==typeof this.#dataProvider.delete)return this.processing=!0,this.#dataProvider.delete(e);throw new Error("DataProvider is not defined or does not implement the delete() method.")}catch(e){console.error(e)}}}t.Item=i}}),o.set("./registry/factory",{hash:870827429,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.RegistryFactory=void 0;var r=e("@aimpact/ailearn-sdk/reactive/model"),i=e("./");class s extends r.ReactiveModel{static#instances=new Map;items=new Map;#name;constructor(e,t){super({properties:t}),this.#name=e,this.ready=!0}get(e,t){e&&this.items.has(e)||(r=t?{...t}:{id:e,properties:this.properties,...t},e=(r=new i.Registry(r)).id,this.items.set(e,r));var r=this.items.get(e);return t&&r.setValues(t),r}static getInstance(e,t){return this.#instances.has(e)||this.#instances.set(e,new s(e,t)),this.#instances.get(e)}}t.RegistryFactory=s}}),o.set("./registry/index",{hash:957425421,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Registry=void 0;var r=e("@aimpact/ailearn-sdk/reactive/model"),i=e("uuid");class s extends r.ReactiveModel{#id;#instanceId;#isDeleted=!1;get id(){return this.#id}get instanceId(){return this.#instanceId}#values;get values(){return this.#values}get deleted(){return this.#isDeleted}#propertyNames=[];set deleted(e){e!==this.#isDeleted&&(this.#isDeleted=e,this.triggerEvent())}constructor({properties:e,...t}={id:void 0}){super({properties:e||[]}),e=t.id,this.#instanceId=(0,i.v4)(),this.#id=e??this.#instanceId,this.#values={...t,id:this.#id},this.setValues(t)}updateValue(e,t){this.#values[e]=t}setValues(e){if(!e)return!1;let t=!1;for(var r in e){var i;Object.prototype.hasOwnProperty.call(e,r)&&(i=e[r])!==this.#values[r]&&(this.updateValue(r,i),t=!0)}return t&&this.trigger("change",{values:this.#values}),t}getValues(){return{...this.#values}}}t.Registry=s}}),o.set("./registry/types/index",{hash:2103332309,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}}),o.set("./types",{hash:3439753190,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}}),a.exports.descriptor=[{im:"./index",from:"Item",name:"Item"},{im:"./registry/factory",from:"RegistryFactory",name:"RegistryFactory"},{im:"./types",from:"ItemId",name:"ItemId"},{im:"./types",from:"IItemProps",name:"IItemProps"},{im:"./types",from:"IEntityProvider",name:"IEntityProvider"}],a.exports.process=function({require:e,prop:t,value:r}){!e&&"Item"!==t||i("Item",e?e("./index").Item:r),!e&&"RegistryFactory"!==t||i("RegistryFactory",e?e("./registry/factory").RegistryFactory:r),!e&&"ItemId"!==t||i("ItemId",e?e("./types").ItemId:r),!e&&"IItemProps"!==t||i("IItemProps",e?e("./types").IItemProps:r),!e&&"IEntityProvider"!==t||i("IEntityProvider",e?e("./types").IEntityProvider:r)},i("__beyond_pkg",a),i("hmr",new function(){this.on=(e,t)=>a.hmr.on(e,t),this.off=(e,t)=>a.hmr.off(e,t)}),a.initialise(o)}}});