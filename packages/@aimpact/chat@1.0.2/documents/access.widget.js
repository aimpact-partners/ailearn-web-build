System.register(["@beyond-js/widgets@1.1.0/render","@beyond-js/kernel@0.1.9/bundle","@beyond-js/kernel@0.1.9/styles","@beyond-js/react-18-widgets@1.1.2/page","@beyond-js/reactive@1.2.0/model","@aimpact/chat-sdk@1.0.1/core","@aimpact/chat-sdk@1.0.1/session","react@18.2.0","pragmate-ui@1.0.0-beta.1/link","pragmate-ui@1.0.0-beta.1/components","pragmate-ui@1.0.0-beta.1/icons","@aimpact/chat@1.0.2/shared/icons","@beyond-js/react-18-widgets@1.1.2/hooks","@aimpact/chat@1.0.2/shared/components","@beyond-js/kernel@0.1.9/routing","@aimpact/chat@1.0.2/shared/hooks"],function(o,e){"use strict";var t,a,s,r,n,c,i,l,d,u,m,h,p,g,f,y,w,v;return o({Controller:void 0,View:void 0}),{setters:[function(e){t=e},function(e){a=e},function(e){s=e},function(e){r=e},function(e){n=e},function(e){c=e},function(e){i=e},function(e){l=e},function(e){d=e},function(e){u=e},function(e){m=e},function(e){h=e},function(e){p=e},function(e){g=e},function(e){f=e},function(e){y=e}],execute:function(){v=a.Bundle,(w=new v({module:{vspecifier:"@aimpact/chat@1.0.2/documents/access",multibundle:!0},type:"widget"},e.meta.url).package()).dependencies.update([["@beyond-js/widgets/render",t],["@beyond-js/kernel/styles",s],["@beyond-js/react-18-widgets/page",r],["@beyond-js/reactive/model",n],["@aimpact/chat-sdk/core",c],["@aimpact/chat-sdk/session",i],["react",l],["pragmate-ui/link",d],["pragmate-ui/components",u],["pragmate-ui/icons",m],["@aimpact/chat/shared/icons",h],["@beyond-js/react-18-widgets/hooks",p],["@aimpact/chat/shared/components",g],["@beyond-js/kernel/routing",f],["@aimpact/chat/shared/hooks",y]]),brequire("@beyond-js/widgets/render").widgets.register([{name:"chat-documents-access",vspecifier:"@aimpact/chat@1.0.2/documents/access.widget",is:"page",route:"/documents/access",layout:"auth-layout"}]),brequire("@beyond-js/kernel/styles").styles.register("@aimpact/chat@1.0.2/documents/access.widget"),(v=new Map).set("./controller",{hash:518706050,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Controller=void 0;var a=e("@beyond-js/react-18-widgets/page"),o=e("./views"),s=e("./store");class r extends a.PageReactWidgetController{#store;createStore(){return this.#store=new s.StoreManager,this.#store}get Widget(){return o.View}show(){this.#store.load(this.uri.qs.get("id"))}}t.Controller=r}}),v.set("./store",{hash:824522972,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.StoreManager=void 0;var a=e("@beyond-js/reactive/model"),s=e("@aimpact/chat-sdk/core"),r=e("@aimpact/chat-sdk/session");class o extends a.ReactiveModel{#model;get model(){return this.#model}#found;get found(){return this.#found}load=async e=>{this.#model&&this.#model.id!==e&&(this.#model=void 0),this.#model=new s.KnowledgeBox,this.#model.on("change",this.triggerEvent),e=await this.#model.load({id:e}),this.#found=!!e.data,this.ready=!0};createChat=async(e,t)=>{var a=new s.Chat,o=r.sessionWrapper.userId;return await a.publish({userId:o,knowledgeBoxId:e,name:"[SAVED] "+t}),{status:!0,chat:a}};saveSharedFolder=async(t,e)=>{try{var a=JSON.parse(localStorage.getItem("sharedFolders"))||[];a.find(e=>e.id===t)||(a.push({id:t,path:"[SAVED] "+e}),localStorage.setItem("sharedFolders",JSON.stringify(a)))}catch(e){console.error(e)}}}t.StoreManager=o}}),v.set("./views/empty-view",{hash:927283083,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyView=void 0;var a=e("react"),o=e("pragmate-ui/link"),s=e("pragmate-ui/components"),r=e("pragmate-ui/icons"),n=e("@aimpact/chat/shared/icons");t.EmptyView=()=>a.default.createElement("div",{className:"access__folder"},a.default.createElement("img",{alt:"Shared folder",src:"/assets/shared-folder.png"}),a.default.createElement("span",{className:"access-details"},a.default.createElement(r.Icon,{icon:n.ICONS["aip-chat-logo"],className:"acccess__ailogo"}),a.default.createElement("h1",null,"Welcome to AIM Chat"),a.default.createElement("p",null,a.default.createElement("strong",null,"No pudimos encontrar la carpeta compartida!"),a.default.createElement("br",null),"Revisa que el link se haya copiado correctamente."),a.default.createElement(o.Link,{href:"/documents"},a.default.createElement(s.Button,{icon:"folder",label:"Ir a documentos"}))))}}),v.set("./views/index",{hash:1330162277,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.View=function({store:a}){const[e,t]=d.default.useState(a.ready),[o,s]=d.default.useState(!1),[,r]=d.default.useState(!1),[n,c]=(0,v.useTexts)(b.module.specifier);if((0,u.useBinder)([a],()=>t(a.ready)),!e||!n)return d.default.createElement(p.PreloadScreen,null);if(!a.found)return d.default.createElement(g.EmptyView,null);const i=a.model,l=async()=>{try{var e,t=await a.createChat(i.id,i.path);await a.saveSharedFolder(i.id,i.path),t.status?(e=t.chat.id,w.routing.pushState("/chat/"+e)):console.error(t.message)}catch(e){console.error(e.message)}};return d.default.createElement("div",{className:"access__folder"},d.default.createElement("img",{alt:"Shared folder",src:"/assets/shared-folder.png"}),d.default.createElement("span",{className:"access-details"},d.default.createElement(h.Icon,{icon:f.ICONS["aip-chat-logo"],className:"acccess__ailogo"}),d.default.createElement("h1",null,c.welcome),d.default.createElement("p",null,d.default.createElement("strong",null,"Knowledge Box ",i.path.toUpperCase()," has been shared with you."),d.default.createElement("br",null),c.save),y.sessionWrapper.logged?d.default.createElement(m.Button,{variant:"primary",onClick:l,icon:"save"},c.action):d.default.createElement(m.Button,{icon:"google",onClick:async e=>{try{s(!0);var t=await y.sessionWrapper.signInWithGoogle();t.status?l():"POPUP_CLOSED_BY_USER"===t.error?s(!1):r("Error trying to login with Google")}catch(e){console.error(e.message)}},loading:o,label:"Google Sign In"})))};var d=e("react"),u=e("@beyond-js/react-18-widgets/hooks"),m=e("pragmate-ui/components"),h=e("pragmate-ui/icons"),p=e("@aimpact/chat/shared/components"),g=e("./empty-view"),f=e("@aimpact/chat/shared/icons"),y=e("@aimpact/chat-sdk/session"),w=e("@beyond-js/kernel/routing"),v=e("@aimpact/chat/shared/hooks"),b=e("beyond_context")}}),w.exports.descriptor=[{im:"./controller",from:"Controller",name:"Controller"},{im:"./views/index",from:"View",name:"View"}],w.exports.process=function({require:e,prop:t,value:a}){!e&&"Controller"!==t||o("Controller",e?e("./controller").Controller:a),!e&&"View"!==t||o("View",e?e("./views/index").View:a)},o("__beyond_pkg",w),o("hmr",new function(){this.on=(e,t)=>w.hmr.on(e,t),this.off=(e,t)=>w.hmr.off(e,t)}),w.initialise(v)}}});