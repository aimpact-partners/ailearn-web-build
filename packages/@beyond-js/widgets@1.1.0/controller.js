System.register(["@beyond-js/kernel@0.1.9/bundle","@beyond-js/kernel@0.1.9/core","@beyond-js/widgets@1.1.0/render","@beyond-js/kernel@0.1.9/styles"],function(s,e){"use strict";var t,r,i,n,o,l;return s({WidgetAttributes:void 0,WidgetClientController:void 0,IPageWidgetController:void 0,IWidgetStore:void 0,WidgetControllerBase:void 0,IWidgetRendered:void 0,WidgetServerController:void 0}),{setters:[function(e){t=e},function(e){r=e},function(e){i=e},function(e){n=e}],execute:function(){l=t.Bundle,(o=new l({module:{vspecifier:"@beyond-js/widgets@1.1.0/controller"},type:"ts"},e.meta.url).package()).dependencies.update([["@beyond-js/kernel/core",r],["@beyond-js/widgets/render",i],["@beyond-js/kernel/styles",n]]),(l=new Map).set("./attributes",{hash:424385520,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.WidgetAttributes=void 0;var r=e("@beyond-js/kernel/core");class s extends Map{#widget;#events=new r.Events;on=(e,t)=>this.#events.on(e,t);off=(e,t)=>this.#events.off(e,t);constructor(t){super(),(this.#widget=t).specs.attrs?.forEach(e=>this.set(e,t.getAttribute(e)))}change(e,t,r){this.set(e,r),this.#events.trigger("change"),this.#events.trigger(e+":change",r)}}t.WidgetAttributes=s}}),l.set("./client",{hash:2266435544,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.WidgetClientController=void 0;var r=e("./controller"),s=e("./attributes"),i=e("@beyond-js/kernel/bundle"),n=e("@beyond-js/kernel/styles");class o extends r.WidgetControllerBase{#widget;get widget(){return this.#widget}#store;get store(){return this.#store}#attributes;get attributes(){return this.#attributes}attributeChanged(e,t,r){this.#attributes.change(e,t,r)}get styles(){return this.#widget.styles}constructor(e){super({widget:e}),this.#widget=e,this.#attributes=new s.WidgetAttributes(e);const t=new n.DependenciesStyles(this.specs.vspecifier),r=()=>[...t.elements].map(e=>e.href);this.styles.initialised||this.styles.initialise(r()),t.on("change",()=>this.styles.update(r()))}render(){try{this.mount()}catch(e){console.log(`Error mounting widget controller "${this.#widget.localName}":`),console.log(e.stack)}}refresh(){this.unmount(),this.render()}#refresh=()=>this.refresh();disconnect(){this.unmount()}async initialise(){this.#store=this.createStore?.();var e=this.#widget.ssr.prerender;e&&(e=e?.store,await this.#store?.hydrate(e)),this.#store?.fetch?.(),this.render(),i.instances.has(this.specs.vspecifier)?i.instances.get(this.specs.vspecifier).package().hmr.on("change",this.#refresh):console.log(`Bundle id "${this.specs.vspecifier}" not found. Try refreshing the page.
`+"If the problem still persist, delete the BeyondJS cache and try again.")}}t.WidgetClientController=o}}),l.set("./controller",{hash:1553543307,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.WidgetControllerBase=void 0;var s=e("@beyond-js/widgets/render");t.WidgetControllerBase=class{#specs;get specs(){return this.#specs}get element(){return this.#specs.name}get is(){return this.#specs.is}get route(){return this.#specs.route}get layout(){return this.#specs.layout}#pkg;get pkg(){return this.#pkg}get Widget(){}createStore(e){}constructor({specs:r,widget:e}){if(!r){e=e["localName"];if(!s.widgets.has(e))throw new Error(`Widget name "${e}" is not registered`);r=s.widgets.get(e)}this.#pkg=(()=>{var e=r.vspecifier.split("/"),t=e[0].startsWith("@")?e.shift():void 0,[e]=e.shift().split("@");return t?t+"/"+e:e})(),this.#specs=r}}}}),l.set("./ssr",{hash:2493457565,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.WidgetServerController=void 0;var r=e("./controller"),s=e("@beyond-js/kernel/styles");class i extends r.WidgetControllerBase{#styles=[];get styles(){return this.#styles}constructor(e){super(e),new s.DependenciesStyles(this.specs.vspecifier).elements.forEach(({href:e})=>this.#styles.push(e)),this.#styles.unshift(`##_!${this.pkg}!_##global.css`)}}t.WidgetServerController=i}}),o.exports.descriptor=[{im:"./attributes",from:"WidgetAttributes",name:"WidgetAttributes"},{im:"./client",from:"WidgetClientController",name:"WidgetClientController"},{im:"./controller",from:"IPageWidgetController",name:"IPageWidgetController"},{im:"./controller",from:"IWidgetStore",name:"IWidgetStore"},{im:"./controller",from:"WidgetControllerBase",name:"WidgetControllerBase"},{im:"./ssr",from:"IWidgetRendered",name:"IWidgetRendered"},{im:"./ssr",from:"WidgetServerController",name:"WidgetServerController"}],o.exports.process=function({require:e,prop:t,value:r}){!e&&"WidgetAttributes"!==t||s("WidgetAttributes",e?e("./attributes").WidgetAttributes:r),!e&&"WidgetClientController"!==t||s("WidgetClientController",e?e("./client").WidgetClientController:r),!e&&"IPageWidgetController"!==t||s("IPageWidgetController",e?e("./controller").IPageWidgetController:r),!e&&"IWidgetStore"!==t||s("IWidgetStore",e?e("./controller").IWidgetStore:r),!e&&"WidgetControllerBase"!==t||s("WidgetControllerBase",e?e("./controller").WidgetControllerBase:r),!e&&"IWidgetRendered"!==t||s("IWidgetRendered",e?e("./ssr").IWidgetRendered:r),!e&&"WidgetServerController"!==t||s("WidgetServerController",e?e("./ssr").WidgetServerController:r)},s("__beyond_pkg",o),s("hmr",new function(){this.on=(e,t)=>o.hmr.on(e,t),this.off=(e,t)=>o.hmr.off(e,t)}),o.initialise(l)}}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9hdHRyaWJ1dGVzLnRzIiwiL2NsaWVudC50cyIsIi9jb250cm9sbGVyLnRzIiwiL3Nzci50cyJdLCJuYW1lcyI6WyJfY29yZSIsInJlcXVpcmUiLCJXaWRnZXRBdHRyaWJ1dGVzIiwiTWFwIiwiI3dpZGdldCIsIiNldmVudHMiLCJFdmVudHMiLCJvbiIsImV2ZW50IiwibGlzdGVuZXIiLCJ0aGlzIiwib2ZmIiwiY29uc3RydWN0b3IiLCJ3aWRnZXQiLCJzdXBlciIsInNwZWNzIiwiYXR0cnMiLCJmb3JFYWNoIiwiYXR0ciIsInNldCIsImdldEF0dHJpYnV0ZSIsImNoYW5nZSIsIm5hbWUiLCJvbGQiLCJ2YWx1ZSIsInRyaWdnZXIiLCJleHBvcnRzIiwiX2NvbnRyb2xsZXIiLCJfYXR0cmlidXRlcyIsIl9idW5kbGUiLCJfc3R5bGVzIiwiV2lkZ2V0Q2xpZW50Q29udHJvbGxlciIsIldpZGdldENvbnRyb2xsZXJCYXNlIiwiI3N0b3JlIiwic3RvcmUiLCIjYXR0cmlidXRlcyIsImF0dHJpYnV0ZXMiLCJhdHRyaWJ1dGVDaGFuZ2VkIiwic3R5bGVzIiwiRGVwZW5kZW5jaWVzU3R5bGVzIiwidnNwZWNpZmllciIsImxpbmtzIiwiZWxlbWVudHMiLCJtYXAiLCJzdHlsZSIsImhyZWYiLCJpbml0aWFsaXNlZCIsImluaXRpYWxpc2UiLCJ1cGRhdGUiLCJyZW5kZXIiLCJtb3VudCIsImV4YyIsImNvbnNvbGUiLCJsb2ciLCJsb2NhbE5hbWUiLCJzdGFjayIsInJlZnJlc2giLCJ1bm1vdW50IiwiI3JlZnJlc2giLCJkaXNjb25uZWN0IiwiY3JlYXRlU3RvcmUiLCJwcmVyZW5kZXIiLCJzc3IiLCJjYWNoZWQiLCJhd2FpdCIsImh5ZHJhdGUiLCJmZXRjaCIsImluc3RhbmNlcyIsImhhcyIsImdldCIsInBhY2thZ2UiLCJobXIiLCJfcmVuZGVyIiwiI3NwZWNzIiwiZWxlbWVudCIsImlzIiwicm91dGUiLCJsYXlvdXQiLCIjcGtnIiwicGtnIiwiV2lkZ2V0IiwibGFuZ3VhZ2UiLCJ3aWRnZXRzIiwiRXJyb3IiLCJzcGxpdCIsInNjb3BlIiwic3RhcnRzV2l0aCIsInNoaWZ0IiwiV2lkZ2V0U2VydmVyQ29udHJvbGxlciIsIiNzdHlsZXMiLCJwYXJhbXMiLCJwdXNoIiwidW5zaGlmdCJdLCJtYXBwaW5ncyI6IjAxQkFBQSxJQUFBQSxFQUFBQyxFQUFBLHdCQUFBLFFBR01DLFVBQXlCQyxJQUU5QkMsUUFFQUMsUUFBVSxJQUFJTCxFQUFBTSxPQUNkQyxHQUFLQSxDQUFDQyxFQUFlQyxJQUFrQkMsS0FBS0wsUUFBUUUsR0FBR0MsRUFBT0MsQ0FBUSxFQUN0RUUsSUFBTUEsQ0FBQ0gsRUFBZUMsSUFBa0JDLEtBQUtMLFFBQVFNLElBQUlILEVBQU9DLENBQVEsRUFFeEVHLFlBQVlDLEdBQ1hDLE1BQUssR0FDTEosS0FBS04sUUFBVVMsR0FFcUJFLE1BQU1DLE9BQ25DQyxRQUFRQyxHQUFRUixLQUFLUyxJQUFJRCxFQUFNTCxFQUFPTyxhQUFhRixDQUFJLENBQUMsQ0FBQyxDQUNqRSxDQUVBRyxPQUFPQyxFQUFjQyxFQUFhQyxHQUNqQ2QsS0FBS1MsSUFBSUcsRUFBTUUsQ0FBSyxFQUNwQmQsS0FBS0wsUUFBUW9CLFFBQVEsUUFBUSxFQUM3QmYsS0FBS0wsUUFBUW9CLFFBQVdILEVBQUgsVUFBa0JFLENBQUssQ0FDN0MsQyxDQUNBRSxFQUFBeEIsaUJBQUFBLEMsNklDeEJELElBQUF5QixFQUFBMUIsRUFBQSxjQUFBLEVBQ0EyQixFQUFBM0IsRUFBQSxjQUFBLEVBQ0E0QixFQUFBNUIsRUFBQSwwQkFBQSxFQUVBNkIsRUFBQTdCLEVBQUEsMEJBQUEsUUFNZThCLFVBQStCSixFQUFBSyxxQkFRcEM1QixRQUNUUyxhQUNDLE9BQU9ILEtBQUtOLE9BQ2IsQ0FFQTZCLE9BQ0FDLFlBQ0MsT0FBT3hCLEtBQUt1QixNQUNiLENBRVNFLFlBQ1RDLGlCQUNDLE9BQU8xQixLQUFLeUIsV0FDYixDQUVBRSxpQkFBaUJmLEVBQWNDLEVBQWFDLEdBQzNDZCxLQUFLeUIsWUFBWWQsT0FBT0MsRUFBTUMsRUFBS0MsQ0FBSyxDQUN6QyxDQUVBYyxhQUVDLE9BRG9DNUIsS0FBS04sUUFBU2tDLE1BRW5ELENBRUExQixZQUFzQkMsR0FDckJDLE1BQU0sQ0FBRUQsT0FBQUEsQ0FBTSxDQUFFLEVBQ2hCSCxLQUFLTixRQUFVUyxFQUNmSCxLQUFLeUIsWUFBYyxJQUFJUCxFQUFBMUIsaUJBQWlCVyxDQUFNLEVBRTlDLE1BQU15QixFQUFTLElBQUlSLEVBQUFTLG1CQUFtQjdCLEtBQUtLLE1BQU15QixVQUFVLEVBQ3JEQyxFQUFRQSxJQUFNLENBQUMsR0FBR0gsRUFBT0ksVUFBVUMsSUFBSUMsR0FBU0EsRUFBTUMsSUFBSSxFQUUvRG5DLEtBQUs0QixPQUFPUSxhQUFlcEMsS0FBSzRCLE9BQU9TLFdBQVdOLEVBQUssQ0FBRSxFQUMxREgsRUFBTy9CLEdBQUcsU0FBVSxJQUFNRyxLQUFLNEIsT0FBT1UsT0FBT1AsRUFBSyxDQUFFLENBQUMsQ0FDdEQsQ0FNQVEsU0FDQyxJQUNDdkMsS0FBS3dDLE1BQUssQyxDQUNULE1BQU9DLEdBQ1JDLFFBQVFDLHlDQUF5QzNDLEtBQUtOLFFBQVFrRCxhQUFhLEVBQzNFRixRQUFRQyxJQUFJRixFQUFJSSxLQUFLLEMsQ0FFdkIsQ0FFQUMsVUFDQzlDLEtBQUsrQyxRQUFPLEVBQ1ovQyxLQUFLdUMsT0FBTSxDQUNaLENBRUFTLFNBQVdBLElBQU1oRCxLQUFLOEMsUUFBTyxFQUs3QkcsYUFDQ2pELEtBQUsrQyxRQUFPLENBQ2IsQ0FFQVYsbUJBQ0NyQyxLQUFLdUIsT0FBU3ZCLEtBQUtrRCxjQUFhLEVBR2hDLElBQU1DLEVBQXVCbkQsS0FBS04sUUFBUzBELElBQUlELFVBQzNDQSxJQUNHRSxFQUFTRixHQUFXM0IsTUFDMUI4QixNQUFNdEQsS0FBS3VCLFFBQVFnQyxRQUFRRixDQUFNLEdBR2xDckQsS0FBS3VCLFFBQVFpQyxRQUFPLEVBRXBCeEQsS0FBS3VDLE9BQU0sRUFHTnBCLEVBQUFzQyxVQUFRQyxJQUFJMUQsS0FBS0ssTUFBTXlCLFVBQVUsRUFPMUJYLEVBQUFzQyxVQUFRRSxJQUFJM0QsS0FBS0ssTUFBTXlCLFVBQVUsRUFBRThCLFFBQU8sRUFDbERDLElBQUloRSxHQUFHLFNBQVVHLEtBQUtnRCxRQUFRLEVBUGpDTixRQUFRQyxrQkFDTzNDLEtBQUtLLE1BQU15QjtFQUN4Qix3RUFBd0UsQ0FNNUUsQyxDQUNBZCxFQUFBSyx1QkFBQUEsQywrSUN6R0QsSUFBQXlDLEVBQUF2RSxFQUFBLDJCQUFBLEVBcUZDeUIsRUFBQU0sMkJBNURTeUMsT0FDVDFELFlBQ0MsT0FBT0wsS0FBSytELE1BQ2IsQ0FFQUMsY0FDQyxPQUFPaEUsS0FBSytELE9BQU9uRCxJQUNwQixDQUVBcUQsU0FDQyxPQUFPakUsS0FBSytELE9BQU9FLEVBQ3BCLENBRUFDLFlBQ0MsT0FBT2xFLEtBQUsrRCxPQUFPRyxLQUNwQixDQUVBQyxhQUNDLE9BQU9uRSxLQUFLK0QsT0FBT0ksTUFDcEIsQ0FFU0MsS0FDVEMsVUFDQyxPQUFPckUsS0FBS29FLElBQ2IsQ0FJQUUsY0FJQXBCLFlBQVlxQixJQVlackUsWUFBc0IsQ0FBRUcsTUFBQUEsRUFBT0YsT0FBQUEsQ0FBTSxHQUNwQyxHQUFJLENBQUNFLEVBQU8sQ0FDSHVDLEVBQWN6QyxFQUFkeUMsYUFDUixHQUFJLENBQUNrQixFQUFBVSxRQUFRZCxJQUFJZCxDQUFTLEVBQUcsTUFBTSxJQUFJNkIsc0JBQXNCN0Isc0JBQThCLEVBQzNGdkMsRUFBUXlELEVBQUFVLFFBQVFiLElBQUlmLENBQVMsQyxDQUc5QjVDLEtBQUtvRSxNQUFPLEtBQ1gsSUFBTU0sRUFBUXJFLEVBQU15QixXQUFXNEMsTUFBTSxHQUFHLEVBQ2xDQyxFQUFRRCxFQUFNLEdBQUdFLFdBQVcsR0FBRyxFQUFJRixFQUFNRyxNQUFLLEVBQUssS0FBQSxFQUNuRCxDQUFDakUsR0FBUThELEVBQU1HLE1BQUssRUFBR0gsTUFBTSxHQUFHLEVBQ3RDLE9BQU9DLEVBQVdBLEVBQUgsSUFBWS9ELEVBQVNBLENBQ3BDLEdBQUMsRUFFRlosS0FBSytELE9BQVMxRCxDQUNmLEMsMklDckZELElBQUFZLEVBQUExQixFQUFBLGNBQUEsRUFDQTZCLEVBQUE3QixFQUFBLDBCQUFBLFFBaUJldUYsVUFBK0I3RCxFQUFBSyxxQkFDcEN5RCxRQUFvQixHQUM3Qm5ELGFBQ0MsT0FBTzVCLEtBQUsrRSxPQUNiLENBRUE3RSxZQUFzQjhFLEdBQ3JCNUUsTUFBTTRFLENBQU0sRUFDRyxJQUFJNUQsRUFBQVMsbUJBQW1CN0IsS0FBS0ssTUFBTXlCLFVBQVUsRUFDcERFLFNBQVN6QixRQUFRLENBQUEsQ0FBRzRCLEtBQUFBLENBQXdCLElBQUtuQyxLQUFLK0UsUUFBUUUsS0FBSzlDLENBQUksQ0FBQyxFQUUvRW5DLEtBQUsrRSxRQUFRRyxlQUFlbEYsS0FBS3FFLG1CQUFtQixDQUNyRCxDLENBR0FyRCxFQUFBOEQsdUJBQUFBIn0=