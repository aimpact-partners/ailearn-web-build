System.register(["@beyond-js/kernel@0.1.9/bundle","@beyond-js/kernel@0.1.9/core","@beyond-js/widgets@1.1.0/render","@beyond-js/kernel@0.1.9/styles"],function(s,e){"use strict";var t,r,i,n,o,l;return s({WidgetAttributes:void 0,WidgetClientController:void 0,IPageWidgetController:void 0,IWidgetStore:void 0,WidgetControllerBase:void 0,IWidgetRendered:void 0,WidgetServerController:void 0}),{setters:[function(e){t=e},function(e){r=e},function(e){i=e},function(e){n=e}],execute:function(){l=t.Bundle,(o=new l({module:{vspecifier:"@beyond-js/widgets@1.1.0/controller"},type:"ts"},e.meta.url).package()).dependencies.update([["@beyond-js/kernel/core",r],["@beyond-js/widgets/render",i],["@beyond-js/kernel/styles",n]]),(l=new Map).set("./attributes",{hash:424385520,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.WidgetAttributes=void 0;var r=e("@beyond-js/kernel/core");class s extends Map{#widget;#events=new r.Events;on=(e,t)=>this.#events.on(e,t);off=(e,t)=>this.#events.off(e,t);constructor(t){super(),(this.#widget=t).specs.attrs?.forEach(e=>this.set(e,t.getAttribute(e)))}change(e,t,r){this.set(e,r),this.#events.trigger("change"),this.#events.trigger(e+":change",r)}}t.WidgetAttributes=s}}),l.set("./client",{hash:2266435544,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.WidgetClientController=void 0;var r=e("./controller"),s=e("./attributes"),i=e("@beyond-js/kernel/bundle"),n=e("@beyond-js/kernel/styles");class o extends r.WidgetControllerBase{#widget;get widget(){return this.#widget}#store;get store(){return this.#store}#attributes;get attributes(){return this.#attributes}attributeChanged(e,t,r){this.#attributes.change(e,t,r)}get styles(){return this.#widget.styles}constructor(e){super({widget:e}),this.#widget=e,this.#attributes=new s.WidgetAttributes(e);const t=new n.DependenciesStyles(this.specs.vspecifier),r=()=>[...t.elements].map(e=>e.href);this.styles.initialised||this.styles.initialise(r()),t.on("change",()=>this.styles.update(r()))}render(){try{this.mount()}catch(e){console.log(`Error mounting widget controller "${this.#widget.localName}":`),console.log(e.stack)}}refresh(){this.unmount(),this.render()}#refresh=()=>this.refresh();disconnect(){this.unmount()}async initialise(){this.#store=this.createStore?.();var e=this.#widget.ssr.prerender;e&&(e=e?.store,await this.#store?.hydrate(e)),this.#store?.fetch?.(),this.render(),i.instances.has(this.specs.vspecifier)?i.instances.get(this.specs.vspecifier).package().hmr.on("change",this.#refresh):console.log(`Bundle id "${this.specs.vspecifier}" not found. Try refreshing the page.
`+"If the problem still persist, delete the BeyondJS cache and try again.")}}t.WidgetClientController=o}}),l.set("./controller",{hash:1553543307,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.WidgetControllerBase=void 0;var s=e("@beyond-js/widgets/render");t.WidgetControllerBase=class{#specs;get specs(){return this.#specs}get element(){return this.#specs.name}get is(){return this.#specs.is}get route(){return this.#specs.route}get layout(){return this.#specs.layout}#pkg;get pkg(){return this.#pkg}get Widget(){}createStore(e){}constructor({specs:r,widget:e}){if(!r){if(e=e.localName,!s.widgets.has(e))throw new Error(`Widget name "${e}" is not registered`);r=s.widgets.get(e)}this.#pkg=(()=>{var e=(t=r.vspecifier.split("/"))[0].startsWith("@")?t.shift():void 0,[t]=t.shift().split("@");return e?e+"/"+t:t})(),this.#specs=r}}}}),l.set("./ssr",{hash:2493457565,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.WidgetServerController=void 0;var r=e("./controller"),s=e("@beyond-js/kernel/styles");class i extends r.WidgetControllerBase{#styles=[];get styles(){return this.#styles}constructor(e){super(e),new s.DependenciesStyles(this.specs.vspecifier).elements.forEach(({href:e})=>this.#styles.push(e)),this.#styles.unshift(`##_!${this.pkg}!_##global.css`)}}t.WidgetServerController=i}}),o.exports.descriptor=[{im:"./attributes",from:"WidgetAttributes",name:"WidgetAttributes"},{im:"./client",from:"WidgetClientController",name:"WidgetClientController"},{im:"./controller",from:"IPageWidgetController",name:"IPageWidgetController"},{im:"./controller",from:"IWidgetStore",name:"IWidgetStore"},{im:"./controller",from:"WidgetControllerBase",name:"WidgetControllerBase"},{im:"./ssr",from:"IWidgetRendered",name:"IWidgetRendered"},{im:"./ssr",from:"WidgetServerController",name:"WidgetServerController"}],o.exports.process=function({require:e,prop:t,value:r}){!e&&"WidgetAttributes"!==t||s("WidgetAttributes",e?e("./attributes").WidgetAttributes:r),!e&&"WidgetClientController"!==t||s("WidgetClientController",e?e("./client").WidgetClientController:r),!e&&"IPageWidgetController"!==t||s("IPageWidgetController",e?e("./controller").IPageWidgetController:r),!e&&"IWidgetStore"!==t||s("IWidgetStore",e?e("./controller").IWidgetStore:r),!e&&"WidgetControllerBase"!==t||s("WidgetControllerBase",e?e("./controller").WidgetControllerBase:r),!e&&"IWidgetRendered"!==t||s("IWidgetRendered",e?e("./ssr").IWidgetRendered:r),!e&&"WidgetServerController"!==t||s("WidgetServerController",e?e("./ssr").WidgetServerController:r)},s("__beyond_pkg",o),s("hmr",new function(){this.on=(e,t)=>o.hmr.on(e,t),this.off=(e,t)=>o.hmr.off(e,t)}),o.initialise(l)}}});