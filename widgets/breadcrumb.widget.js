System.register(["@beyond-js/widgets@1.1.0/render","@beyond-js/kernel@0.1.9/bundle","@beyond-js/kernel@0.1.9/styles","@beyond-js/react-18-widgets@1.1.2/base","@beyond-js/widgets@1.1.0/controller","@aimpact/ailearn-sdk@1.0.0/reactive/model","@beyond-js/kernel@0.1.9/routing","@beyond-js/kernel@0.1.9/texts","react@18.2.0","pragmate-ui@1.0.0-beta.6/breadcrumb","pragmate-ui@1.0.0-beta.6/base","@beyond-js/react-18-widgets@1.1.2/hooks"],function(s,e){var t,r,i,a,n,o,u,d,c,l,m,b,g,h;return s({Controller:void 0,breadcrumbStore:void 0,BreacrumbStore:void 0,ROUTES:void 0,BredcrumbApp:void 0}),{setters:[function(e){t=e},function(e){r=e},function(e){i=e},function(e){a=e},function(e){n=e},function(e){o=e},function(e){u=e},function(e){d=e},function(e){c=e},function(e){l=e},function(e){m=e},function(e){b=e}],execute:function(){h=r.Bundle,(g=new h({module:{vspecifier:"@aimpact/ailearn-app@0.1.13/widgets/breadcrumb",multibundle:!0},type:"widget"},e.meta.url).package()).dependencies.update([["@beyond-js/widgets/render",t],["@beyond-js/kernel/styles",i],["@beyond-js/react-18-widgets/base",a],["@beyond-js/widgets/controller",n],["@aimpact/ailearn-sdk/reactive/model",o],["@beyond-js/kernel/routing",u],["@beyond-js/kernel/texts",d],["react",c],["pragmate-ui/breadcrumb",l],["pragmate-ui/base",m],["@beyond-js/react-18-widgets/hooks",b]]),brequire("@beyond-js/widgets/render").widgets.register([{name:"app-breadcrumb",vspecifier:"@aimpact/ailearn-app@0.1.13/widgets/breadcrumb.widget"}]),brequire("@beyond-js/kernel/styles").styles.register("@aimpact/ailearn-app@0.1.13/widgets/breadcrumb.widget"),(h=new Map).set("./controller",{hash:1279797166,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Controller=void 0;var r=e("@beyond-js/react-18-widgets/base"),s=e("./store"),i=e("./views");class a extends r.ReactWidgetController{#store;createStore(){return this.#store=s.breadcrumbStore,this.#store}get Widget(){return i.BredcrumbApp}manageWidget(){this.widget.update=this.#store.update,globalThis.a=this.widget}update(){}}t.Controller=a}}),h.set("./store/breadcrumb",{hash:3429007630,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Breadcrumb=void 0;var r=e("@aimpact/ailearn-sdk/reactive/model"),i=e("./item"),a=e("@beyond-js/kernel/routing");class s extends r.ReactiveModel{isStore;#widget;get currentWidget(){return this.#widget}#items=[];#elements=new Map;get elements(){return this.#elements}getItem(){}get items(){return[...this.#elements.values()].map(e=>[e.label,e.link])}#texts;get texts(){return this.#texts}#route;get route(){return this.#route}get lastItem(){return this.#items[this.#items.length-1]}constructor(e,t,r){super(),this.#route=r,this.#texts=e,this.structure=t,super.ready=!0,this.initialize()}initialize(){let s=this.structure.length;a.routing.history.records.entries.length,this.structure.forEach(([e,t],r)=>{s,(e=new i.BreadcrumbItem(this,[e,t],r)).on("change",this.listenItem),this.#elements.set(e.name,e),this.#items.push(e)})}listenItem=()=>{this.trigger("item.changed")};setItem(e){return this.#elements.has(e)?this.#elements.get(e):console.warn(`Breadcrumb item ${e} not found`)}}t.Breadcrumb=s}}),h.set("./store/index",{hash:1656840735,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.breadcrumbStore=t.Store=void 0;var r=e("@aimpact/ailearn-sdk/reactive/model"),s=e("@beyond-js/kernel/texts"),i=e("beyond_context"),a=e("@beyond-js/kernel/routing"),n=e("@beyond-js/widgets/render"),o=e("./routes"),u=e("./breadcrumb");globalThis.widgets=n.widgets;class d extends r.ReactiveModel{#texts=new s.CurrentTexts(i.module.specifier);isStore;get pages(){return[...n.widgets.values()].filter(e=>"page"===e.is)}get ready(){return this.#texts.ready&&super.ready}get texts(){return this.#texts?.value}#widget;get currentWidget(){return this.#widget}#entries=new Map;#breadcrumb;get breadcrumb(){return this.#breadcrumb}getItem(){}constructor(){super(),this.#texts.on("change",this.triggerEvent),this.#texts.on("change",()=>{this.#texts.ready&&this.analyze()}),super.ready=!0,this.#texts.ready&&this.analyze(),a.routing.on("change",this.analyze.bind(this))}triggerBreadcrumbChange=()=>{this.trigger("breadcrumb.changed")};analyze(){if(this.#texts.ready){var e,t=this.pages.find(e=>this.validateStructure(e.route,a.routing.uri.pathname));if(t||console.warn("No page found for breadcrumb",a.routing.uri.pathname),o.ROUTES.hasOwnProperty(t.route))return this.#breadcrumb?.route!==t.route&&(this.#breadcrumb&&(this.#breadcrumb.off("item.changed",this.triggerBreadcrumbChange),this.#breadcrumb=void 0),e=new u.Breadcrumb(this.texts,[...o.ROUTES[t.route]],t.route),this.#entries.set(t.route,e),this.#breadcrumb=e,this.#breadcrumb.on("item.changed",this.triggerBreadcrumbChange),this.#breadcrumb.trigger("item.changed")),this.#breadcrumb;console.warn("No route found for breadcrumb",t.route)}}update(e,t){this.currentWidget}validateStructure(e,t){return e=e.replace(/\$\{[\wáéíóúÁÉÍÓÚñÑ]+\}/g,"[\\w-]+"),new RegExp(`^${e}$`,"g").test(t)}}t.Store=d,e=t.breadcrumbStore=new d,globalThis.bc=e}}),h.set("./store/item",{hash:2286039454,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.BreadcrumbItem=void 0,e=e("@aimpact/ailearn-sdk/reactive/model");class r extends e.ReactiveModel{#name;get name(){return this.#name}set name(e){this.#name=e,this.trigger("change")}#label;get label(){return this.#label??this.#parent.texts[this.#name]}set label(e){this.#label!==e&&(this.#label=e,this.trigger("change"))}#link;get link(){return this.#link}set link(e){this.#link=e,this.trigger("change")}#active;get active(){return this.#active}#index;#parent;constructor(e,t,r){super(),this.#parent=e;var[e,t]=t;this.#index=r,this.#name=e,this.#link=t}}t.BreadcrumbItem=r}}),h.set("./store/routes",{hash:3830857724,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTES=void 0,t.ROUTES={"/community":[["community"]],"/modules/management":[["modules","/modules/list"],["management"]],"/assignments/${id}":[["assignments"]],"/modules/${id}":[["assignments"]],"/modules/list":[["modules"]],"/classrooms/list":[["classrooms"]],"/classrooms/join":[["classrooms","/classrooms/list"],["joinClassroom"]],"/classrooms/create":[["classrooms","/classrooms/list"],["createClassroom"]],"/classrooms/view/${id}":[["classrooms","/classrooms/list"],["view"]],"/organizations/list":[["organizations"]],"/organizations/join":[["organizations","/organizations/list"],["joinOrganization"]],"/organizations/view/${id}":[["organizations","/organizations/list"],["view"]],"/organizations/create":[["organizations","/organizations/list"],["createOrganization"]]}}}),h.set("./store/types",{hash:3228949201,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}}),h.set("./views/index",{hash:210280123,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.BredcrumbApp=function({store:e,className:t}){let r="desktop-breadcrumb"+(t?" "+t:""),[,s]=a.default.useState({}),[,i]=a.default.useState(e.ready);return(0,o.useBinder)([e],()=>i(e.ready)),(0,o.useBinder)([e],()=>s({}),"breadcrumb.changed"),e.ready&&e.breadcrumb?a.default.createElement(n.BreadCrumb,{className:r,items:e.breadcrumb.items,separator:":"}):null};var a=e("react"),n=e("pragmate-ui/breadcrumb"),o=e("@beyond-js/react-18-widgets/hooks")}}),h.set("./views/use-breadcrumb",{hash:4175808204,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.useBreadcrumb=function(){let[r,s]=(0,a.useTexts)(u.module.specifier),[e,i]=n.default.useState([["Home","/"]]);return(0,n.useEffect)(()=>{function t(e,t){return e=e.replace(/\$\{[\wáéíóúÁÉÍÓÚñÑ]+\}/g,"/\\w+"),new RegExp(`^${e}$`,"g").test(t)}var e;r&&(e=c.find(e=>t(e.route,o.routing.uri.pathname)),d.ROUTES.hasOwnProperty(e.route)&&i(d.ROUTES[e.route].map(e=>[s[e[0]],e[1]])),o.routing.on("change",()=>{c.find(e=>t(e.route,o.routing.uri.pathname))}))},[r]),{ready:r,texts:s,items:e}};var a=e("@beyond-js/react-18-widgets/hooks"),n=e("react"),o=e("@beyond-js/kernel/routing"),u=e("beyond_context"),t=e("@beyond-js/widgets/render"),d=e("../store/routes");let c=[...t.widgets.values()].filter(e=>"page"===e.is)}}),g.exports.descriptor=[{im:"./controller",from:"Controller",name:"Controller"},{im:"./store/index",from:"breadcrumbStore",name:"breadcrumbStore"},{im:"./store/index",from:"BreacrumbStore",name:"BreacrumbStore"},{im:"./store/routes",from:"ROUTES",name:"ROUTES"},{im:"./views/index",from:"BredcrumbApp",name:"BredcrumbApp"}],g.exports.process=function({require:e,prop:t,value:r}){!e&&"Controller"!==t||s("Controller",e?e("./controller").Controller:r),!e&&"breadcrumbStore"!==t||s("breadcrumbStore",e?e("./store/index").breadcrumbStore:r),!e&&"BreacrumbStore"!==t||s("BreacrumbStore",e?e("./store/index").BreacrumbStore:r),!e&&"ROUTES"!==t||s("ROUTES",e?e("./store/routes").ROUTES:r),!e&&"BredcrumbApp"!==t||s("BredcrumbApp",e?e("./views/index").BredcrumbApp:r)},s("__beyond_pkg",g),s("hmr",new function(){this.on=(e,t)=>g.hmr.on(e,t),this.off=(e,t)=>g.hmr.off(e,t)}),g.initialise(h)}}});