System.register(["@beyond-js/widgets@1.1.0/render","@beyond-js/kernel@0.1.9/bundle","@beyond-js/kernel@0.1.9/styles","@beyond-js/react-18-widgets@1.1.2/page","@aimpact/ailearn-app@0.0.32/coins-layout.widget","react@18.2.0","@aimpact/ailearn-sdk@1.0.0/learning-modules","@beyond-js/reactive@1.1.12/model","@aimpact/chat-sdk@1.0.0/session","@beyond-js/kernel@0.1.9/texts","pragmate-ui@0.1.1/modal","@aimpact/ailearn-app@0.0.32/components/ui","@aimpact/ailearn-app@0.0.32/components/icons","pragmate-ui@0.1.1/components","pragmate-ui@0.1.1/icons","pragmate-ui@0.1.1/alert","framer-motion@10.18.0","@beyond-js/react-18-widgets@1.1.2/hooks","@aimpact/chat@1.0.1/shared/hooks","pragmate-ui@0.1.1/form/react-select","pragmate-ui@0.1.1/form","@beyond-js/kernel@0.1.9/routing","pragmate-ui@0.1.1/list","@aimpact/ailearn-app@0.0.32/components/navbar-header.code","@aimpact/ailearn-app@0.0.32/config"],function(n,e){"use strict";var t,a,r,o,i,s,l,c,u,d,m,f,v,g,p,h,b,y,w,x,E,C,j,_,M,S,k;return n({Controller:void 0,AIButton:void 0,AIIconButton:void 0,DraftContainer:void 0,Header:void 0,View:void 0}),{setters:[function(e){t=e},function(e){a=e},function(e){r=e},function(e){o=e},function(e){i=e},function(e){s=e},function(e){l=e},function(e){c=e},function(e){u=e},function(e){d=e},function(e){m=e},function(e){f=e},function(e){v=e},function(e){g=e},function(e){p=e},function(e){h=e},function(e){b=e},function(e){y=e},function(e){w=e},function(e){x=e},function(e){E=e},function(e){C=e},function(e){j=e},function(e){_=e},function(e){M=e}],execute:function(){k=a.Bundle,(S=new k({module:{vspecifier:"@aimpact/ailearn-app@0.0.32/modules/draft",multibundle:!0},type:"widget"},e.meta.url).package()).dependencies.update([["@beyond-js/widgets/render",t],["@beyond-js/kernel/styles",r],["@beyond-js/react-18-widgets/page",o],["@aimpact/ailearn-app/coins-layout.widget",i],["react",s],["@aimpact/ailearn-sdk/learning-modules",l],["@beyond-js/reactive/model",c],["@aimpact/chat-sdk/session",u],["@beyond-js/kernel/texts",d],["pragmate-ui/modal",m],["@aimpact/ailearn-app/components/ui",f],["@aimpact/ailearn-app/components/icons",v],["pragmate-ui/components",g],["pragmate-ui/icons",p],["pragmate-ui/alert",h],["framer-motion",b],["@beyond-js/react-18-widgets/hooks",y],["@aimpact/chat/shared/hooks",w],["pragmate-ui/form/react-select",x],["pragmate-ui/form",E],["@beyond-js/kernel/routing",C],["pragmate-ui/list",j],["@aimpact/ailearn-app/components/navbar-header.code",_],["@aimpact/ailearn-app/config",M]]),brequire("@beyond-js/widgets/render").widgets.register([{name:"app-modules-management-ceate",vspecifier:"@aimpact/ailearn-app@0.0.32/modules/draft.widget",is:"page",route:"/modules/management",layout:"coins-layout"}]),brequire("@beyond-js/kernel/styles").styles.register("@aimpact/ailearn-app@0.0.32/modules/draft.widget"),(k=new Map).set("./controller",{hash:4059543509,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Controller=void 0;var a=e("@beyond-js/react-18-widgets/page"),n=e("./store"),r=e("./views");class o extends a.PageReactWidgetController{#store;createStore(){return this.#store=new n.StoreManager,this.#store}get Widget(){return r.View}show(){this.#store.load(this.uri.qs.get("id"),this.uri.qs.get("activityId"))}hide(){this.#store.hide()}}t.Controller=o}}),k.set("./management",{hash:1108312047,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ActivitiesManagement=function({store:e,uri:t}){var[t,,]=n.default.useState(t.qs.get("activityId")||null),a=n.default.useRef(null);return n.default.createElement("div",null,n.default.createElement("app-modules-management",{id:e.model.id,activityId:t,ref:a}))};var n=e("react")}}),k.set("./store",{hash:2422983164,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.StoreManager=void 0;var n=e("@aimpact/ailearn-sdk/learning-modules"),a=e("@beyond-js/reactive/model"),r=e("@aimpact/chat-sdk/session"),o=e("@aimpact/ailearn-app/coins-layout.widget"),i=e("@beyond-js/kernel/texts"),s=e("beyond_context");class l extends a.ReactiveModel{#model;#saved=!1;get saved(){return this.#saved}get model(){return this.#model}#improvements;get improvements(){return this.#improvements}get hasCredits(){return 0<this.#model.credits?.total}#improvementsSelected=new Set;get improvementsSelected(){return this.#improvementsSelected}get user(){return r.sessionWrapper.user}#currentProcess;get currentProcess(){return this.#currentProcess}get ownerships(){return[...r.sessionWrapper.user.organizations.map(e=>({value:e.id,label:e.name}))]}get moduleOwner(){if(this.model.owner)return{value:this.model.owner.id,label:this.model.owner.name}}#selected;get defaultValues(){return{audience:"",duration:45,objective:"",totalActivities:5,language:this.#model.language}}get values(){return this.#saved?this.model.getProperties():this.defaultValues}#texts=new i.CurrentTexts(s.module.specifier);get texts(){return this.#texts?.value}get ready(){return super.ready&&this.#texts.ready}#objectivesGenerated=new Map;constructor(){super(),this.reactiveProps(["fetchingDraft"]),this.#texts.on("change",this.listenTexts)}listenTexts=()=>{this.triggerEvent("change"),this.#texts.ready&&(o.LayoutBroker.breadcrumb=[[this.texts.breadcrumb.modules,"/modules/list"],[this.texts.breadcrumb.management,""]])};hide(){this.#model=void 0,super.ready=!1,this.triggerEvent(),o.LayoutBroker.clear()}clearImprovements(){this.#improvements=void 0,this.triggerEvent("change")}async load(e,t){try{var a;e&&this.#model?.id===e||(a={type:"draft",id:e},this.#model=await n.LearningModule.get(a),this.#model.on("change",this.triggerEvent),this.#saved=!!e,o.LayoutBroker.addModel(this.#model,!0),o.LayoutBroker.canConsumeCredits=this.#saved,super.ready=!0,this.triggerEvent())}catch(e){console.error(e)}}listener(){}async save(e){return this.fetching=!0,await this.model.saveDraft(e),this.fetching=!1,this.triggerEvent(),this.#saved=!0,o.LayoutBroker.canConsumeCredits=!0,this.#model}setBreadcrumb(e){o.LayoutBroker.breadcrumb=e}async clean(){this.#model.activities.clean(),this.#saved=void 0,this.trigger("change")}async getObjectiveImprovements({objective:e}){try{this.#currentProcess="objective",this.fetching=!1;var t=await this.model.getObjectiveImprovements({objective:e});this.#improvements=t,this.triggerEvent("change")}catch(e){console.error(e)}finally{this.#currentProcess=void 0,this.fetching=!1}}async generateObjective({objective:e,improvements:t}){try{var a;return this.#currentProcess="changingObjective",this.fetching=!0,this.#objectivesGenerated.has(t)?this.#objectivesGenerated.get(t):(a=await this.model.generateObjective({objective:e,improvements:t}),this.#objectivesGenerated.set(e,a.objective),this.model.save,this.#model.objective=a.objective,this.#improvements=void 0,this.#improvementsSelected=new Set,this.triggerEvent("change"),this.#model.objective)}catch(e){console.error(e)}finally{this.#currentProcess=void 0,this.fetching=!1}}async generateModuleSuggestion(e){try{return this.#currentProcess="generatingDraft",this.fetchingDraft=!0,await this.model.getModuleSuggestion({...e,test:!0})}catch(e){console.error(e)}finally{this.#currentProcess=void 0,this.fetchingDraft=!1}}}t.StoreManager=l}}),k.set("./use-texts-callback",{hash:4103720571,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.useTextsCallback=function(a,n){const[e,r]=s.useState(!1),[t,o]=s.useState({}),i=(s.useEffect(()=>{const t=new l.CurrentTexts(a),e=()=>{var e=t.value;o(e),r(t.ready),t.ready&&n(e)};return t.on("change",e),e(),()=>{t.on("change",e)}},[]),e&&!!t);return[i,t]};var s=e("react"),l=e("@beyond-js/kernel/texts")}}),k.set("./views/coins/alert",{hash:100216912,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CoinsAlert=function({show:e,onClose:t,texts:a}){return e?(a=a.coins.alert,n.default.createElement(r.AlertModal,{show:!0,buttonLabel:a.action,onConfirm:t,onClose:t},n.default.createElement("header",null,n.default.createElement("h3",null,a.title),n.default.createElement(o.Battery,{percent:"100",className:"lg"}),n.default.createElement("p",null,a.description)))):null};var n=e("react"),r=e("pragmate-ui/modal"),o=e("@aimpact/ailearn-app/components/ui")}}),k.set("./views/coins/coins-modal",{hash:2894868445,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CoinsModal=function({store:e,show:t,onClose:a,texts:n}){if(!t)return null;const[,r]=s.default.useState(!1),[o,i]=s.default.useState();return n=n.coins.modal,s.default.createElement(l.ConfirmModal,{show:!0,className:"modal-sm",actions:{confirm:{label:n.actions.confirm,variant:"primary"},cancel:{label:n.actions.cancel,variant:"primary",bordered:!0}},onConfirm:async()=>{try{r(!0),await e.model.getCredits(),a()}catch(e){i(n.errors.noCredits)}finally{r(!1)}},onCancel:a,onClose:a},s.default.createElement("header",null,s.default.createElement("h3",null,n.title),s.default.createElement(c.ErrorRenderer,{error:o}),s.default.createElement(c.Battery,{percent:"100",className:"lg"}),s.default.createElement("p",null,n.description)))};var s=e("react"),l=e("pragmate-ui/modal"),c=e("@aimpact/ailearn-app/components/ui")}}),k.set("./views/components/ai-button",{hash:3389913736,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AIButton=function({children:e,onClick:t,...a}){return n.default.createElement(o.Button,{...a,icon:r.ICONS.aiStars,onClick:()=>s.LayoutBroker.ensureCredits(t)},e)},t.AIIconButton=function({children:e,onClick:t,...a}){return n.default.createElement(i.IconButton,{...a,icon:r.ICONS.aiStars,onClick:()=>s.LayoutBroker.ensureCredits(t)},e)};var n=e("react"),r=e("@aimpact/ailearn-app/components/icons"),o=e("pragmate-ui/components"),i=e("pragmate-ui/icons"),s=e("@aimpact/ailearn-app/coins-layout.widget")}}),k.set("./views/components/error",{hash:3301282445,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorRenderer=function({texts:e,error:t}){return a.default.createElement(n.Alert,{variant:"error"},e[t])};var a=e("react"),n=e("pragmate-ui/alert")}}),k.set("./views/components/footer",{hash:836744112,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.StepsFooter=function({submitLabel:e="next",onSubmit:t,disabled:a=!1,previous:n=!0}){const{texts:r,setCurrent:o,current:i}=(0,u.useModuleContext)(),s=r.actions[e];return l.default.createElement("footer",null,n&&l.default.createElement(c.Button,{className:"wizard-input",variant:"primary",bordered:!0,onClick:()=>o(i-1)},r.actions.back),l.default.createElement(c.Button,{className:"wizard-input",type:"submit",variant:"primary",onClick:t,disabled:a,sizing:"lg"},s))};var l=e("react"),c=e("pragmate-ui/components"),u=e("../context")}}),k.set("./views/components/html-render",{hash:3362016598,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.HtmlRender=function({children:e,tag:t="span"}){return a.default.createElement(t,{dangerouslySetInnerHTML:{__html:e}})};var a=e("react")}}),k.set("./views/components/options",{hash:369455942,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getOptions=function(e){return{audience:[[e.audience.school,e.audience.school],[e.audience.university,e.audience.university],[e.audience.company,e.audience.company]],duration:[["15",e.duration.brief],["45",e.duration.standard],["60",e.duration.extended]],language:[["en",e.languages.en],["es",e.languages.es],["pt",e.languages.pt],["fr",e.languages.fr],["de",e.languages.de]]}}}}),k.set("./views/components/radio-button",{hash:54679154,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.RadioButton=function({name:n,onChange:r,label:e,selected:t=0}){const{texts:a,store:o}=(0,d.useModuleContext)(),i={disabled:o.fetching||o.model.fetching},s=(0,m.getOptions)(a),l=s[n].map(([e,t],a)=>c.default.createElement(u.Button,{name:n,...i,"data-index":a,onClick:r,key:a,value:e},t));return c.default.createElement("div",{className:"radio-button__container"},c.default.createElement("label",{htmlFor:n},e),c.default.createElement(u.ButtonGroup,{selected:t,...i},l))};var c=e("react"),u=e("pragmate-ui/components"),d=e("../context"),m=e("./options")}}),k.set("./views/context",{hash:491328270,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.useSuggestionsContext=t.useModuleContext=t.useDraftManagementContext=t.SuggestionsContext=t.ModuleContext=t.DraftManagementContext=void 0;var a=e("react");const n=t.ModuleContext=a.default.createContext({}),r=(t.useModuleContext=()=>a.default.useContext(n),t.DraftManagementContext=a.default.createContext({})),o=(t.useDraftManagementContext=()=>a.default.useContext(r),t.SuggestionsContext=a.default.createContext({}));t.useSuggestionsContext=()=>a.default.useContext(o)}}),k.set("./views/form/animated-div",{hash:2099872162,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AnimatedDiv=function({children:e}={children:null,cls:""}){return a.default.createElement(n.motion.div,{className:"wizard__container",initial:{opacity:0},animate:{opacity:1,transition:{duration:.3,delay:.3},y:0},exit:{transition:{duration:.3},opacity:0}},e)};var a=e("react"),n=e("framer-motion")}}),k.set("./views/form/container",{hash:858841082,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DraftContainer=function({store:e}){const[t,a]=(0,x.useTexts)(E.module.specifier),[n,r]=h.useState(e.fetching),[o]=h.useState(0),[,i]=h.useState({}),[s,l]=h.useState(0),[c,u]=h.useState(e.values),[d,m]=h.useState(),[f,v]=h.useState(!1),g=(0,w.useDraftManagementContext)().ensureCredits;var p;return(0,b.useBinder)([e],()=>{i({}),r(e?.model?.fetching)}),t&&e.ready?(p={store:e,onChange:e=>{u({...c,[e.currentTarget.name]:e.currentTarget.value})},texts:a,activePanel:o,current:s,setCurrent:l,error:d,ensureCredits:g,setError:m,fetching:n||f,setIsFetching:v,saved:e.saved,values:c,setValues:u},h.createElement(h.Fragment,null,h.createElement(w.ModuleContext.Provider,{value:p},h.createElement(y.PageContainer,{className:" "+(n?"is-fetching":""),fetching:n&&!!e.model?.activities.length},h.createElement(C.DraftForm,null))))):null};var h=e("react"),b=e("@beyond-js/react-18-widgets/hooks"),y=e("@aimpact/ailearn-app/components/ui"),w=e("../context"),x=e("@aimpact/chat/shared/hooks"),E=e("beyond_context"),C=e("./")}}),k.set("./views/form/fields/grade",{hash:3857354124,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.GradeField=function(){const{texts:t,store:e,texts:{wizard:a}}=(0,u.useModuleContext)(),{setValues:n,values:r}=(0,u.useModuleContext)();let o={value:"",label:a.grades.select};var i=Object.keys(t.grades).map(e=>(o=e===r.audience?{value:e,label:t.grades[e]}:o,{value:e,label:t.grades[e]})),s={isDisabled:e.saved};return l.default.createElement("div",null,l.default.createElement("label",{htmlFor:""},a.grades.label),l.default.createElement(c.ReactSelect,{name:"audience",placeholder:a.grades.select,options:i,onChange:t=>n(e=>({...e,audience:t.target.value})),...s}))};var l=e("react"),c=e("pragmate-ui/form/react-select"),u=e("../../context")}}),k.set("./views/form/fields/language",{hash:630405900,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.LanguageField=function(){const{texts:t,store:e,texts:{},setValues:a}=(0,s.useModuleContext)(),n=["en","es"].map(e=>({value:e,label:t.languages[e]})),r={isDisabled:e.saved};return o.default.createElement("div",null,o.default.createElement("label",{htmlFor:""},t.languages.select.label),o.default.createElement(i.ReactSelect,{placeholder:t.languages.select.placeholder,value:e.model.language,name:"audience",options:n,onChange:t=>a(e=>({...e,language:t.target.value})),...r}))};var o=e("react"),i=e("pragmate-ui/form/react-select"),s=e("../../context")}}),k.set("./views/form/fields/module-length",{hash:1770237194,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DurationField=function(){const{store:e,texts:t,values:a,setValues:n}=(0,l.useModuleContext)(),r={isDisabled:e.saved},o=[{value:15,label:t.duration.brief,totalActivities:3},{value:45,label:t.duration.standard,totalActivities:5},{value:60,label:t.duration.extended,totalActivities:7}];return a?.audienceIndex&&parseInt(a.duration),a?.duration?.index&&parseInt(a.duration.index),a.duration&&o.find(e=>e.value===a.duration),i.default.createElement("div",null,i.default.createElement("label",{htmlFor:""},t.wizard.duration.label),i.default.createElement(s.ReactSelect,{placeholder:t.wizard.duration.placeholder,onChange:t=>{const a=o.find(e=>e.value===parseInt(t.target.value));n(e=>({...e,duration:t.target.value,totalActivities:a.totalActivities}))},name:"duration",value:a.duration,...r,options:o}))};var i=e("react"),s=e("pragmate-ui/form/react-select"),l=e("../../context")}}),k.set("./views/form/fields/objective",{hash:1366466996,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectiveField=function({submitted:e}){var{values:t,texts:{wizard:{messages:a,objective:n}},onChange:r}=(0,s.useModuleContext)();return o.default.createElement("div",{className:"objective-field"},o.default.createElement(i.Textarea,{onChange:r,value:t.objective,name:"objective",placeholder:n.textArea,counter:!0,maxLength:500}),e&&o.default.createElement(l.motion.div,{className:"success-text",initial:{opacity:0},animate:{opacity:1,transition:{duration:.3}}},a.save," ",o.default.createElement(c.Icon,{icon:"check"})))};var o=e("react"),i=e("pragmate-ui/form"),s=e("../../context"),l=e("framer-motion"),c=e("pragmate-ui/icons")}}),k.set("./views/form/fields/ownership",{hash:1198927874,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.OwnershipField=function(){const{texts:{wizard:e},store:{},store:n}=(0,s.useModuleContext)(),r=(0,s.useModuleContext)().setValues;e.schools.select,n.model.owner&&(n.model.owner.id,n.model.owner.name);var t=n.model.owner?.id,a={isDisabled:0===n.ownerships.length||n.saved};return o.default.createElement("div",null,o.default.createElement("label",{htmlFor:""},e.schools.label),o.default.createElement(i.ReactSelect,{value:t,placeholder:e.schools.select,name:"owner",options:n.ownerships,onChange:t=>{const a=n.user.organizations.find(e=>e.id===t.target.value);r(e=>({...e,owner:a}))},...a}))};var o=e("react"),i=e("pragmate-ui/form/react-select"),s=e("../../context")}}),k.set("./views/form/index",{hash:1290993653,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DraftForm=function(){const{values:t,error:e,setValues:a,store:n,texts:r,saved:o,fetching:i}=(0,p.useModuleContext)(),[s,l]=v.default.useState(!1),[c,u]=v.default.useState(!1),d=!(t.owner&&t.audience&&t.duration&&t.objective&&t.language),m=n.model.state&&o?r.actions.continue:r.actions.save,f=r.hasOwnProperty(n.currentProcess)?r[n.currentProcess]:r.objectiveSuggestions;return v.default.createElement("form",{className:"form-create-draft__container"},v.default.createElement(_.ErrorRenderer,{error:e,texts:r}),v.default.createElement(g.AnimatedDiv,null,v.default.createElement("section",{className:"form-body"},v.default.createElement("header",{className:"wizard-form-header"},v.default.createElement("h1",null,r.wizard.introduction.title),v.default.createElement("span",null,r.wizard.introduction.subtitle)),v.default.createElement("section",{className:"wizard-first-step-container"},v.default.createElement(S.LanguageField,null),v.default.createElement(w.OwnershipField,null),v.default.createElement(b.GradeField,null),v.default.createElement(y.DurationField,null)),v.default.createElement("div",{className:"form-wizard__objective-section"},v.default.createElement(x.ObjectiveField,{submitted:c}))),v.default.createElement(j.ObjectiveSuggestions,null),v.default.createElement("footer",null,v.default.createElement(C.Button,{className:"wizard-input",type:"submit",block:!0,disabled:d,variant:"primary",onClick:async()=>{try{(o&&"created"===n.model.state?l:(await n.save({...t,state:"created"}),E.routing.replaceState({},void 0,"/modules/management?id="+n.model.id),u))(!0)}catch(e){console.error(e)}}},m))),v.default.createElement(h.ProcessContainer,{fetching:i},v.default.createElement(h.RotatingMessage,{time:"8000",content:f})),v.default.createElement(M.ModalActivitiesGeneration,{show:s,onClose:()=>l(!1),onSave:async()=>{var e={...t,state:"confirmed"};a({...e}),await n.save({...e})}}))};var v=e("react"),g=e("./animated-div"),p=e("../context"),h=e("@aimpact/ailearn-app/components/ui"),b=e("./fields/grade"),y=e("./fields/module-length"),w=e("./fields/ownership"),x=e("./fields/objective"),E=e("@beyond-js/kernel/routing"),C=e("pragmate-ui/components"),j=e("./suggestions"),_=e("../components/error"),M=e("../modal-activities"),S=e("./fields/language")}}),k.set("./views/form/suggestions/action",{hash:3089290480,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestionsAction=function({}){const{texts:{actions:e,...t},store:a,values:n,saved:r}=(0,i.useModuleContext)();return o.default.createElement(o.default.Fragment,null,a?.improvements?.irrelevant&&o.default.createElement(s.Alert,{className:"mb-30",type:"warning"},t.suggestions.irrelevant),o.default.createElement("div",{className:"flex-container flex-center flex-05"},o.default.createElement(l.AIButton,{disabled:!r,onClick:async()=>{try{await a.getObjectiveImprovements({objective:n.objective})}catch(e){console.error(e)}},variant:"primary",bordered:!0},e.analyse)))};var o=e("react"),i=e("../../context"),s=e("pragmate-ui/alert"),l=e("../../components/ai-button")}}),k.set("./views/form/suggestions/index",{hash:3766540706,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectiveSuggestions=function(){var e=(0,r.useModuleContext)().store,[t,a]=n.default.useState(!1);return!e.improvements||e.improvements.irrelevant?n.default.createElement(i.SuggestionsAction,null):n.default.createElement(r.SuggestionsContext.Provider,{value:{improvedObjective:t,setImprovedObjective:a}},n.default.createElement(o.ObjectiveImproved,null),n.default.createElement(s.SuggestionsList,{block:!t}))};var n=e("react"),r=e("../../context"),o=e("./objective"),i=e("./action"),s=e("./list")}}),k.set("./views/form/suggestions/list/index",{hash:1853802744,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestionsList=function({block:e}){const{texts:{suggestions:t,actions:a},store:n,values:r,setValues:o}=(0,f.useModuleContext)(),[i,s]=u.default.useState(new Set);var l,c;return n.improvements?(l=n.improvements.suggestions,c={disabled:!i.size||e},u.default.createElement("section",{className:"objective-suggestions__container"+(e?" is-disabled":"")},u.default.createElement(m.List,{className:"objective-suggestions__list",specs:{selected:i,setSelected:s,block:e},control:v.ObjectiveSuggestionsItem,items:l}),u.default.createElement("div",{className:"section__actions"},u.default.createElement("span",null,t.total,": ",i.size),u.default.createElement("div",{className:"section__actions"},u.default.createElement(d.Button,{...c,onClick:()=>{s(new Set),n.clearImprovements()},variant:"primary",bordered:!0},a.removeSuggestions),u.default.createElement(d.Button,{...c,variant:"primary",onClick:async e=>{var t={objective:r.objective,improvements:Array.from(i).map(e=>n.improvements.suggestions[e].suggestion)};await n.generateObjective(t),o(e=>({...e,objective:n.model.objective}))}},a.applySuggestions))))):null};var u=e("react"),d=e("pragmate-ui/components"),m=e("pragmate-ui/list"),f=e("../../../context"),v=e("./item")}}),k.set("./views/form/suggestions/list/item",{hash:4075705557,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectiveSuggestionsItem=function({index:e,item:t,specs:{block:a,selected:n,setSelected:r}}){const{store:o,texts:{suggestions:i}}=(0,u.useModuleContext)(),s="suggestion__item"+(n.has(e)?" selected":""),l={className:s,"data-index":e,onClick:void 0};return a||(l.onClick=e=>{e.stopPropagation();var e=parseInt(e.currentTarget.dataset.index),t=n;t.has(e)?t.delete(e):t.add(e),o.improvementsSelected.add(e),r(new Set(t))}),c.default.createElement("div",{className:s,"data-index":e,...l},c.default.createElement("header",null,c.default.createElement("span",{className:"suggestion-label"},i.origin),c.default.createElement("span",{className:"suggestion-reference"},t.reference)),c.default.createElement("div",{className:"item__content"},c.default.createElement("header",null,c.default.createElement("span",{className:"suggestion-label"},i.label)),t.suggestion))};var c=e("react"),u=e("../../../context")}}),k.set("./views/form/suggestions/objective",{hash:801427851,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectiveImproved=function(){const{texts:{suggestions:{objective:{actions:e}}},store:t,setValues:a,values:n,store:{improvements:r}}=(0,u.useModuleContext)(),{improvedObjective:o,setImprovedObjective:i}=(0,u.useSuggestionsContext)(),s=r.improved;var l;return!r||o?null:(l=async e=>{"true"===e.currentTarget.value&&(await t.save({objective:s}),a({...n,objective:s})),i(!0)},c.default.createElement("div",{className:"objective-suggestion"},c.default.createElement("h3",null,s),c.default.createElement("div",{className:"objective-suggestion__actions"},c.default.createElement("span",{className:"primary-text"},e.label),c.default.createElement("div",{className:"section__actions"},c.default.createElement(d.Button,{variant:"primary",bordered:!0,value:"false",onClick:l},e.cancel),c.default.createElement(d.Button,{variant:"primary",value:"true",onClick:l},e.confirm)))))};var c=e("react"),u=e("../../context"),d=e("pragmate-ui/components")}}),k.set("./views/header/animated-label",{hash:2096490113,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AnimatedLabel=function({children:e}){const[t,a]=n.default.useState(!!e);return n.default.useEffect(()=>{a(e),globalThis.setTimeout(()=>{a(!1)},2e3)},[e]),n.default.createElement(r.AnimatePresence,null,t&&n.default.createElement(r.motion.span,{layout:!0,initial:{opacity:0,width:"0"},animate:{opacity:1,transition:{duration:.3},width:"auto"},exit:{transition:{duration:.3,width:0},opacity:0}},e))};var n=e("react"),r=e("framer-motion")}}),k.set("./views/header/animated",{hash:796986304,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Animated=function({className:e,children:t,as:a="span"}){return a=(0,r.motion)(a),n.default.createElement(a,{layout:!0,className:e,initial:{opacity:0},animate:{opacity:1,transition:{duration:.3}},exit:{transition:{duration:.3,width:0},opacity:0}},t)};var n=e("react"),r=e("framer-motion")}}),k.set("./views/header/index",{hash:446722148,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Header=function(){var{store:e,texts:t}=(0,r.useDraftManagementContext)();return e.saved&&e.hasCredits,n.default.createElement("section",null,n.default.createElement(a.NavbarHeader,{breadcrumb:[[t.breadcrumb.modules,"/modules/list"],[t.breadcrumb.management,""]]}))};var a=e("@aimpact/ailearn-app/components/navbar-header.code"),n=e("react"),r=e("../context")}}),k.set("./views/index",{hash:1371185060,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.View=function(e){const t=e.store,[,a]=s.useState(t.fetching),[,n]=s.useState({}),r=t.texts;var o,i;return(0,l.useBinder)([t],()=>{n({}),a(t?.model?.fetching)}),t.ready?(o="confirmed"===t.model.state?u.ActivitiesManagement:c.DraftContainer,i={texts:r,store:t,ensureCredits:d.LayoutBroker.ensureCredits},s.createElement(s.Fragment,null,s.createElement(m.DraftManagementContext.Provider,{value:i},s.createElement(o,{store:t,uri:e.uri})))):null};var s=e("react"),l=e("@beyond-js/react-18-widgets/hooks"),c=e("./form/container"),u=e("../management"),d=e("@aimpact/ailearn-app/coins-layout.widget"),m=e("./context")}}),k.set("./views/modal-activities",{hash:3699130228,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ModalActivitiesGeneration=function({show:e,onClose:t,onSave:a}){const{texts:n,store:r,values:o,ensureCredits:i}=(0,g.useModuleContext)(),[s,l]=u.default.useState(!1);if(!e)return null;const c=async()=>{try{l(!0),await r.generateModuleSuggestion({...o}),a()}catch(e){console.error(e)}finally{l(!1)}};return u.default.createElement(d.Modal,{show:!0,onClose:t},u.default.createElement("div",{className:"modal__header"},u.default.createElement("h3",null,n.wizard.modalSuggestions.title),u.default.createElement("div",{className:"mt-30"},u.default.createElement("span",null,n.wizard.modalSuggestions.description)),u.default.createElement("footer",{className:"actions mt-30 flex-container flex-center"},u.default.createElement(m.Button,{variant:"primary",bordered:!0,onClick:a},n.wizard.modalSuggestions.buttons.manual),u.default.createElement(v.AIButton,{variant:"primary",onClick:()=>i(c)},n.wizard.modalSuggestions.buttons.generate))),u.default.createElement(f.ProcessContainer,{fetching:s},u.default.createElement(f.RotatingMessage,{time:"8000",content:n.wizard.generatingModule})))};var u=e("react"),d=e("pragmate-ui/modal"),m=e("pragmate-ui/components"),f=e("@aimpact/ailearn-app/components/ui"),v=e("./components/ai-button"),g=e("./context")}}),S.exports.descriptor=[{im:"./controller",from:"Controller",name:"Controller"},{im:"./views/components/ai-button",from:"AIButton",name:"AIButton"},{im:"./views/components/ai-button",from:"AIIconButton",name:"AIIconButton"},{im:"./views/form/container",from:"DraftContainer",name:"DraftContainer"},{im:"./views/header/index",from:"Header",name:"Header"},{im:"./views/index",from:"View",name:"View"}],S.exports.process=function({require:e,prop:t,value:a}){!e&&"Controller"!==t||n("Controller",e?e("./controller").Controller:a),!e&&"AIButton"!==t||n("AIButton",e?e("./views/components/ai-button").AIButton:a),!e&&"AIIconButton"!==t||n("AIIconButton",e?e("./views/components/ai-button").AIIconButton:a),!e&&"DraftContainer"!==t||n("DraftContainer",e?e("./views/form/container").DraftContainer:a),!e&&"Header"!==t||n("Header",e?e("./views/header/index").Header:a),!e&&"View"!==t||n("View",e?e("./views/index").View:a)},n("__beyond_pkg",S),n("hmr",new function(){this.on=(e,t)=>S.hmr.on(e,t),this.off=(e,t)=>S.hmr.off(e,t)}),S.initialise(k)}}});System.register(["@beyond-js/widgets@1.1.0/render","@beyond-js/kernel@0.1.9/bundle","@beyond-js/kernel@0.1.9/styles","@beyond-js/react-18-widgets@1.1.2/page","@aimpact/ailearn-app@0.0.32/coins-layout.widget","react@18.2.0","@aimpact/ailearn-sdk@1.0.0/learning-modules","@beyond-js/reactive@1.1.12/model","@aimpact/chat-sdk@1.0.0/session","@beyond-js/kernel@0.1.9/texts","pragmate-ui@0.1.1/modal","@aimpact/ailearn-app@0.0.32/components/ui","@aimpact/ailearn-app@0.0.32/components/icons","pragmate-ui@0.1.1/components","pragmate-ui@0.1.1/icons","pragmate-ui@0.1.1/alert","framer-motion@10.18.0","@beyond-js/react-18-widgets@1.1.2/hooks","@aimpact/chat@1.0.1/shared/hooks","pragmate-ui@0.1.1/form/react-select","pragmate-ui@0.1.1/form","@beyond-js/kernel@0.1.9/routing","pragmate-ui@0.1.1/list","@aimpact/ailearn-app@0.0.32/components/navbar-header.code","@aimpact/ailearn-app@0.0.32/config"],function(n,e){"use strict";var t,a,r,o,i,s,l,c,u,d,m,f,v,g,p,h,b,y,w,x,E,C,j,_,M,S,k;return n({Controller:void 0,AIButton:void 0,AIIconButton:void 0,DraftContainer:void 0,Header:void 0,View:void 0}),{setters:[function(e){t=e},function(e){a=e},function(e){r=e},function(e){o=e},function(e){i=e},function(e){s=e},function(e){l=e},function(e){c=e},function(e){u=e},function(e){d=e},function(e){m=e},function(e){f=e},function(e){v=e},function(e){g=e},function(e){p=e},function(e){h=e},function(e){b=e},function(e){y=e},function(e){w=e},function(e){x=e},function(e){E=e},function(e){C=e},function(e){j=e},function(e){_=e},function(e){M=e}],execute:function(){k=a.Bundle,(S=new k({module:{vspecifier:"@aimpact/ailearn-app@0.0.32/modules/draft",multibundle:!0},type:"widget"},e.meta.url).package()).dependencies.update([["@beyond-js/widgets/render",t],["@beyond-js/kernel/styles",r],["@beyond-js/react-18-widgets/page",o],["@aimpact/ailearn-app/coins-layout.widget",i],["react",s],["@aimpact/ailearn-sdk/learning-modules",l],["@beyond-js/reactive/model",c],["@aimpact/chat-sdk/session",u],["@beyond-js/kernel/texts",d],["pragmate-ui/modal",m],["@aimpact/ailearn-app/components/ui",f],["@aimpact/ailearn-app/components/icons",v],["pragmate-ui/components",g],["pragmate-ui/icons",p],["pragmate-ui/alert",h],["framer-motion",b],["@beyond-js/react-18-widgets/hooks",y],["@aimpact/chat/shared/hooks",w],["pragmate-ui/form/react-select",x],["pragmate-ui/form",E],["@beyond-js/kernel/routing",C],["pragmate-ui/list",j],["@aimpact/ailearn-app/components/navbar-header.code",_],["@aimpact/ailearn-app/config",M]]),brequire("@beyond-js/widgets/render").widgets.register([{name:"app-modules-management-ceate",vspecifier:"@aimpact/ailearn-app@0.0.32/modules/draft.widget",is:"page",route:"/modules/management",layout:"coins-layout"}]),brequire("@beyond-js/kernel/styles").styles.register("@aimpact/ailearn-app@0.0.32/modules/draft.widget"),(k=new Map).set("./controller",{hash:4059543509,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Controller=void 0;var a=e("@beyond-js/react-18-widgets/page"),n=e("./store"),r=e("./views");class o extends a.PageReactWidgetController{#store;createStore(){return this.#store=new n.StoreManager,this.#store}get Widget(){return r.View}show(){this.#store.load(this.uri.qs.get("id"),this.uri.qs.get("activityId"))}hide(){this.#store.hide()}}t.Controller=o}}),k.set("./management",{hash:1108312047,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ActivitiesManagement=function({store:e,uri:t}){var[t,,]=n.default.useState(t.qs.get("activityId")||null),a=n.default.useRef(null);return n.default.createElement("div",null,n.default.createElement("app-modules-management",{id:e.model.id,activityId:t,ref:a}))};var n=e("react")}}),k.set("./store",{hash:2422983164,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.StoreManager=void 0;var n=e("@aimpact/ailearn-sdk/learning-modules"),a=e("@beyond-js/reactive/model"),r=e("@aimpact/chat-sdk/session"),o=e("@aimpact/ailearn-app/coins-layout.widget"),i=e("@beyond-js/kernel/texts"),s=e("beyond_context");class l extends a.ReactiveModel{#model;#saved=!1;get saved(){return this.#saved}get model(){return this.#model}#improvements;get improvements(){return this.#improvements}get hasCredits(){return 0<this.#model.credits?.total}#improvementsSelected=new Set;get improvementsSelected(){return this.#improvementsSelected}get user(){return r.sessionWrapper.user}#currentProcess;get currentProcess(){return this.#currentProcess}get ownerships(){return[...r.sessionWrapper.user.organizations.map(e=>({value:e.id,label:e.name}))]}get moduleOwner(){if(this.model.owner)return{value:this.model.owner.id,label:this.model.owner.name}}#selected;get defaultValues(){return{audience:"",duration:45,objective:"",totalActivities:5,language:this.#model.language}}get values(){return this.#saved?this.model.getProperties():this.defaultValues}#texts=new i.CurrentTexts(s.module.specifier);get texts(){return this.#texts?.value}get ready(){return super.ready&&this.#texts.ready}#objectivesGenerated=new Map;constructor(){super(),this.reactiveProps(["fetchingDraft"]),this.#texts.on("change",this.listenTexts)}listenTexts=()=>{this.triggerEvent("change"),this.#texts.ready&&(o.LayoutBroker.breadcrumb=[[this.texts.breadcrumb.modules,"/modules/list"],[this.texts.breadcrumb.management,""]])};hide(){this.#model=void 0,super.ready=!1,this.triggerEvent(),o.LayoutBroker.clear()}clearImprovements(){this.#improvements=void 0,this.triggerEvent("change")}async load(e,t){try{var a;e&&this.#model?.id===e||(a={type:"draft",id:e},this.#model=await n.LearningModule.get(a),this.#model.on("change",this.triggerEvent),this.#saved=!!e,o.LayoutBroker.addModel(this.#model,!0),o.LayoutBroker.canConsumeCredits=this.#saved,super.ready=!0,this.triggerEvent())}catch(e){console.error(e)}}listener(){}async save(e){return this.fetching=!0,await this.model.saveDraft(e),this.fetching=!1,this.triggerEvent(),this.#saved=!0,o.LayoutBroker.canConsumeCredits=!0,this.#model}setBreadcrumb(e){o.LayoutBroker.breadcrumb=e}async clean(){this.#model.activities.clean(),this.#saved=void 0,this.trigger("change")}async getObjectiveImprovements({objective:e}){try{this.#currentProcess="objective",this.fetching=!1;var t=await this.model.getObjectiveImprovements({objective:e});this.#improvements=t,this.triggerEvent("change")}catch(e){console.error(e)}finally{this.#currentProcess=void 0,this.fetching=!1}}async generateObjective({objective:e,improvements:t}){try{var a;return this.#currentProcess="changingObjective",this.fetching=!0,this.#objectivesGenerated.has(t)?this.#objectivesGenerated.get(t):(a=await this.model.generateObjective({objective:e,improvements:t}),this.#objectivesGenerated.set(e,a.objective),this.model.save,this.#model.objective=a.objective,this.#improvements=void 0,this.#improvementsSelected=new Set,this.triggerEvent("change"),this.#model.objective)}catch(e){console.error(e)}finally{this.#currentProcess=void 0,this.fetching=!1}}async generateModuleSuggestion(e){try{return this.#currentProcess="generatingDraft",this.fetchingDraft=!0,await this.model.getModuleSuggestion({...e,test:!0})}catch(e){console.error(e)}finally{this.#currentProcess=void 0,this.fetchingDraft=!1}}}t.StoreManager=l}}),k.set("./use-texts-callback",{hash:4103720571,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.useTextsCallback=function(a,n){const[e,r]=s.useState(!1),[t,o]=s.useState({}),i=(s.useEffect(()=>{const t=new l.CurrentTexts(a),e=()=>{var e=t.value;o(e),r(t.ready),t.ready&&n(e)};return t.on("change",e),e(),()=>{t.on("change",e)}},[]),e&&!!t);return[i,t]};var s=e("react"),l=e("@beyond-js/kernel/texts")}}),k.set("./views/coins/alert",{hash:100216912,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CoinsAlert=function({show:e,onClose:t,texts:a}){return e?(a=a.coins.alert,n.default.createElement(r.AlertModal,{show:!0,buttonLabel:a.action,onConfirm:t,onClose:t},n.default.createElement("header",null,n.default.createElement("h3",null,a.title),n.default.createElement(o.Battery,{percent:"100",className:"lg"}),n.default.createElement("p",null,a.description)))):null};var n=e("react"),r=e("pragmate-ui/modal"),o=e("@aimpact/ailearn-app/components/ui")}}),k.set("./views/coins/coins-modal",{hash:2894868445,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CoinsModal=function({store:e,show:t,onClose:a,texts:n}){if(!t)return null;const[,r]=s.default.useState(!1),[o,i]=s.default.useState();return n=n.coins.modal,s.default.createElement(l.ConfirmModal,{show:!0,className:"modal-sm",actions:{confirm:{label:n.actions.confirm,variant:"primary"},cancel:{label:n.actions.cancel,variant:"primary",bordered:!0}},onConfirm:async()=>{try{r(!0),await e.model.getCredits(),a()}catch(e){i(n.errors.noCredits)}finally{r(!1)}},onCancel:a,onClose:a},s.default.createElement("header",null,s.default.createElement("h3",null,n.title),s.default.createElement(c.ErrorRenderer,{error:o}),s.default.createElement(c.Battery,{percent:"100",className:"lg"}),s.default.createElement("p",null,n.description)))};var s=e("react"),l=e("pragmate-ui/modal"),c=e("@aimpact/ailearn-app/components/ui")}}),k.set("./views/components/ai-button",{hash:3389913736,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AIButton=function({children:e,onClick:t,...a}){return n.default.createElement(o.Button,{...a,icon:r.ICONS.aiStars,onClick:()=>s.LayoutBroker.ensureCredits(t)},e)},t.AIIconButton=function({children:e,onClick:t,...a}){return n.default.createElement(i.IconButton,{...a,icon:r.ICONS.aiStars,onClick:()=>s.LayoutBroker.ensureCredits(t)},e)};var n=e("react"),r=e("@aimpact/ailearn-app/components/icons"),o=e("pragmate-ui/components"),i=e("pragmate-ui/icons"),s=e("@aimpact/ailearn-app/coins-layout.widget")}}),k.set("./views/components/error",{hash:3301282445,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorRenderer=function({texts:e,error:t}){return a.default.createElement(n.Alert,{variant:"error"},e[t])};var a=e("react"),n=e("pragmate-ui/alert")}}),k.set("./views/components/footer",{hash:836744112,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.StepsFooter=function({submitLabel:e="next",onSubmit:t,disabled:a=!1,previous:n=!0}){const{texts:r,setCurrent:o,current:i}=(0,u.useModuleContext)(),s=r.actions[e];return l.default.createElement("footer",null,n&&l.default.createElement(c.Button,{className:"wizard-input",variant:"primary",bordered:!0,onClick:()=>o(i-1)},r.actions.back),l.default.createElement(c.Button,{className:"wizard-input",type:"submit",variant:"primary",onClick:t,disabled:a,sizing:"lg"},s))};var l=e("react"),c=e("pragmate-ui/components"),u=e("../context")}}),k.set("./views/components/html-render",{hash:3362016598,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.HtmlRender=function({children:e,tag:t="span"}){return a.default.createElement(t,{dangerouslySetInnerHTML:{__html:e}})};var a=e("react")}}),k.set("./views/components/options",{hash:369455942,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getOptions=function(e){return{audience:[[e.audience.school,e.audience.school],[e.audience.university,e.audience.university],[e.audience.company,e.audience.company]],duration:[["15",e.duration.brief],["45",e.duration.standard],["60",e.duration.extended]],language:[["en",e.languages.en],["es",e.languages.es],["pt",e.languages.pt],["fr",e.languages.fr],["de",e.languages.de]]}}}}),k.set("./views/components/radio-button",{hash:54679154,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.RadioButton=function({name:n,onChange:r,label:e,selected:t=0}){const{texts:a,store:o}=(0,d.useModuleContext)(),i={disabled:o.fetching||o.model.fetching},s=(0,m.getOptions)(a),l=s[n].map(([e,t],a)=>c.default.createElement(u.Button,{name:n,...i,"data-index":a,onClick:r,key:a,value:e},t));return c.default.createElement("div",{className:"radio-button__container"},c.default.createElement("label",{htmlFor:n},e),c.default.createElement(u.ButtonGroup,{selected:t,...i},l))};var c=e("react"),u=e("pragmate-ui/components"),d=e("../context"),m=e("./options")}}),k.set("./views/context",{hash:491328270,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.useSuggestionsContext=t.useModuleContext=t.useDraftManagementContext=t.SuggestionsContext=t.ModuleContext=t.DraftManagementContext=void 0;var a=e("react");const n=t.ModuleContext=a.default.createContext({}),r=(t.useModuleContext=()=>a.default.useContext(n),t.DraftManagementContext=a.default.createContext({})),o=(t.useDraftManagementContext=()=>a.default.useContext(r),t.SuggestionsContext=a.default.createContext({}));t.useSuggestionsContext=()=>a.default.useContext(o)}}),k.set("./views/form/animated-div",{hash:2099872162,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AnimatedDiv=function({children:e}={children:null,cls:""}){return a.default.createElement(n.motion.div,{className:"wizard__container",initial:{opacity:0},animate:{opacity:1,transition:{duration:.3,delay:.3},y:0},exit:{transition:{duration:.3},opacity:0}},e)};var a=e("react"),n=e("framer-motion")}}),k.set("./views/form/container",{hash:858841082,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DraftContainer=function({store:e}){const[t,a]=(0,x.useTexts)(E.module.specifier),[n,r]=h.useState(e.fetching),[o]=h.useState(0),[,i]=h.useState({}),[s,l]=h.useState(0),[c,u]=h.useState(e.values),[d,m]=h.useState(),[f,v]=h.useState(!1),g=(0,w.useDraftManagementContext)().ensureCredits;var p;return(0,b.useBinder)([e],()=>{i({}),r(e?.model?.fetching)}),t&&e.ready?(p={store:e,onChange:e=>{u({...c,[e.currentTarget.name]:e.currentTarget.value})},texts:a,activePanel:o,current:s,setCurrent:l,error:d,ensureCredits:g,setError:m,fetching:n||f,setIsFetching:v,saved:e.saved,values:c,setValues:u},h.createElement(h.Fragment,null,h.createElement(w.ModuleContext.Provider,{value:p},h.createElement(y.PageContainer,{className:" "+(n?"is-fetching":""),fetching:n&&!!e.model?.activities.length},h.createElement(C.DraftForm,null))))):null};var h=e("react"),b=e("@beyond-js/react-18-widgets/hooks"),y=e("@aimpact/ailearn-app/components/ui"),w=e("../context"),x=e("@aimpact/chat/shared/hooks"),E=e("beyond_context"),C=e("./")}}),k.set("./views/form/fields/grade",{hash:3857354124,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.GradeField=function(){const{texts:t,store:e,texts:{wizard:a}}=(0,u.useModuleContext)(),{setValues:n,values:r}=(0,u.useModuleContext)();let o={value:"",label:a.grades.select};var i=Object.keys(t.grades).map(e=>(o=e===r.audience?{value:e,label:t.grades[e]}:o,{value:e,label:t.grades[e]})),s={isDisabled:e.saved};return l.default.createElement("div",null,l.default.createElement("label",{htmlFor:""},a.grades.label),l.default.createElement(c.ReactSelect,{name:"audience",placeholder:a.grades.select,options:i,onChange:t=>n(e=>({...e,audience:t.target.value})),...s}))};var l=e("react"),c=e("pragmate-ui/form/react-select"),u=e("../../context")}}),k.set("./views/form/fields/language",{hash:630405900,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.LanguageField=function(){const{texts:t,store:e,texts:{},setValues:a}=(0,s.useModuleContext)(),n=["en","es"].map(e=>({value:e,label:t.languages[e]})),r={isDisabled:e.saved};return o.default.createElement("div",null,o.default.createElement("label",{htmlFor:""},t.languages.select.label),o.default.createElement(i.ReactSelect,{placeholder:t.languages.select.placeholder,value:e.model.language,name:"audience",options:n,onChange:t=>a(e=>({...e,language:t.target.value})),...r}))};var o=e("react"),i=e("pragmate-ui/form/react-select"),s=e("../../context")}}),k.set("./views/form/fields/module-length",{hash:1770237194,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DurationField=function(){const{store:e,texts:t,values:a,setValues:n}=(0,l.useModuleContext)(),r={isDisabled:e.saved},o=[{value:15,label:t.duration.brief,totalActivities:3},{value:45,label:t.duration.standard,totalActivities:5},{value:60,label:t.duration.extended,totalActivities:7}];return a?.audienceIndex&&parseInt(a.duration),a?.duration?.index&&parseInt(a.duration.index),a.duration&&o.find(e=>e.value===a.duration),i.default.createElement("div",null,i.default.createElement("label",{htmlFor:""},t.wizard.duration.label),i.default.createElement(s.ReactSelect,{placeholder:t.wizard.duration.placeholder,onChange:t=>{const a=o.find(e=>e.value===parseInt(t.target.value));n(e=>({...e,duration:t.target.value,totalActivities:a.totalActivities}))},name:"duration",value:a.duration,...r,options:o}))};var i=e("react"),s=e("pragmate-ui/form/react-select"),l=e("../../context")}}),k.set("./views/form/fields/objective",{hash:1366466996,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectiveField=function({submitted:e}){var{values:t,texts:{wizard:{messages:a,objective:n}},onChange:r}=(0,s.useModuleContext)();return o.default.createElement("div",{className:"objective-field"},o.default.createElement(i.Textarea,{onChange:r,value:t.objective,name:"objective",placeholder:n.textArea,counter:!0,maxLength:500}),e&&o.default.createElement(l.motion.div,{className:"success-text",initial:{opacity:0},animate:{opacity:1,transition:{duration:.3}}},a.save," ",o.default.createElement(c.Icon,{icon:"check"})))};var o=e("react"),i=e("pragmate-ui/form"),s=e("../../context"),l=e("framer-motion"),c=e("pragmate-ui/icons")}}),k.set("./views/form/fields/ownership",{hash:1198927874,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.OwnershipField=function(){const{texts:{wizard:e},store:{},store:n}=(0,s.useModuleContext)(),r=(0,s.useModuleContext)().setValues;e.schools.select,n.model.owner&&(n.model.owner.id,n.model.owner.name);var t=n.model.owner?.id,a={isDisabled:0===n.ownerships.length||n.saved};return o.default.createElement("div",null,o.default.createElement("label",{htmlFor:""},e.schools.label),o.default.createElement(i.ReactSelect,{value:t,placeholder:e.schools.select,name:"owner",options:n.ownerships,onChange:t=>{const a=n.user.organizations.find(e=>e.id===t.target.value);r(e=>({...e,owner:a}))},...a}))};var o=e("react"),i=e("pragmate-ui/form/react-select"),s=e("../../context")}}),k.set("./views/form/index",{hash:1290993653,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DraftForm=function(){const{values:t,error:e,setValues:a,store:n,texts:r,saved:o,fetching:i}=(0,p.useModuleContext)(),[s,l]=v.default.useState(!1),[c,u]=v.default.useState(!1),d=!(t.owner&&t.audience&&t.duration&&t.objective&&t.language),m=n.model.state&&o?r.actions.continue:r.actions.save,f=r.hasOwnProperty(n.currentProcess)?r[n.currentProcess]:r.objectiveSuggestions;return v.default.createElement("form",{className:"form-create-draft__container"},v.default.createElement(_.ErrorRenderer,{error:e,texts:r}),v.default.createElement(g.AnimatedDiv,null,v.default.createElement("section",{className:"form-body"},v.default.createElement("header",{className:"wizard-form-header"},v.default.createElement("h1",null,r.wizard.introduction.title),v.default.createElement("span",null,r.wizard.introduction.subtitle)),v.default.createElement("section",{className:"wizard-first-step-container"},v.default.createElement(S.LanguageField,null),v.default.createElement(w.OwnershipField,null),v.default.createElement(b.GradeField,null),v.default.createElement(y.DurationField,null)),v.default.createElement("div",{className:"form-wizard__objective-section"},v.default.createElement(x.ObjectiveField,{submitted:c}))),v.default.createElement(j.ObjectiveSuggestions,null),v.default.createElement("footer",null,v.default.createElement(C.Button,{className:"wizard-input",type:"submit",block:!0,disabled:d,variant:"primary",onClick:async()=>{try{(o&&"created"===n.model.state?l:(await n.save({...t,state:"created"}),E.routing.replaceState({},void 0,"/modules/management?id="+n.model.id),u))(!0)}catch(e){console.error(e)}}},m))),v.default.createElement(h.ProcessContainer,{fetching:i},v.default.createElement(h.RotatingMessage,{time:"8000",content:f})),v.default.createElement(M.ModalActivitiesGeneration,{show:s,onClose:()=>l(!1),onSave:async()=>{var e={...t,state:"confirmed"};a({...e}),await n.save({...e})}}))};var v=e("react"),g=e("./animated-div"),p=e("../context"),h=e("@aimpact/ailearn-app/components/ui"),b=e("./fields/grade"),y=e("./fields/module-length"),w=e("./fields/ownership"),x=e("./fields/objective"),E=e("@beyond-js/kernel/routing"),C=e("pragmate-ui/components"),j=e("./suggestions"),_=e("../components/error"),M=e("../modal-activities"),S=e("./fields/language")}}),k.set("./views/form/suggestions/action",{hash:3089290480,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestionsAction=function({}){const{texts:{actions:e,...t},store:a,values:n,saved:r}=(0,i.useModuleContext)();return o.default.createElement(o.default.Fragment,null,a?.improvements?.irrelevant&&o.default.createElement(s.Alert,{className:"mb-30",type:"warning"},t.suggestions.irrelevant),o.default.createElement("div",{className:"flex-container flex-center flex-05"},o.default.createElement(l.AIButton,{disabled:!r,onClick:async()=>{try{await a.getObjectiveImprovements({objective:n.objective})}catch(e){console.error(e)}},variant:"primary",bordered:!0},e.analyse)))};var o=e("react"),i=e("../../context"),s=e("pragmate-ui/alert"),l=e("../../components/ai-button")}}),k.set("./views/form/suggestions/index",{hash:3766540706,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectiveSuggestions=function(){var e=(0,r.useModuleContext)().store,[t,a]=n.default.useState(!1);return!e.improvements||e.improvements.irrelevant?n.default.createElement(i.SuggestionsAction,null):n.default.createElement(r.SuggestionsContext.Provider,{value:{improvedObjective:t,setImprovedObjective:a}},n.default.createElement(o.ObjectiveImproved,null),n.default.createElement(s.SuggestionsList,{block:!t}))};var n=e("react"),r=e("../../context"),o=e("./objective"),i=e("./action"),s=e("./list")}}),k.set("./views/form/suggestions/list/index",{hash:1853802744,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestionsList=function({block:e}){const{texts:{suggestions:t,actions:a},store:n,values:r,setValues:o}=(0,f.useModuleContext)(),[i,s]=u.default.useState(new Set);var l,c;return n.improvements?(l=n.improvements.suggestions,c={disabled:!i.size||e},u.default.createElement("section",{className:"objective-suggestions__container"+(e?" is-disabled":"")},u.default.createElement(m.List,{className:"objective-suggestions__list",specs:{selected:i,setSelected:s,block:e},control:v.ObjectiveSuggestionsItem,items:l}),u.default.createElement("div",{className:"section__actions"},u.default.createElement("span",null,t.total,": ",i.size),u.default.createElement("div",{className:"section__actions"},u.default.createElement(d.Button,{...c,onClick:()=>{s(new Set),n.clearImprovements()},variant:"primary",bordered:!0},a.removeSuggestions),u.default.createElement(d.Button,{...c,variant:"primary",onClick:async e=>{var t={objective:r.objective,improvements:Array.from(i).map(e=>n.improvements.suggestions[e].suggestion)};await n.generateObjective(t),o(e=>({...e,objective:n.model.objective}))}},a.applySuggestions))))):null};var u=e("react"),d=e("pragmate-ui/components"),m=e("pragmate-ui/list"),f=e("../../../context"),v=e("./item")}}),k.set("./views/form/suggestions/list/item",{hash:4075705557,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectiveSuggestionsItem=function({index:e,item:t,specs:{block:a,selected:n,setSelected:r}}){const{store:o,texts:{suggestions:i}}=(0,u.useModuleContext)(),s="suggestion__item"+(n.has(e)?" selected":""),l={className:s,"data-index":e,onClick:void 0};return a||(l.onClick=e=>{e.stopPropagation();var e=parseInt(e.currentTarget.dataset.index),t=n;t.has(e)?t.delete(e):t.add(e),o.improvementsSelected.add(e),r(new Set(t))}),c.default.createElement("div",{className:s,"data-index":e,...l},c.default.createElement("header",null,c.default.createElement("span",{className:"suggestion-label"},i.origin),c.default.createElement("span",{className:"suggestion-reference"},t.reference)),c.default.createElement("div",{className:"item__content"},c.default.createElement("header",null,c.default.createElement("span",{className:"suggestion-label"},i.label)),t.suggestion))};var c=e("react"),u=e("../../../context")}}),k.set("./views/form/suggestions/objective",{hash:801427851,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectiveImproved=function(){const{texts:{suggestions:{objective:{actions:e}}},store:t,setValues:a,values:n,store:{improvements:r}}=(0,u.useModuleContext)(),{improvedObjective:o,setImprovedObjective:i}=(0,u.useSuggestionsContext)(),s=r.improved;var l;return!r||o?null:(l=async e=>{"true"===e.currentTarget.value&&(await t.save({objective:s}),a({...n,objective:s})),i(!0)},c.default.createElement("div",{className:"objective-suggestion"},c.default.createElement("h3",null,s),c.default.createElement("div",{className:"objective-suggestion__actions"},c.default.createElement("span",{className:"primary-text"},e.label),c.default.createElement("div",{className:"section__actions"},c.default.createElement(d.Button,{variant:"primary",bordered:!0,value:"false",onClick:l},e.cancel),c.default.createElement(d.Button,{variant:"primary",value:"true",onClick:l},e.confirm)))))};var c=e("react"),u=e("../../context"),d=e("pragmate-ui/components")}}),k.set("./views/header/animated-label",{hash:2096490113,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AnimatedLabel=function({children:e}){const[t,a]=n.default.useState(!!e);return n.default.useEffect(()=>{a(e),globalThis.setTimeout(()=>{a(!1)},2e3)},[e]),n.default.createElement(r.AnimatePresence,null,t&&n.default.createElement(r.motion.span,{layout:!0,initial:{opacity:0,width:"0"},animate:{opacity:1,transition:{duration:.3},width:"auto"},exit:{transition:{duration:.3,width:0},opacity:0}},e))};var n=e("react"),r=e("framer-motion")}}),k.set("./views/header/animated",{hash:796986304,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Animated=function({className:e,children:t,as:a="span"}){return a=(0,r.motion)(a),n.default.createElement(a,{layout:!0,className:e,initial:{opacity:0},animate:{opacity:1,transition:{duration:.3}},exit:{transition:{duration:.3,width:0},opacity:0}},t)};var n=e("react"),r=e("framer-motion")}}),k.set("./views/header/index",{hash:446722148,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Header=function(){var{store:e,texts:t}=(0,r.useDraftManagementContext)();return e.saved&&e.hasCredits,n.default.createElement("section",null,n.default.createElement(a.NavbarHeader,{breadcrumb:[[t.breadcrumb.modules,"/modules/list"],[t.breadcrumb.management,""]]}))};var a=e("@aimpact/ailearn-app/components/navbar-header.code"),n=e("react"),r=e("../context")}}),k.set("./views/index",{hash:1371185060,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.View=function(e){const t=e.store,[,a]=s.useState(t.fetching),[,n]=s.useState({}),r=t.texts;var o,i;return(0,l.useBinder)([t],()=>{n({}),a(t?.model?.fetching)}),t.ready?(o="confirmed"===t.model.state?u.ActivitiesManagement:c.DraftContainer,i={texts:r,store:t,ensureCredits:d.LayoutBroker.ensureCredits},s.createElement(s.Fragment,null,s.createElement(m.DraftManagementContext.Provider,{value:i},s.createElement(o,{store:t,uri:e.uri})))):null};var s=e("react"),l=e("@beyond-js/react-18-widgets/hooks"),c=e("./form/container"),u=e("../management"),d=e("@aimpact/ailearn-app/coins-layout.widget"),m=e("./context")}}),k.set("./views/modal-activities",{hash:3699130228,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ModalActivitiesGeneration=function({show:e,onClose:t,onSave:a}){const{texts:n,store:r,values:o,ensureCredits:i}=(0,g.useModuleContext)(),[s,l]=u.default.useState(!1);if(!e)return null;const c=async()=>{try{l(!0),await r.generateModuleSuggestion({...o}),a()}catch(e){console.error(e)}finally{l(!1)}};return u.default.createElement(d.Modal,{show:!0,onClose:t},u.default.createElement("div",{className:"modal__header"},u.default.createElement("h3",null,n.wizard.modalSuggestions.title),u.default.createElement("div",{className:"mt-30"},u.default.createElement("span",null,n.wizard.modalSuggestions.description)),u.default.createElement("footer",{className:"actions mt-30 flex-container flex-center"},u.default.createElement(m.Button,{variant:"primary",bordered:!0,onClick:a},n.wizard.modalSuggestions.buttons.manual),u.default.createElement(v.AIButton,{variant:"primary",onClick:()=>i(c)},n.wizard.modalSuggestions.buttons.generate))),u.default.createElement(f.ProcessContainer,{fetching:s},u.default.createElement(f.RotatingMessage,{time:"8000",content:n.wizard.generatingModule})))};var u=e("react"),d=e("pragmate-ui/modal"),m=e("pragmate-ui/components"),f=e("@aimpact/ailearn-app/components/ui"),v=e("./components/ai-button"),g=e("./context")}}),S.exports.descriptor=[{im:"./controller",from:"Controller",name:"Controller"},{im:"./views/components/ai-button",from:"AIButton",name:"AIButton"},{im:"./views/components/ai-button",from:"AIIconButton",name:"AIIconButton"},{im:"./views/form/container",from:"DraftContainer",name:"DraftContainer"},{im:"./views/header/index",from:"Header",name:"Header"},{im:"./views/index",from:"View",name:"View"}],S.exports.process=function({require:e,prop:t,value:a}){!e&&"Controller"!==t||n("Controller",e?e("./controller").Controller:a),!e&&"AIButton"!==t||n("AIButton",e?e("./views/components/ai-button").AIButton:a),!e&&"AIIconButton"!==t||n("AIIconButton",e?e("./views/components/ai-button").AIIconButton:a),!e&&"DraftContainer"!==t||n("DraftContainer",e?e("./views/form/container").DraftContainer:a),!e&&"Header"!==t||n("Header",e?e("./views/header/index").Header:a),!e&&"View"!==t||n("View",e?e("./views/index").View:a)},n("__beyond_pkg",S),n("hmr",new function(){this.on=(e,t)=>S.hmr.on(e,t),this.off=(e,t)=>S.hmr.off(e,t)}),S.initialise(k)}}});