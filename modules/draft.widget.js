System.register(["@beyond-js/widgets@1.1.0/render","@beyond-js/kernel@0.1.9/bundle","@beyond-js/kernel@0.1.9/styles","@beyond-js/react-18-widgets@1.1.2/page","@aimpact/ailearn-app@0.1.13/main-layout.widget","@beyond-js/widgets@1.1.0/controller","@aimpact/ailearn-sdk@1.0.0/reactive/model","@aimpact/chat-sdk@1.3.0/session","@beyond-js/kernel@0.1.9/texts","@aimpact/ailearn-sdk@1.0.0/entities/learning-modules","@aimpact/ailearn-app@0.1.13/widgets/breadcrumb.widget","@aimpact/ailearn-app@0.1.13/i18n.ts","@beyond-js/kernel@0.1.9/routing","react@18.2.0","pragmate-ui@1.0.0-beta.6/modal","@aimpact/ailearn-app@0.1.13/components/ui","pragmate-ui@1.0.0-beta.6/alert","@beyond-js/react-18-widgets@1.1.2/hooks","framer-motion@10.18.0","pragmate-ui@1.0.0-beta.6/components","pragmate-ui@1.0.0-beta.6/form/react-select","pragmate-ui@1.0.0-beta.6/form","pragmate-ui@1.0.0-beta.6/base","pragmate-ui@1.0.0-beta.6/image","@aimpact/ailearn-app@0.1.13/components/icons","pragmate-ui@1.0.0-beta.6/icons","pragmate-ui@1.0.0-beta.6/list","@aimpact/ailearn-app@0.1.13/modules/management/overview.code","@aimpact/ailearn-app@0.1.13/modules/management/activity.code"],function(n,e){var t,a,r,i,o,s,l,c,u,d,m,f,p,v,g,h,b,y,w,x,E,C,j,_,S,M,P,O,k,N,T;return n({Controller:void 0,ConfirmationModal:void 0,SupportingText:void 0,OwnerImage:void 0,View:void 0}),{setters:[function(e){t=e},function(e){a=e},function(e){r=e},function(e){i=e},function(e){o=e},function(e){s=e},function(e){l=e},function(e){c=e},function(e){u=e},function(e){d=e},function(e){m=e},function(e){f=e},function(e){p=e},function(e){v=e},function(e){g=e},function(e){h=e},function(e){b=e},function(e){y=e},function(e){w=e},function(e){x=e},function(e){E=e},function(e){C=e},function(e){j=e},function(e){_=e},function(e){S=e},function(e){M=e},function(e){P=e},function(e){O=e},function(e){k=e}],execute:function(){T=a.Bundle,(N=new T({module:{vspecifier:"@aimpact/ailearn-app@0.1.13/modules/draft",multibundle:!0},type:"widget"},e.meta.url).package()).dependencies.update([["@beyond-js/widgets/render",t],["@beyond-js/kernel/styles",r],["@beyond-js/react-18-widgets/page",i],["@aimpact/ailearn-app/main-layout.widget",o],["@beyond-js/widgets/controller",s],["@aimpact/ailearn-sdk/reactive/model",l],["@aimpact/chat-sdk/session",c],["@beyond-js/kernel/texts",u],["@aimpact/ailearn-sdk/entities/learning-modules",d],["@aimpact/ailearn-app/widgets/breadcrumb.widget",m],["@aimpact/ailearn-app/i18n.ts",f],["@beyond-js/kernel/routing",p],["react",v],["pragmate-ui/modal",g],["@aimpact/ailearn-app/components/ui",h],["pragmate-ui/alert",b],["@beyond-js/react-18-widgets/hooks",y],["framer-motion",w],["pragmate-ui/components",x],["pragmate-ui/form/react-select",E],["pragmate-ui/form",C],["pragmate-ui/base",j],["pragmate-ui/image",_],["@aimpact/ailearn-app/components/icons",S],["pragmate-ui/icons",M],["pragmate-ui/list",P],["@aimpact/ailearn-app/modules/management/overview.code",O],["@aimpact/ailearn-app/modules/management/activity.code",k]]),brequire("@beyond-js/widgets/render").widgets.register([{name:"app-module-objective-management",vspecifier:"@aimpact/ailearn-app@0.1.13/modules/draft.widget",is:"page",route:"/modules/management",layout:"main-layout"}]),brequire("@beyond-js/kernel/styles").styles.register("@aimpact/ailearn-app@0.1.13/modules/draft.widget"),(T=new Map).set("./controller",{hash:2145005337,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Controller=void 0;var a=e("@beyond-js/react-18-widgets/page"),n=e("./store"),r=e("./views");class i extends a.PageReactWidgetController{#store;createStore(){return this.#store=n.store,this.#store}get Widget(){return r.View}show(){this.#store.load(this.uri.qs.get("id"),this.uri.qs.get("activityId"))}hide(){this.#store.hide()}}t.Controller=i}}),T.set("./store",{hash:945857023,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.store=t.StoreManager=void 0;var a=e("@aimpact/ailearn-sdk/reactive/model"),n=e("@aimpact/chat-sdk/session"),r=e("@aimpact/ailearn-app/main-layout.widget"),i=e("@beyond-js/kernel/texts"),o=e("beyond_context"),s=e("@aimpact/ailearn-sdk/entities/learning-modules"),l=e("@aimpact/ailearn-app/widgets/breadcrumb.widget"),c=e("@aimpact/ailearn-app/i18n.ts");class u extends a.ReactiveModel{isStore=!0;#alert;get url(){return"/modules/management?id="+d.model.id}get alert(){return this.#alert}get globalTexts(){return c.globalTexts.texts}#saved=!1;get saved(){return this.#saved}#model;get model(){return this.#model}#improvements;get improvements(){return this.#improvements}get hasCredits(){return 0<this.#model.credits?.total}#improvementsSelected=new Set;get improvementsSelected(){return this.#improvementsSelected}get user(){return n.sessionWrapper.user}get breadcrumb(){return l.breadcrumbStore.breadcrumb}#currentProcess;get currentProcess(){return this.#currentProcess}#view="setup";get view(){return"activity"===this.#view?"activity":"confirmed"===this.#model?.state?"overview":"setup"}set view(e){this.#view!==e&&(this.#view=e,this.triggerEvent())}get ownerships(){var e=this.user.organizations.items;return[{value:this.user.id,label:this.user.displayName},...e.map(e=>({value:e.id,label:e.name}))]}get moduleOwner(){if(this.model.owner)return{value:this.model.owner.id,label:this.model.owner.name}}#activitySelected;get activitySelected(){return this.#activitySelected}get defaultValues(){return{audience:"",duration:45,objective:"",totalActivities:5,language:this.#model.language}}get values(){return this.#saved?this.model?.getProperties():this.defaultValues}#texts=new i.CurrentTexts(o.module.specifier);get texts(){return this.#texts?.value}get ready(){return super.ready&&this.#texts.ready&&c.globalTexts.ready}#objectivesGenerated=new Map;constructor(){super(),(globalThis.store=this).reactiveProps(["fetchingSuggestions"]),c.globalTexts.on("change",this.triggerEvent),this.#texts.on("change",this.listenTexts)}listenTexts=()=>{this.triggerEvent("change")};hide(){this.#model=void 0,super.ready=!1,this.#improvements=void 0,this.triggerEvent(),r.LayoutBroker.clear()}clearImprovements(){this.#improvements=void 0,this.triggerEvent("change")}editActivity(e){this.#activitySelected=e,this.view=e?"activity":null,this.triggerEvent()}async update(e){try{var t=(await this.#model.saveDraft({...e})).status;return this.view="setup",{status:t}}catch(e){console.error(e)}}async load(e,t){try{e&&this.#model?.id===e||(this.#model=new s.Draft({id:e}),e&&await this.#model.load(),t&&this.#model.activities.has(t)&&(this.#activitySelected=this.#model.activities.get(t),globalThis.activity=this.#activitySelected,this.view="activity"),this.#model.on("change",this.triggerEvent),this.#saved=!!e,r.LayoutBroker.addModel(this.#model,!0),r.LayoutBroker.canConsumeCredits=this.#saved,super.ready=!0,this.triggerEvent())}catch(e){console.error(e)}}listener(){}async save(e){return this.processing=!0,r.LayoutBroker.addModel(this.#model,!0),await this.model.saveDraft(e),this.processing=!1,this.#saved=!0,r.LayoutBroker.canConsumeCredits=!0,this.#model}async clean(){this.#model.activities.clean(),this.#saved=void 0,this.trigger("change")}async getObjectiveImprovements({objective:e}){try{this.#currentProcess="objective",this.fetchingSuggestions=!0;var t=await this.model.getObjectiveImprovements({objective:e});return this.#improvements=t,this.triggerEvent("change"),{status:!0,...t}}catch(e){console.error(e)}finally{this.#currentProcess=void 0,this.fetchingSuggestions=!1}}async generateObjective({objective:e,improvements:t}){try{this.#currentProcess="changingObjective",this.fetchingSuggestions=!0;var a=await this.model.generateObjective({objective:e,improvements:t});return this.#objectivesGenerated.set(e,a.objective),this.model.save,this.#model.objective=a.objective,this.#improvements=void 0,this.#improvementsSelected=new Set,this.triggerEvent("change"),this.#model.objective}catch(e){console.error(e)}finally{this.#currentProcess=void 0,this.fetchingSuggestions=!1}}async generateModuleSuggestion(e){return this.#currentProcess="generatingDraft",this.model.getModuleSuggestion({...e})}async getAdministrator(t){return this.user.id===t?this.user:this.user.organizations.items.find(e=>e.id===t)}setAlert({message:e,type:t,position:a="top"}){this.#alert={message:e,type:t,position:a},this.trigger("alert.changed")}clearAlert(){this.#alert=void 0,this.trigger("alert.changed")}}t.StoreManager=u;let d=t.store=new u}}),T.set("./trim",{hash:750512083,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.trimText=function(e,t){if(e.length<=t)return e;let a=e.slice(0,t);return e[t]&&!/\s|[.,!?]/.test(e[t])&&(t=(e=e.slice(t)).search(/\s|[.,!?]/),a+=-1!==t?e.slice(0,t):e),a+"..."}}}),T.set("./types",{hash:2782604694,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}}),T.set("./views/coins/alert",{hash:93663821,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CoinsAlert=function({show:e,onClose:t,texts:a}){var n;return e?({title:e,description:a,action:n}=a.coins.alert,r.default.createElement(i.AlertModal,{buttonLabel:n,onConfirm:t,onClose:t},r.default.createElement("header",null,r.default.createElement("h3",null,e),r.default.createElement(o.Battery,{percent:"100",className:"lg"}),r.default.createElement("p",null,a)))):null};var r=e("react"),i=e("pragmate-ui/modal"),o=e("@aimpact/ailearn-app/components/ui")}}),T.set("./views/coins/coins-modal",{hash:2894868445,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CoinsModal=function({store:e,show:t,onClose:a,texts:n}){if(!t)return null;let[,r]=s.default.useState(!1),[i,o]=s.default.useState();n=n.coins.modal;return s.default.createElement(l.ConfirmModal,{show:!0,className:"modal-sm",actions:{confirm:{label:n.actions.confirm,variant:"primary"},cancel:{label:n.actions.cancel,variant:"primary",bordered:!0}},onConfirm:async()=>{try{r(!0),await e.model.getCredits(),a()}catch(e){o(n.errors.noCredits)}finally{r(!1)}},onCancel:a,onClose:a},s.default.createElement("header",null,s.default.createElement("h3",null,n.title),s.default.createElement(c.ErrorRenderer,{error:i}),s.default.createElement(c.Battery,{percent:"100",className:"lg"}),s.default.createElement("p",null,n.description)))};var s=e("react"),l=e("pragmate-ui/modal"),c=e("@aimpact/ailearn-app/components/ui")}}),T.set("./views/components/alert",{hash:2743908413,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AlertRenderer=function({type:e="success",message:t,className:a,time:n=3e3,show:r=!0}){a="alert-message alert-message--"+e+(a?" "+a:"");let[i,o]=c.default.useState(!1),[,s]=c.default.useState(null),l=(0,u.useModuleContext)().store;return c.default.useEffect(()=>{if(r){let e=setTimeout(()=>{r&&o(!0),l.clearAlert()},n);return s(e),()=>clearTimeout(e)}s(void 0),o(void 0)},[t,r]),i||!r?null:c.default.createElement(d.motion.div,{initial:{opacity:0},animate:{opacity:1,transition:{duration:.3,delay:.3},y:0},exit:{transition:{duration:.3},opacity:0},className:a},t)},t.ErrorRenderer=function({texts:e,error:t}){return c.default.createElement(a.Alert,{variant:"error"},e[t])};var c=e("react"),a=e("pragmate-ui/alert"),u=e("../context"),d=e("framer-motion")}}),T.set("./views/components/radio-button",{hash:2984847910,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.RadioButton=function({name:n,onChange:r,label:e,selected:t=0}){let a=(0,c.useModuleContext)().store,i={disabled:a.fetching||a.model.fetching},o={audience:[],duration:[],language:[]}[n]?.map(([e,t],a)=>s.default.createElement(l.Button,{name:n,...i,"data-index":a,onClick:()=>r(e),key:a,value:e},t))||[];return s.default.createElement("div",{className:"radio-button__container"},s.default.createElement("label",{htmlFor:n},e),s.default.createElement(l.ButtonGroup,{selected:t,...i},o))};var s=e("react"),l=e("pragmate-ui/components"),c=e("../context")}}),T.set("./views/context",{hash:1919115792,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.useSuggestionsContext=t.useModuleContext=t.useDraftManagementContext=t.SuggestionsContext=t.ModuleContext=t.DraftManagementContext=void 0;var a=e("react");let n=t.ModuleContext=a.default.createContext({}),r=(t.useModuleContext=()=>a.default.useContext(n),t.DraftManagementContext=a.default.createContext({})),i=(t.useDraftManagementContext=()=>a.default.useContext(r),t.SuggestionsContext=a.default.createContext({}));t.useSuggestionsContext=()=>a.default.useContext(i)}}),T.set("./views/form/animated-div",{hash:2040524209,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AnimatedDiv=function({children:e}={children:null,cls:""}){return a.default.createElement(n.motion.div,{className:"objective__container",initial:{opacity:0},animate:{opacity:1,transition:{duration:.3,delay:.3},y:0},exit:{transition:{duration:.3},opacity:0}},e)};var a=e("react"),n=e("framer-motion")}}),T.set("./views/form/confirmation-modal",{hash:1642631284,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ConfirmationModal=function({store:e,values:t,show:a,onClose:n}){let r=t.owner,[i,o]=u.default.useState(!1);var s,l,c;return a?(a=async()=>{o(!0),await e.save({...t,state:"created"}),e.breadcrumb.lastItem.label=(0,p.trimText)(e.model.objective,15),v.routing.replaceState({},void 0,"/modules/management?id="+e.model.id),n(),e.setAlert({message:e.texts.setup.messages.save,position:"objective"}),o(!1)},l=e.globalTexts,s=e.texts.setup.confirmation,l=l.actions,c="user"===r.entity?r.displayName:r.name,u.default.createElement(d.Modal,{show:!0,className:"modal-sm modal-centered",onClose:n},u.default.createElement("div",null,u.default.createElement("header",null,u.default.createElement("h3",null,s.title),u.default.createElement("span",null,s.subtitle)),u.default.createElement("div",{className:"owner-container"},u.default.createElement(m.OwnerImage,{owner:r}),u.default.createElement("div",{className:"owner-info"},u.default.createElement("h6",null,c),u.default.createElement("span",null,s.ownerDescription))),u.default.createElement("div",{className:"primary-container text-center"},u.default.createElement("span",null,s.description)),u.default.createElement("section",{className:"actions__container"},u.default.createElement(f.Button,{variant:"primary",bordered:!0,onClick:n,disabled:i},l.cancel),u.default.createElement(f.Button,{variant:"primary",onClick:a,disabled:i},l.continue))))):null};var u=e("react"),d=e("pragmate-ui/modal"),m=e("./image"),f=e("pragmate-ui/components"),p=e("../../trim"),v=e("@beyond-js/kernel/routing")}}),T.set("./views/form/fields/audience",{hash:2222746801,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AudienceField=function({disabled:e}){let{texts:{audience:t},texts:{},store:a}=(0,u.useModuleContext)(),{setValues:n,values:r}=(0,u.useModuleContext)(),i={value:"",label:t.input.select},o=Object.keys(t.argentine).map(e=>(i=e===r.audience?{value:e,label:t.argentine[e]}:i,{value:e,label:t.argentine[e]})),s={isDisabled:a.saved||e};return l.default.createElement("div",null,l.default.createElement("label",{htmlFor:""},t.input.label),l.default.createElement(c.ReactSelect,{name:"audience",value:r.audience,placeholder:t.input.select,options:o,onChange:t=>n(e=>({...e,audience:t.target.value})),...s}))};var l=e("react"),c=e("pragmate-ui/form/react-select"),u=e("../../context")}}),T.set("./views/form/fields/language",{hash:3795966877,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.LanguageField=function({disabled:e}){let{texts:t,store:a,setValues:n}=(0,l.useModuleContext)(),r=["en","es"].map(e=>({value:e,label:t.languages[e]})),i={isDisabled:a.saved||e};return o.default.createElement("div",null,o.default.createElement("label",{htmlFor:""},t.languages.select.label),o.default.createElement(s.ReactSelect,{placeholder:t.languages.select.placeholder,value:a.model.language,name:"audience",options:r,onChange:t=>n(e=>({...e,language:t.target.value})),...i}))};var o=e("react"),s=e("pragmate-ui/form/react-select"),l=e("../../context")}}),T.set("./views/form/fields/objective",{hash:317254154,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectiveField=function(){var{values:e,texts:t,onChange:a,store:n}=(0,s.useModuleContext)(),r=t.setup.form;return i.default.createElement(i.default.Fragment,null,i.default.createElement("div",{className:"objective-field "},i.default.createElement(o.Textarea,{onChange:a,value:e.objective,name:"objective",placeholder:r.objective.textArea,counter:!0,maxLength:500}),i.default.createElement(l.AlertRenderer,{show:!!n.alert&&"objective"===n.alert.position,type:"success",className:"alert-message alert-message--success alert-fixed",message:t.setup.messages.save})))};var i=e("react"),o=e("pragmate-ui/form"),s=e("../../context"),l=e("../../components/alert")}}),T.set("./views/form/fields/ownership",{hash:1290580698,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.OwnershipField=function({disabled:e}={}){let{texts:{setup:{form:t}},texts:{objectiveTour:a},store:n}=(0,m.useModuleContext)(),{setValues:r,texts:i}=(0,m.useModuleContext)(),[,o]=u.default.useState(null),[s,l]=u.default.useState({content:"",variant:""});t.administrator.select,n.model.owner&&(n.model.owner.id,n.model.owner.name);var c=n.model.owner?.id,e={isDisabled:0===n.ownerships?.length||n.saved||e};return u.default.createElement(u.default.Fragment,null,u.default.createElement(f.TourStep,{texts:a,name:"administrator",as:"div",className:"administrator"},u.default.createElement("div",{className:"field-container"},u.default.createElement("label",{htmlFor:""},t.administrator.label),u.default.createElement(d.ReactSelect,{value:c,placeholder:t.administrator.select,name:"owner",options:n.ownerships,onChange:async e=>{l({content:"",variant:""});let t=await n.getAdministrator(e.target.value),a;"organization"===t.entity&&await t.getCredits(),o(t),void 0===t.coins?.modules?console.error("the user does not have coins data loaded, refresh the page and try again."):(e=t.coins.modules.count,a=i.alerts.coins,a=e?a.available:a.unavailable,e=e?"success":"error",l({content:a,variant:e}),r(e=>({...e,owner:t})))},...e}),u.default.createElement(p.SupportingText,{...s}))))};var u=e("react"),d=e("pragmate-ui/form/react-select"),m=e("../../context"),f=e("@aimpact/ailearn-app/components/ui"),p=e("./supporting-text")}}),T.set("./views/form/fields/supporting-text",{hash:3724854723,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SupportingText=function({content:e,variant:t="default",className:a="",...n}){return e?(t=(`pui-supporting-text ${t=i[t]||i.default} `+a).trim(),r.default.createElement("div",{className:t,...n},r.default.createElement("span",null,e))):null};var r=e("react");let i={primary:"text-primary",secondary:"text-secondary",tertiary:"text-tertiary",success:"text-success",info:"text-info",error:"text-error",warning:"text-warning",default:"text-default"}}}),T.set("./views/form/image",{hash:315420214,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.OwnerImage=function({owner:e}){return e?.photoUrl?a.default.createElement(n.Image,{src:e.photoUrl,className:"circle"}):a.default.createElement(r.AppIcon,{icon:"school",className:"pui-image"})};var a=e("react"),n=e("pragmate-ui/image"),r=e("@aimpact/ailearn-app/components/icons")}}),T.set("./views/form/index",{hash:2390474408,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DraftForm=function(){let{values:e,setValues:t,store:a,texts:n,saved:r,fetching:i,togglePathway:o,toggleConfirmation:s}=(0,b.useModuleContext)(),l=a.model.state&&r?a.globalTexts.actions.continue:a.globalTexts.actions.save,c=(0,y.useDriverTour)("moduleObjective",a.ready,n?.objectiveTour?.buttons).ref,[u,d]=g.useState(!1),m=!(e.owner&&e.audience&&e.objective&&e.language),f=m||u||a.processing,p=((0,O.useBinder)([a],()=>d(a.fetchingSuggestions),"fetchingSuggestions.changed"),`form-create-draft__container ${i?"fetching":""} `+(u?"is-processing":"")),v=u?"is-processing":"";return g.createElement(y.PageContainer,{className:p,fetching:i&&!!a.model?.activities.items.length},g.createElement("div",{ref:c,className:v},g.createElement(_.Form,{className:p,onSubmit:async()=>{try{u||(d(!0),await!(a.model.state===e.state&&a.model.objective===e.objective||(await t({...e,updated:!1}),"created"!==a.model.state&&(s(),d(!1)))),r&&"created"===a.model.state&&o())}catch(e){console.error(e)}finally{d(!1)}}},g.createElement(h.AnimatedDiv,null,g.createElement("section",{className:"form-body"},g.createElement("header",{className:"setup-form-header"},g.createElement("h1",null,n.setup.title)),g.createElement(M.AlertRenderer,{type:a.alert?.type,message:a.alert?.message,show:!!a.alert&&"top"===a.alert.position,className:"alert--small"}),g.createElement("section",{className:"wizard-first-step-container"},g.createElement(x.OwnershipField,{disabled:u}),g.createElement(y.TourStep,{texts:n.objectiveTour,name:"parameters",as:"div",className:"parameters-container"},g.createElement(C.LanguageField,{disabled:u}),g.createElement(w.AudienceField,{disabled:u}))),g.createElement(y.TourStep,{as:"section",texts:n.objectiveTour,name:"objective",className:"form-wizard__objective-section relative-container"},g.createElement(E.ObjectiveField,null))),g.createElement(S.ObjectiveSuggestions,{setProcessing:d,processing:u}),g.createElement("footer",null,g.createElement(P.SuggestionsAction,null),g.createElement(y.TourStep,{texts:n.objectiveTour,name:"save",className:"save-button__container"},g.createElement(j.Button,{type:"submit",block:!0,disabled:f,variant:"primary"},l)))),g.createElement(y.ProcessContainer,{fetching:i}))))};var g=e("react"),h=e("./animated-div"),b=e("../context"),y=e("@aimpact/ailearn-app/components/ui"),w=e("./fields/audience"),x=e("./fields/ownership"),E=e("./fields/objective"),C=e("./fields/language"),j=e("pragmate-ui/components"),_=e("pragmate-ui/form"),S=e("./suggestions"),M=e("../components/alert"),P=e("./suggestions/action"),O=e("@beyond-js/react-18-widgets/hooks")}}),T.set("./views/form/suggestions/action",{hash:1061487778,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestionsAction=function({}){let{store:{globalTexts:{actions:e}},store:t,values:a,saved:n}=(0,s.useModuleContext)(),[r,i]=o.default.useState(!1);return t.improvements?null:o.default.createElement(o.default.Fragment,null,o.default.createElement(l.AIButton,{disabled:!n,ensure:!1,onClick:async()=>{try{t.hasCredits?await t.getObjectiveImprovements({objective:a.objective}):i(!0)}catch(e){console.error(e)}},variant:"primary",bordered:!0},e.analyse),r&&o.default.createElement(l.CoinsModal,{owner:t.model?.owner,show:r,onClose:()=>i(!1),globalTexts:t.globalTexts,onConsume:async()=>{var e=await t.model.consumeCoins();return e.error||(e=await t.getObjectiveImprovements({objective:a.objective}),i(!1)),e}}))};var o=e("react"),s=e("../../context"),l=e("@aimpact/ailearn-app/components/ui")}}),T.set("./views/form/suggestions/index",{hash:3554607872,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectiveSuggestions=function({processing:e,setProcessing:t}){var a=(0,o.useModuleContext)().store,[n,r]=i.default.useState(!1);return!a.improvements||a.improvements.irrelevant?null:i.default.createElement(o.SuggestionsContext.Provider,{value:{improvedObjective:n,setImprovedObjective:r,processing:e,setProcessing:t}},i.default.createElement(s.ObjectiveImproved,null),i.default.createElement(l.SuggestionsList,{block:!n}))};var i=e("react"),o=e("../../context"),s=e("./objective"),l=e("./list")}}),T.set("./views/form/suggestions/list/index",{hash:3395067186,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestionsList=function({block:e}){let{texts:{suggestions:t},store:a,store:{globalTexts:{actions:n}},values:r,setValues:i}=(0,p.useModuleContext)(),o=(0,p.useSuggestionsContext)().setImprovedObjective,[s,l]=d.default.useState(new Set),c,u;return a.improvements?(c=a.improvements.suggestions,u={disabled:!s.size||e},d.default.createElement("section",{className:"objective-suggestions__container"+(e?" is-disabled":"")},d.default.createElement(f.List,{className:"objective-suggestions__list",specs:{selected:s,setSelected:l,block:e},control:v.ObjectiveSuggestionsItem,items:c}),d.default.createElement("div",{className:"section__actions"},d.default.createElement("span",null,t.total,": ",s.size),d.default.createElement("div",{className:"section__actions"},d.default.createElement(m.Button,{disabled:e,onClick:()=>{l(new Set),o(!1),a.clearImprovements()},variant:"primary",bordered:!0},n.removeSuggestions),d.default.createElement(m.Button,{...u,variant:"primary",onClick:async e=>{var t={objective:r.objective,improvements:Array.from(s).map(e=>a.improvements.suggestions[e].suggestion)};await a.generateObjective(t),o(!1),i(e=>({...e,objective:a.model.objective}))}},n.applySuggestions))))):null};var d=e("react"),m=e("pragmate-ui/components"),f=e("pragmate-ui/list"),p=e("../../../context"),v=e("./item")}}),T.set("./views/form/suggestions/list/item",{hash:2063911443,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectiveSuggestionsItem=function(e={}){let{index:t,item:a,block:n,selected:r,setSelected:i}=e,{store:o,texts:{suggestions:s}}=(0,d.useModuleContext)(),l="suggestion__item"+(r.has(t)?" selected":""),c={className:l,"data-index":t};return n||(c.onClick=e=>{e.stopPropagation();var e=parseInt(e.currentTarget.dataset.index),t=r;t.has(e)?t.delete(e):t.add(e),o.improvementsSelected.add(e),i(new Set(t))}),u.default.createElement("div",{className:l,"data-index":t,...c},u.default.createElement("header",null,u.default.createElement("span",{className:"suggestion-label"},s.origin),u.default.createElement("span",{className:"suggestion-reference"},a.reference)),u.default.createElement("div",{className:"item__content"},u.default.createElement("header",null,u.default.createElement("span",{className:"suggestion-label"},s.label)),a.suggestion))};var u=e("react"),d=e("../../../context")}}),T.set("./views/form/suggestions/objective",{hash:4225891460,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectiveImproved=function(){let{texts:{suggestions:{objective:{actions:e}}},store:t,setValues:a,values:n,store:{improvements:r}}=(0,m.useModuleContext)(),{improvedObjective:i,setImprovedObjective:o}=(0,m.useSuggestionsContext)(),s=r.improved,[l,c]=d.default.useState(!1),u;return!r||i?null:(u=async e=>{c(!0),"true"===e.currentTarget.value&&(await t.save({objective:s}),a({...n,objective:s})),o(!0),c(!1)},d.default.createElement("div",{className:"objective-suggestion "+(l?"is-processing":"")},d.default.createElement("h3",null,s),d.default.createElement("div",{className:"objective-suggestion__actions"},d.default.createElement("span",{className:"primary-text"},e.label),d.default.createElement("div",{className:"section__actions"},d.default.createElement(f.Button,{variant:"primary",bordered:!0,value:"false",onClick:u},e.cancel),d.default.createElement(f.Button,{variant:"primary",value:"true",onClick:u},e.confirm)))))};var d=e("react"),m=e("../../context"),f=e("pragmate-ui/components")}}),T.set("./views/global",{hash:4200118861,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}}),T.set("./views/index",{hash:497011968,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.View=function({store:e,uri:t}){let[a,n]=w.useState(e.fetching),[r,i]=w.useState(!1),[o]=w.useState(0),[s,l]=w.useState(0),[c,u]=w.useState({...e.model?.getProperties()}),[d,m]=w.useState(),[f,p]=w.useState(!1),[v,g]=w.useState(!1),h=()=>p(!f),b=()=>g(!v),y;return(0,x.useBinder)([e],()=>{u({...e.model?.getProperties()}),n(e?.fetching)}),e.ready?(y={store:e,onChange:e=>{u({...c,[e.currentTarget.name]:e.currentTarget.value,updated:!0})},texts:e.texts,activePanel:o,current:s,setCurrent:l,improvements:e.improvements,error:d,setError:m,fetching:a||r,setIsFetching:i,togglePathway:h,saved:e.saved,values:c,setValues:u,toggleConfirmation:b},w.createElement(w.Fragment,null,w.createElement(j.ModuleContext.Provider,{value:y},w.createElement(P.ConditionalContainer,{condition:e.view,options:{overview:w.createElement(E.ModuleOverview,{store:e,uri:t,fetching:a}),setup:w.createElement(_.DraftForm,null),activity:w.createElement(C.ModuleActivityForm,{store:e,activity:e.activitySelected})}})),w.createElement(S.ConfirmationModal,{store:e,values:c,show:v,onClose:b}),w.createElement(M.PathwayGeneration,{show:f,setValues:u,store:e,values:c,onClose:h}))):null};var w=e("react"),x=e("@beyond-js/react-18-widgets/hooks"),E=e("@aimpact/ailearn-app/modules/management/overview.code"),C=e("@aimpact/ailearn-app/modules/management/activity.code"),j=e("./context"),_=e("./form"),S=e("./form/confirmation-modal"),M=e("./pathway"),P=e("pragmate-ui/components")}}),T.set("./views/pathway/animations",{hash:3779295974,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.animations=void 0,t.animations={slideDown:{initial:{y:"-50%",opacity:0},animate:{y:0,opacity:1,transition:{duration:.3}},exit:{y:"50%",opacity:0,transition:{duration:.3}}},default:{initial:{opacity:0},animate:{y:0,opacity:1,transition:{duration:.3}},exit:{y:"50%",opacity:0,transition:{duration:.3}}},fadeInUpfadeOutLeft:{initial:{y:"-90%",opacity:0},animate:{y:0,opacity:1,transition:{duration:.3}},exit:{x:"50%",opacity:0,transition:{duration:.3}}}}}}),T.set("./views/pathway/confirmation",{hash:3901616995,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ConfirmationForm=function(){let{texts:e,setView:t,onClose:a,store:n}=(0,l.usePathwayContext)(),r=n.globalTexts;return i.default.createElement(s.motion.div,{...c.animations.default,className:"centered-container"},i.default.createElement("header",{className:"modal__header"},i.default.createElement("h3",null,e.refine.confirm.title)),i.default.createElement("div",{className:"description__content"},i.default.createElement("span",null,e.refine.confirm.description)),i.default.createElement("footer",{className:"actions mt-30 flex-container flex-center"},i.default.createElement(o.Button,{variant:"primary",bordered:!0,onClick:a},r.actions.cancel),i.default.createElement(o.Button,{variant:"primary",onClick:async()=>t("selection")},r.actions.confirm)))};var i=e("react"),o=e("pragmate-ui/components"),s=e("framer-motion"),l=e("./context"),c=e("./animations")}}),T.set("./views/pathway/context",{hash:4158332328,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.usePathwayContext=t.PathwayContext=void 0;var a=e("react");let n=t.PathwayContext=a.default.createContext({});t.usePathwayContext=()=>a.default.useContext(n)}}),T.set("./views/pathway/examples",{hash:739492676,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestionExamples=function(){let{texts:t,setView:a,setNotes:n}=(0,s.usePathwayContext)();return r.default.createElement(r.default.Fragment,null,r.default.createElement(l.motion.div,{...c.animations.default,className:"modal__content--justified"},r.default.createElement("h3",null,t.refine.examples.title),r.default.createElement(o.List,{className:"modal__list--options-selection",items:t.refine.examples.items,control:({item:e})=>r.default.createElement("li",{className:"list__item"},r.default.createElement("span",null,e),r.default.createElement("div",null,r.default.createElement(i.Button,{bordered:!0,variant:"primary",onClick:()=>{n(e),a("suggestions")}},t.refine.examples.actions.select)))}),r.default.createElement("div",{className:"flex-container flex-end mt-30"},r.default.createElement("div",{className:"modal__actions"},r.default.createElement(i.Button,{variant:"default",onClick:()=>a("selection")},t.refine.examples.actions.back)))))};var r=e("react"),i=e("pragmate-ui/components"),o=e("pragmate-ui/list"),s=e("./context"),l=e("framer-motion"),c=e("./animations")}}),T.set("./views/pathway/forms/ai-form",{hash:1870286655,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AIGenerationForm=function({}){let{store:e,texts:t,values:a,setView:n,notes:r,setNotes:i,onClose:o}=(0,v.usePathwayContext)(),[s,l]=u.default.useState(!1),c={onChange:e=>{i(e.currentTarget.value)},onClick:async()=>{try{l(!0),await e.generateModuleSuggestion({...e.model.getProperties(),notes:r}),o()}catch(e){console.error(e)}finally{l(!1)}},setView:()=>n("examples"),onBack:()=>n("selection")};return u.default.createElement(p.motion.div,{...h.animations.default,className:"modal__form"},u.default.createElement(d.Form,{onSubmit:c.onClick},u.default.createElement("header",null,u.default.createElement("h3",null,t.refine.activities.title)),u.default.createElement(g.TotalActivities,null),u.default.createElement(d.Textarea,{label:t.refine.textarea.label,name:"observations",value:r,floating:!0,onChange:c.onChange,placeholder:t.refine.textarea.placeholder})),u.default.createElement("footer",null,u.default.createElement(f.Button,{variant:"primary",bordered:!0,onClick:c.onBack},e.globalTexts.actions.back),u.default.createElement(f.Button,{variant:"primary",onClick:c.onClick,disabled:s||!a.duration},e.globalTexts.actions.generate)),u.default.createElement(m.ProcessContainer,{fetching:s}))};var u=e("react"),d=e("pragmate-ui/form"),m=e("@aimpact/ailearn-app/components/ui"),f=e("pragmate-ui/components"),p=e("framer-motion"),v=e("../context"),g=e("./total-activities"),h=e("../animations")}}),T.set("./views/pathway/forms/decision-type",{hash:3138892140,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DecistionType=function({}){let{texts:e,store:t,onClose:a}=(0,m.usePathwayContext)(),n=e.setup.generation,r=e.setup.actions,[i,o]=c.default.useState(),s=(0,m.usePathwayContext)().setView,l=e=>{e=e.currentTarget.value,o(e)};return c.default.createElement(u.motion.div,{...p.animations.default,className:"modal__form"},c.default.createElement("header",null,c.default.createElement("h3",null,n.title),c.default.createElement("div",{className:"description__content"},c.default.createElement("span",null,n.subtitle))),c.default.createElement(f.RadioButton,{checked:"yes"===i,onChange:l,label:n.options.ai,value:"yes",name:"generationWay"}),c.default.createElement(f.RadioButton,{checked:"manually"===i,onChange:l,label:n.options.manually,value:"manually",name:"generationWay"}),c.default.createElement("footer",null,c.default.createElement(d.Button,{variant:"primary",bordered:!0,onClick:a},r.cancel),c.default.createElement(d.Button,{variant:"primary",disabled:!i,onClick:()=>{"yes"!==i||t.model.credits.total?s("yes"===i?"ai":"manual"):s("request")}},r.continue)))};var c=e("react"),u=e("framer-motion"),d=e("pragmate-ui/components"),m=e("../context"),f=e("@aimpact/ailearn-app/components/ui"),p=e("../animations")}}),T.set("./views/pathway/forms/manual",{hash:143054715,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ManualForm=function({}){let{texts:e,store:t,values:a,setValues:n}=(0,v.usePathwayContext)(),r=e.setup.generation,i=t.globalTexts.actions,{setView:o,onClose:s}=(0,v.usePathwayContext)(),[,l]=f.default.useState(!1),[c,u]=f.default.useState({title:"",description:""});e=e.pathway;var d=async()=>{try{l(!0),await t.save({...a,title:c.title,description:c.description,state:"confirmed"}),s(),n({...a,title:c.title,description:c.description})}catch(e){console.error(e)}finally{l(!1)}},m=e=>{var{value:e,name:t}=e.currentTarget;u({...c,[t]:e})};return f.default.createElement(h.motion.div,{...b.animations.default,className:"modal__form"},f.default.createElement("header",null,f.default.createElement("h3",null,r.title),f.default.createElement("div",{className:"description__content"},f.default.createElement("span",null,r.subtitle))),f.default.createElement(g.Form,{onSubmit:d},f.default.createElement(g.Input,{label:e.manual.title.label,onChange:m,value:c.title??"",name:"title"}),f.default.createElement(g.Textarea,{label:e.manual.description.label,name:"description",variant:"floating",onChange:m,value:c.description??""}),f.default.createElement("footer",null,f.default.createElement(p.Button,{variant:"primary",bordered:!0,onClick:()=>o("selection")},i.back),f.default.createElement(p.Button,{variant:"primary",disabled:!c.description||!c.title,onClick:d},i.continue))))};var f=e("react"),p=e("pragmate-ui/components"),v=e("../context"),g=e("pragmate-ui/form"),h=e("framer-motion"),b=e("../animations")}}),T.set("./views/pathway/forms/total-activities",{hash:3281900299,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.TotalActivities=function(){let{texts:e,values:a,store:n,setValues:r}=(0,u.usePathwayContext)(),{brief:t,standard:i,extended:o}=(e=e.pathway.ai).form.size.items,s=[{value:15,label:t,totalActivities:3},{value:45,label:i,totalActivities:5},{value:60,label:o,totalActivities:7}];return a?.audienceIndex&&parseInt(a.duration),a?.duration?.index&&parseInt(a.duration.index),a.duration&&s.find(e=>e.value===a.duration),l.default.createElement("div",null,l.default.createElement("label",{htmlFor:""},e.form.size.placeholder),l.default.createElement(c.ReactSelect,{placeholder:e.form.size.placeholder,onChange:t=>{var e=s.find(e=>e.value===parseInt(t.target.value)),e={...a,duration:t.target.value,totalActivities:e?.totalActivities||null};r(e),n.model.set(e)},name:"duration",value:a.duration,options:s}))};var l=e("react"),c=e("pragmate-ui/form/react-select"),u=e("../context")}}),T.set("./views/pathway/index",{hash:4243896678,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PathwayGeneration=function({store:e,values:t,show:a,setValues:n,onClose:r}){let{texts:i,improvements:o}=e,[s]=v.default.useState(!1),[l,c]=v.default.useState(""),[u,d]=v.default.useState(),[m,f]=v.default.useState("");var p;return a?(p=(p={confirm:x.ConfirmationForm,selection:E.DecistionType,ai:_.AIGenerationForm,manual:j.ManualForm,examples:y.SuggestionExamples,request:S.RequestCreditsContainer})[o&&!u?"confirm":u||"selection"],v.default.createElement(g.Modal,{className:"module-setup__modal",show:!0,onClose:()=>{c(""),d(void 0),r()},closeBackdrop:!(a=async()=>{try{(await e.update({state:"confirmed"})).status?r():f("default")}catch(e){f("default")}})},v.default.createElement(w.ErrorRenderer,{error:m,texts:i.refine.errors}),v.default.createElement(b.PathwayContext.Provider,{value:{view:u,texts:e.texts,values:t,store:e,setValues:n,onClose:()=>{c(""),d(void 0),r()},setView:d,notes:l,setNotes:c}},v.default.createElement(C.AnimatePresence,{mode:"wait"},v.default.createElement(p,{onSave:a,key:"control"})),v.default.createElement(h.ProcessContainer,{key:"container",fetching:s})))):null};var v=e("react"),g=e("pragmate-ui/modal"),h=e("@aimpact/ailearn-app/components/ui"),b=e("./context"),y=e("./examples"),w=e("../components/alert"),x=e("./confirmation"),E=e("./forms/decision-type"),C=e("framer-motion"),j=e("./forms/manual"),_=e("./forms/ai-form"),S=e("./request-credits")}}),T.set("./views/pathway/request-credits",{hash:1946450603,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.RequestCreditsContainer=function(){let{store:e,onClose:t,setView:a}=(0,o.usePathwayContext)(),n={...e.globalTexts};return n.actions.cancel=e.globalTexts.actions.back,r.default.createElement(r.default.Fragment,null,r.default.createElement(i.RequestCreditsForm,{onConsume:e.model.consumeCoins,globalTexts:n,owner:e.model.owner,onClose:t,onCancel:()=>a("selection"),onSuccess:()=>a("ai")}))};var r=e("react"),i=e("@aimpact/ailearn-app/components/ui"),o=e("./context")}}),N.exports.descriptor=[{im:"./controller",from:"Controller",name:"Controller"},{im:"./views/form/confirmation-modal",from:"ConfirmationModal",name:"ConfirmationModal"},{im:"./views/form/fields/supporting-text",from:"SupportingText",name:"SupportingText"},{im:"./views/form/image",from:"OwnerImage",name:"OwnerImage"},{im:"./views/index",from:"View",name:"View"}],N.exports.process=function({require:e,prop:t,value:a}){!e&&"Controller"!==t||n("Controller",e?e("./controller").Controller:a),!e&&"ConfirmationModal"!==t||n("ConfirmationModal",e?e("./views/form/confirmation-modal").ConfirmationModal:a),!e&&"SupportingText"!==t||n("SupportingText",e?e("./views/form/fields/supporting-text").SupportingText:a),!e&&"OwnerImage"!==t||n("OwnerImage",e?e("./views/form/image").OwnerImage:a),!e&&"View"!==t||n("View",e?e("./views/index").View:a)},n("__beyond_pkg",N),n("hmr",new function(){this.on=(e,t)=>N.hmr.on(e,t),this.off=(e,t)=>N.hmr.off(e,t)}),N.initialise(T)}}});