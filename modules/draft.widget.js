System.register(["@beyond-js/widgets@1.1.0/render","@beyond-js/kernel@0.1.9/bundle","@beyond-js/kernel@0.1.9/styles","@beyond-js/react-18-widgets@1.1.2/page","@aimpact/ailearn-app@0.1.6-dev.21/main-layout.widget","react@18.3.1","@beyond-js/widgets@1.1.0/controller","@aimpact/ailearn-sdk@1.0.0/learning-modules","@beyond-js/reactive@1.2.0/model","@aimpact/chat-sdk@1.1.0/session","@beyond-js/kernel@0.1.9/texts","@aimpact/ailearn-app@0.1.6-dev.21/widgets/breadcrumb.widget","@aimpact/ailearn-app@0.1.6-dev.21/i18n.ts","pragmate-ui@1.0.0-beta.6/modal","@aimpact/ailearn-app@0.1.6-dev.21/components/ui","@aimpact/ailearn-app@0.1.6-dev.21/components/icons","pragmate-ui@1.0.0-beta.6/components","pragmate-ui@1.0.0-beta.6/base","pragmate-ui@1.0.0-beta.6/icons","pragmate-ui@1.0.0-beta.6/alert","@beyond-js/react-18-widgets@1.1.2/hooks","framer-motion@10.18.0","pragmate-ui@1.0.0-beta.6/form/react-select","pragmate-ui@1.0.0-beta.6/form","pragmate-ui@1.0.0-beta.6/image","@beyond-js/kernel@0.1.9/routing","pragmate-ui@1.0.0-beta.6/list"],function(n,e){"use strict";var t,a,r,o,s,i,l,c,u,d,m,f,p,v,g,h,b,y,x,E,C,w,j,_,M,S,k,O,P;return n({Controller:void 0,AIButton:void 0,AIIconButton:void 0,ConfirmationModal:void 0,DraftContainer:void 0,SupportingText:void 0,OwnerImage:void 0,View:void 0}),{setters:[function(e){t=e},function(e){a=e},function(e){r=e},function(e){o=e},function(e){s=e},function(e){i=e},function(e){l=e},function(e){c=e},function(e){u=e},function(e){d=e},function(e){m=e},function(e){f=e},function(e){p=e},function(e){v=e},function(e){g=e},function(e){h=e},function(e){b=e},function(e){y=e},function(e){x=e},function(e){E=e},function(e){C=e},function(e){w=e},function(e){j=e},function(e){_=e},function(e){M=e},function(e){S=e},function(e){k=e}],execute:function(){P=a.Bundle,(O=new P({module:{vspecifier:"@aimpact/ailearn-app@0.1.6-dev.21/modules/draft",multibundle:!0},type:"widget"},e.meta.url).package()).dependencies.update([["@beyond-js/widgets/render",t],["@beyond-js/kernel/styles",r],["@beyond-js/react-18-widgets/page",o],["@aimpact/ailearn-app/main-layout.widget",s],["react",i],["@beyond-js/widgets/controller",l],["@aimpact/ailearn-sdk/learning-modules",c],["@beyond-js/reactive/model",u],["@aimpact/chat-sdk/session",d],["@beyond-js/kernel/texts",m],["@aimpact/ailearn-app/widgets/breadcrumb.widget",f],["@aimpact/ailearn-app/i18n.ts",p],["pragmate-ui/modal",v],["@aimpact/ailearn-app/components/ui",g],["@aimpact/ailearn-app/components/icons",h],["pragmate-ui/components",b],["pragmate-ui/base",y],["pragmate-ui/icons",x],["pragmate-ui/alert",E],["@beyond-js/react-18-widgets/hooks",C],["framer-motion",w],["pragmate-ui/form/react-select",j],["pragmate-ui/form",_],["pragmate-ui/image",M],["@beyond-js/kernel/routing",S],["pragmate-ui/list",k]]),brequire("@beyond-js/widgets/render").widgets.register([{name:"app-module-objective-management",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.21/modules/draft.widget",is:"page",route:"/modules/management",layout:"main-layout"}]),brequire("@beyond-js/kernel/styles").styles.register("@aimpact/ailearn-app@0.1.6-dev.21/modules/draft.widget"),(P=new Map).set("./controller",{hash:2145005337,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Controller=void 0;var a=e("@beyond-js/react-18-widgets/page"),n=e("./store"),r=e("./views");class o extends a.PageReactWidgetController{#store;createStore(){return this.#store=n.store,this.#store}get Widget(){return r.View}show(){this.#store.load(this.uri.qs.get("id"),this.uri.qs.get("activityId"))}hide(){this.#store.hide()}}t.Controller=o}}),P.set("./management",{hash:1108312047,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ActivitiesManagement=function({store:e,uri:t}){var[t,,]=n.default.useState(t.qs.get("activityId")||null),a=n.default.useRef(null);return n.default.createElement("div",null,n.default.createElement("app-modules-management",{id:e.model.id,activityId:t,ref:a}))};var n=e("react")}}),P.set("./store",{hash:3076341850,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.store=t.StoreManager=void 0;var a=e("@aimpact/ailearn-sdk/learning-modules"),n=e("@beyond-js/reactive/model"),r=e("@aimpact/chat-sdk/session"),o=e("@aimpact/ailearn-app/main-layout.widget"),s=e("@beyond-js/kernel/texts"),i=e("beyond_context"),l=e("@aimpact/ailearn-app/widgets/breadcrumb.widget"),c=e("@aimpact/ailearn-app/i18n.ts");class u extends n.ReactiveModel{isStore=!0;#model;#alert;get alert(){return this.#alert}get globalTexts(){return c.globalTexts.texts}#saved=!1;get saved(){return this.#saved}get model(){return this.#model}#improvements;get improvements(){return this.#improvements}get hasCredits(){return 0<this.#model.credits?.total}#improvementsSelected=new Set;get improvementsSelected(){return this.#improvementsSelected}get user(){return r.sessionWrapper.user}get breadcrumb(){return l.breadcrumbStore.breadcrumb}#currentProcess;get currentProcess(){return this.#currentProcess}get ownerships(){var e=this.user.organizations.items;return[{value:this.user.id,label:this.user.displayName},...e.map(e=>({value:e.id,label:e.name}))]}get moduleOwner(){if(this.model.owner)return{value:this.model.owner.id,label:this.model.owner.name}}#selected;get defaultValues(){return{audience:"",duration:45,objective:"",totalActivities:5,language:this.#model.language}}get values(){return this.#saved?this.model.getProperties():this.defaultValues}#texts=new s.CurrentTexts(i.module.specifier);get texts(){return this.#texts?.value}get ready(){return super.ready&&this.#texts.ready&&c.globalTexts.ready}#objectivesGenerated=new Map;constructor(){super(),this.__id=performance.now(),this.reactiveProps(["fetchingDraft","fetchingSuggestions"]),c.globalTexts.on("change",this.triggerEvent),this.#texts.on("change",this.listenTexts)}listenTexts=()=>{this.triggerEvent("change")};hide(){this.#model=void 0,super.ready=!1,this.#improvements=void 0,this.triggerEvent(),o.LayoutBroker.clear()}clearImprovements(){this.#improvements=void 0,this.triggerEvent("change")}async load(e){try{var t;e&&this.#model?.id===e||(t={type:"draft",id:e},this.#model=await a.LearningModule.get(t),this.#model.on("change",this.triggerEvent),this.#saved=!!e,o.LayoutBroker.addModel(this.#model,!0),o.LayoutBroker.canConsumeCredits=this.#saved,super.ready=!0,this.triggerEvent())}catch(e){console.error(e)}}listener(){}async save(e){return this.processing=!0,o.LayoutBroker.addModel(this.#model,!0),await this.model.saveDraft(e),this.processing=!1,this.#saved=!0,o.LayoutBroker.canConsumeCredits=!0,this.#model}async clean(){this.#model.activities.clean(),this.#saved=void 0,this.trigger("change")}async getObjectiveImprovements({objective:e}){try{this.#currentProcess="objective",this.fetchingSuggestions=!0;var t=await this.model.getObjectiveImprovements({objective:e});this.#improvements=t,this.triggerEvent("change")}catch(e){console.error(e)}finally{this.#currentProcess=void 0,this.fetchingSuggestions=!1}}async generateObjective({objective:e,improvements:t}){try{this.#currentProcess="changingObjective",this.fetchingSuggestions=!0;var a=await this.model.generateObjective({objective:e,improvements:t});return this.#objectivesGenerated.set(e,a.objective),this.model.save,this.#model.objective=a.objective,this.#improvements=void 0,this.#improvementsSelected=new Set,this.triggerEvent("change"),this.#model.objective}catch(e){console.error(e)}finally{this.#currentProcess=void 0,this.fetchingSuggestions=!1}}async generateModuleSuggestion(e){try{this.#currentProcess="generatingDraft",this.fetchingDraft=!0,await this.model.getModuleSuggestion({...e})}catch(e){console.error(e)}finally{this.#currentProcess=void 0,this.fetchingDraft=!1}}async getAdministrator(t){return this.user.id===t?this.user:this.user.organizations.items.find(e=>e.id===t)}setAlert({message:e,type:t,position:a="top"}){this.#alert={message:e,type:t,position:a},this.trigger("alert.changed")}clearAlert(){this.#alert=void 0,this.trigger("alert.changed")}}t.StoreManager=u,t.store=new u}}),P.set("./trim",{hash:750512083,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.trimText=function(e,t){if(e.length<=t)return e;let a=e.slice(0,t);return e[t]&&!/\s|[.,!?]/.test(e[t])&&(t=(e=e.slice(t)).search(/\s|[.,!?]/),a+=-1!==t?e.slice(0,t):e),a+"..."}}}),P.set("./use-texts-callback",{hash:4103720571,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.useTextsCallback=function(a,n){const[e,r]=i.useState(!1),[t,o]=i.useState({}),s=(i.useEffect(()=>{const t=new l.CurrentTexts(a),e=()=>{var e=t.value;o(e),r(t.ready),t.ready&&n(e)};return t.on("change",e),e(),()=>{t.on("change",e)}},[]),e&&!!t);return[s,t]};var i=e("react"),l=e("@beyond-js/kernel/texts")}}),P.set("./views/coins/alert",{hash:100216912,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CoinsAlert=function({show:e,onClose:t,texts:a}){return e?(a=a.coins.alert,n.default.createElement(r.AlertModal,{show:!0,buttonLabel:a.action,onConfirm:t,onClose:t},n.default.createElement("header",null,n.default.createElement("h3",null,a.title),n.default.createElement(o.Battery,{percent:"100",className:"lg"}),n.default.createElement("p",null,a.description)))):null};var n=e("react"),r=e("pragmate-ui/modal"),o=e("@aimpact/ailearn-app/components/ui")}}),P.set("./views/coins/coins-modal",{hash:2894868445,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CoinsModal=function({store:e,show:t,onClose:a,texts:n}){if(!t)return null;const[,r]=i.default.useState(!1),[o,s]=i.default.useState();return n=n.coins.modal,i.default.createElement(l.ConfirmModal,{show:!0,className:"modal-sm",actions:{confirm:{label:n.actions.confirm,variant:"primary"},cancel:{label:n.actions.cancel,variant:"primary",bordered:!0}},onConfirm:async()=>{try{r(!0),await e.model.getCredits(),a()}catch(e){s(n.errors.noCredits)}finally{r(!1)}},onCancel:a,onClose:a},i.default.createElement("header",null,i.default.createElement("h3",null,n.title),i.default.createElement(c.ErrorRenderer,{error:o}),i.default.createElement(c.Battery,{percent:"100",className:"lg"}),i.default.createElement("p",null,n.description)))};var i=e("react"),l=e("pragmate-ui/modal"),c=e("@aimpact/ailearn-app/components/ui")}}),P.set("./views/components/ai-button",{hash:2552670583,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AIButton=function({children:e,onClick:t,ensure:a,...n}={ensure:!0}){return a=a?()=>l.LayoutBroker.ensureCredits(t):t,r.default.createElement(s.Button,{...n,icon:o.ICONS.aiStars,onClick:a},e)},t.AIIconButton=function({children:e,onClick:t,ensure:a,...n}={ensure:!0}){return a=a?()=>l.LayoutBroker.ensureCredits(t):t,r.default.createElement(i.IconButton,{...n,icon:o.ICONS.aiStars,onClick:a},e)};var r=e("react"),o=e("@aimpact/ailearn-app/components/icons"),s=e("pragmate-ui/components"),i=e("pragmate-ui/icons"),l=e("@aimpact/ailearn-app/main-layout.widget")}}),P.set("./views/components/alert",{hash:2743908413,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AlertRenderer=function({type:e="success",message:t,className:a,time:n=3e3,show:r=!0}){a="alert-message alert-message--"+e+(a?" "+a:"");const[o,s]=c.default.useState(!1),[,i]=c.default.useState(null),l=(0,u.useModuleContext)().store;return c.default.useEffect(()=>{if(r){const e=setTimeout(()=>{r&&s(!0),l.clearAlert()},n);return i(e),()=>clearTimeout(e)}i(void 0),s(void 0)},[t,r]),o||!r?null:c.default.createElement(d.motion.div,{initial:{opacity:0},animate:{opacity:1,transition:{duration:.3,delay:.3},y:0},exit:{transition:{duration:.3},opacity:0},className:a},t)},t.ErrorRenderer=function({texts:e,error:t}){return c.default.createElement(a.Alert,{variant:"error"},e[t])};var c=e("react"),a=e("pragmate-ui/alert"),u=e("../context"),d=e("framer-motion")}}),P.set("./views/components/footer",{hash:584877816,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.StepsFooter=function({submitLabel:e="next",onSubmit:t,disabled:a=!1,previous:n=!0}){const{texts:r,setCurrent:o,current:s}=(0,u.useModuleContext)(),i=r.actions[e];return l.default.createElement("footer",null,n&&l.default.createElement(c.Button,{variant:"primary",bordered:!0,onClick:()=>o(s-1)},r.actions.back),l.default.createElement(c.Button,{type:"submit",variant:"primary",onClick:t,disabled:a,sizing:"lg"},i))};var l=e("react"),c=e("pragmate-ui/components"),u=e("../context")}}),P.set("./views/components/html-render",{hash:3362016598,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.HtmlRender=function({children:e,tag:t="span"}){return a.default.createElement(t,{dangerouslySetInnerHTML:{__html:e}})};var a=e("react")}}),P.set("./views/components/options",{hash:369455942,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getOptions=function(e){return{audience:[[e.audience.school,e.audience.school],[e.audience.university,e.audience.university],[e.audience.company,e.audience.company]],duration:[["15",e.duration.brief],["45",e.duration.standard],["60",e.duration.extended]],language:[["en",e.languages.en],["es",e.languages.es],["pt",e.languages.pt],["fr",e.languages.fr],["de",e.languages.de]]}}}}),P.set("./views/components/radio-button",{hash:54679154,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.RadioButton=function({name:n,onChange:r,label:e,selected:t=0}){const{texts:a,store:o}=(0,d.useModuleContext)(),s={disabled:o.fetching||o.model.fetching},i=(0,m.getOptions)(a),l=i[n].map(([e,t],a)=>c.default.createElement(u.Button,{name:n,...s,"data-index":a,onClick:r,key:a,value:e},t));return c.default.createElement("div",{className:"radio-button__container"},c.default.createElement("label",{htmlFor:n},e),c.default.createElement(u.ButtonGroup,{selected:t,...s},l))};var c=e("react"),u=e("pragmate-ui/components"),d=e("../context"),m=e("./options")}}),P.set("./views/context",{hash:2503491862,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.useSuggestionsContext=t.useModuleContext=t.useDraftManagementContext=t.SuggestionsContext=t.ModuleContext=t.DraftManagementContext=void 0;var a=e("react");const n=t.ModuleContext=a.default.createContext({}),r=(t.useModuleContext=()=>a.default.useContext(n),t.DraftManagementContext=a.default.createContext({})),o=(t.useDraftManagementContext=()=>a.default.useContext(r),t.SuggestionsContext=a.default.createContext({}));t.useSuggestionsContext=()=>a.default.useContext(o)}}),P.set("./views/form/animated-div",{hash:2040524209,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AnimatedDiv=function({children:e}={children:null,cls:""}){return a.default.createElement(n.motion.div,{className:"objective__container",initial:{opacity:0},animate:{opacity:1,transition:{duration:.3,delay:.3},y:0},exit:{transition:{duration:.3},opacity:0}},e)};var a=e("react"),n=e("framer-motion")}}),P.set("./views/form/confirmation-modal",{hash:4051622575,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ConfirmationModal=function({onClose:e,onConfirm:t}){var{store:a,texts:n,values:r}=(0,l.useModuleContext)(),r=r.owner,a=a.globalTexts,a=(n=n.setup.confirmation,a.actions),o="User"===r.constructor.name?r.displayName:r.name;return s.default.createElement(i.Modal,{show:!0,className:"modal-sm modal-centered",onClose:e},s.default.createElement("div",null,s.default.createElement("header",null,s.default.createElement("h3",null,n.title),s.default.createElement("span",null,n.subtitle)),s.default.createElement("div",{className:"owner-container"},s.default.createElement(c.OwnerImage,{owner:r}),s.default.createElement("div",{className:"owner-info"},s.default.createElement("h6",null,o),s.default.createElement("span",null,n.ownerDescription))),s.default.createElement("div",{className:"primary-container text-center"},s.default.createElement("span",null,n.description)),s.default.createElement("section",{className:"actions__container"},s.default.createElement(u.Button,{variant:"primary",bordered:!0,onClick:e},a.cancel),s.default.createElement(u.Button,{variant:"primary",onClick:t},a.continue))))};var s=e("react"),i=e("pragmate-ui/modal"),l=e("../context"),c=e("./image"),u=e("pragmate-ui/components")}}),P.set("./views/form/container",{hash:2809561136,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DraftContainer=function({store:e}){const[t,a]=(0,b.useTexts)(E.module.specifier),[n,r]=h.useState(e.fetching),[o]=h.useState(0),[,s]=h.useState({}),[i,l]=h.useState(0),[c,u]=h.useState({...e.values}),[d,m]=h.useState(),[f,p]=h.useState(!1),v=(0,x.useDraftManagementContext)().ensureCredits;var g;return(0,b.useBinder)([e],()=>{s({}),r(e?.fetching)}),t&&e.ready?(g={store:e,onChange:e=>{u({...c,[e.currentTarget.name]:e.currentTarget.value,updated:!0})},texts:a,activePanel:o,current:i,setCurrent:l,improvements:e.improvements,error:d,ensureCredits:v,setError:m,fetching:n||f,setIsFetching:p,saved:e.saved,values:c,setValues:u},h.createElement(h.Fragment,null,h.createElement(x.ModuleContext.Provider,{value:g},h.createElement(y.PageContainer,{className:n?"is-fetching":"",fetching:n&&!!e.model?.activities.length},h.createElement(C.DraftForm,null))))):null};var h=e("react"),b=e("@beyond-js/react-18-widgets/hooks"),y=e("@aimpact/ailearn-app/components/ui"),x=e("../context"),E=e("beyond_context"),C=e("./")}}),P.set("./views/form/fields/audience",{hash:2222746801,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AudienceField=function({disabled:e}){const{texts:{audience:t},texts:{},store:a}=(0,c.useModuleContext)(),{setValues:n,values:r}=(0,c.useModuleContext)();let o={value:"",label:t.input.select};var s=Object.keys(t.argentine).map(e=>(o=e===r.audience?{value:e,label:t.argentine[e]}:o,{value:e,label:t.argentine[e]})),e={isDisabled:a.saved||e};return i.default.createElement("div",null,i.default.createElement("label",{htmlFor:""},t.input.label),i.default.createElement(l.ReactSelect,{name:"audience",value:r.audience,placeholder:t.input.select,options:s,onChange:t=>n(e=>({...e,audience:t.target.value})),...e}))};var i=e("react"),l=e("pragmate-ui/form/react-select"),c=e("../../context")}}),P.set("./views/form/fields/language",{hash:3795966877,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.LanguageField=function({disabled:e}){const{texts:t,store:a,setValues:n}=(0,l.useModuleContext)(),r=["en","es"].map(e=>({value:e,label:t.languages[e]})),o={isDisabled:a.saved||e};return s.default.createElement("div",null,s.default.createElement("label",{htmlFor:""},t.languages.select.label),s.default.createElement(i.ReactSelect,{placeholder:t.languages.select.placeholder,value:a.model.language,name:"audience",options:r,onChange:t=>n(e=>({...e,language:t.target.value})),...o}))};var s=e("react"),i=e("pragmate-ui/form/react-select"),l=e("../../context")}}),P.set("./views/form/fields/objective",{hash:3055597404,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectiveField=function(){var{values:e,texts:t,onChange:a,store:n}=(0,i.useModuleContext)(),r=t.setup.form;return o.default.createElement(l.AnimatePresence,{mode:"wait"},o.default.createElement(u.TourStep,{as:"section",texts:t.objectiveTour,name:"objective"},o.default.createElement("div",{className:"objective-field "},o.default.createElement(s.Textarea,{onChange:a,value:e.objective,name:"objective",placeholder:r.objective.textArea,counter:!0,maxLength:500}),o.default.createElement(c.AlertRenderer,{show:!!n.alert&&"objective"===n.alert.position,type:"success",className:"alert-message alert-message--success alert-fixed",message:t.setup.messages.save}))))};var o=e("react"),s=e("pragmate-ui/form"),i=e("../../context"),l=e("framer-motion"),c=e("../../components/alert"),u=e("@aimpact/ailearn-app/components/ui")}}),P.set("./views/form/fields/ownership",{hash:574589775,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.OwnershipField=function({disabled:e}={}){const{texts:{setup:{form:t}},texts:{objectiveTour:a},store:n}=(0,f.useModuleContext)(),{setValues:r,texts:o}=(0,f.useModuleContext)(),s=(0,f.useDraftManagementContext)().setProcessing,[,i]=d.default.useState(null),[l,c]=d.default.useState({content:"",variant:""});t.administrator.select,n.model.owner&&(n.model.owner.id,n.model.owner.name);var u=n.model.owner?.id,e={isDisabled:0===n.ownerships?.length||n.saved||e};return d.default.createElement(d.default.Fragment,null,d.default.createElement(p.TourStep,{texts:a,name:"administrator",as:"div",className:"administrator"},d.default.createElement("div",{className:"field-container"},d.default.createElement("label",{htmlFor:""},t.administrator.label),d.default.createElement(m.ReactSelect,{value:u,placeholder:t.administrator.select,name:"owner",options:n.ownerships,onChange:async e=>{c({content:"",variant:""}),s(!0);const t=await n.getAdministrator(e.target.value);var a;"Organization"===t.constructor.name&&await t.getCredits(),i(t),void 0===t.coins?.modules?console.error("the user does not have coins data loaded, refresh the page and try again."):(e=t.coins.modules.count,a=o.alerts.coins,a=e?a.available:a.unavailable,e=e?"success":"error",c({content:a,variant:e}),r(e=>({...e,owner:t})),s(!1))},...e}),d.default.createElement(v.SupportingText,{...l}))))};var d=e("react"),m=e("pragmate-ui/form/react-select"),f=e("../../context"),p=e("@aimpact/ailearn-app/components/ui"),v=e("./supporting-text")}}),P.set("./views/form/fields/supporting-text",{hash:3724854723,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SupportingText=function({content:e,variant:t="default",className:a="",...n}){return e?(t=(`pui-supporting-text ${t=o[t]||o.default} `+a).trim(),r.default.createElement("div",{className:t,...n},r.default.createElement("span",null,e))):null};var r=e("react");const o={primary:"text-primary",secondary:"text-secondary",tertiary:"text-tertiary",success:"text-success",info:"text-info",error:"text-error",warning:"text-warning",default:"text-default"}}}),P.set("./views/form/image",{hash:315420214,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.OwnerImage=function({owner:e}){return e?.photoUrl?a.default.createElement(n.Image,{src:e.photoUrl,className:"circle"}):a.default.createElement(r.AppIcon,{icon:"school",className:"pui-image"})};var a=e("react"),n=e("pragmate-ui/image"),r=e("@aimpact/ailearn-app/components/icons")}}),P.set("./views/form/index",{hash:2861465045,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DraftForm=function(){const{values:e,setValues:t,store:a,texts:n,saved:r,fetching:o}=(0,x.useModuleContext)(),[s,i]=b.useState(!1),l=a.model.state&&r?n.actions.continue:n.actions.save,c=(0,E.useDriverTour)("moduleObjective",a.ready,n?.objectiveTour?.buttons).ref,[u,d]=b.useState(!1),m=!(e.owner&&e.audience&&e.objective&&e.language),f=m||u||a.processing,[p,v]=b.useState(!1),g=((0,T.useBinder)([a],()=>d(a.fetchingSuggestions)),`form-create-draft__container ${o?"fetching":""} `+(u?"is-processing":"")),h=u?"is-processing":"";return b.createElement("div",{ref:c,className:h},b.createElement(S.Form,{className:g,onSubmit:async()=>{try{u||(d(!0),await!(a.model.state===e.state&&a.model.objective===e.objective||(await t({...e,updated:!1}),"created"!==a.model.state&&(v(!0),d(!1)))),r&&"created"===a.model.state&&i(!0))}catch(e){console.error(e)}finally{d(!1)}}},b.createElement(y.AnimatedDiv,null,b.createElement("section",{className:"form-body"},b.createElement("header",{className:"setup-form-header"},b.createElement("h1",null,n.setup.title),b.createElement("span",null,n.setup.subtitle)),b.createElement(O.AlertRenderer,{type:a.alert?.type,message:a.alert?.message,show:!!a.alert&&"top"===a.alert.position,className:"alert--small"}),b.createElement("section",{className:"wizard-first-step-container"},b.createElement(w.OwnershipField,{disabled:u}),b.createElement(E.TourStep,{texts:n.objectiveTour,name:"parameters",as:"div",className:"parameters-container"},b.createElement(P.LanguageField,{disabled:u}),b.createElement(C.AudienceField,{disabled:u}))),b.createElement(E.TourStep,{as:"section",texts:n.objectiveTour,name:"objective",className:"form-wizard__objective-section relative-container"},b.createElement(j.ObjectiveField,null))),b.createElement(k.ObjectiveSuggestions,{setProcessing:d,processing:u}),b.createElement("footer",null,b.createElement(I.SuggestionsAction,null),b.createElement(E.TourStep,{texts:n.objectiveTour,name:"save",className:"save-button__container"},b.createElement(M.Button,{type:"submit",block:!0,disabled:f,variant:"primary"},l)))),b.createElement(E.ProcessContainer,{fetching:o})),b.createElement(B.PathwayGeneration,{show:s,onClose:()=>i(!1)}),p&&b.createElement(A.ConfirmationModal,{onConfirm:async()=>{await a.save({...e,state:"created"}),a.breadcrumb.lastItem.label=(0,N.trimText)(a.model.objective,15),_.routing.replaceState({},void 0,"/modules/management?id="+a.model.id),v(!1),a.setAlert({message:n.setup.messages.save,position:"objective"})},onClose:()=>v(!1)}))};var b=e("react"),y=e("./animated-div"),x=e("../context"),E=e("@aimpact/ailearn-app/components/ui"),C=e("./fields/audience"),w=e("./fields/ownership"),j=e("./fields/objective"),_=e("@beyond-js/kernel/routing"),M=e("pragmate-ui/components"),S=e("pragmate-ui/form"),k=e("./suggestions"),O=e("../components/alert"),P=e("./fields/language"),N=e("../../trim"),I=e("./suggestions/action"),B=e("../pathway"),T=e("@beyond-js/react-18-widgets/hooks"),A=e("./confirmation-modal")}}),P.set("./views/form/suggestions/action",{hash:704421863,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestionsAction=function({}){const{texts:{actions:e},store:t,values:a,saved:n}=(0,o.useModuleContext)();return t.improvements?null:r.default.createElement(r.default.Fragment,null,r.default.createElement(s.AIButton,{disabled:!n||!t.hasCredits,onClick:async()=>{try{await t.getObjectiveImprovements({objective:a.objective})}catch(e){console.error(e)}},variant:"primary",bordered:!0},e.analyse))};var r=e("react"),o=e("../../context"),s=e("../../components/ai-button")}}),P.set("./views/form/suggestions/index",{hash:3554607872,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectiveSuggestions=function({processing:e,setProcessing:t}){var a=(0,s.useModuleContext)().store,[n,r]=o.default.useState(!1);return!a.improvements||a.improvements.irrelevant?null:o.default.createElement(s.SuggestionsContext.Provider,{value:{improvedObjective:n,setImprovedObjective:r,processing:e,setProcessing:t}},o.default.createElement(i.ObjectiveImproved,null),o.default.createElement(l.SuggestionsList,{block:!n}))};var o=e("react"),s=e("../../context"),i=e("./objective"),l=e("./list")}}),P.set("./views/form/suggestions/list/index",{hash:3565375712,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestionsList=function({block:e}){const{texts:{suggestions:t,actions:a},store:n,values:r,setValues:o}=(0,p.useModuleContext)(),s=(0,p.useSuggestionsContext)().setImprovedObjective,[i,l]=d.default.useState(new Set);var c,u;return n.improvements?(c=n.improvements.suggestions,u={disabled:!i.size||e},d.default.createElement("section",{className:"objective-suggestions__container"+(e?" is-disabled":"")},d.default.createElement(f.List,{className:"objective-suggestions__list",specs:{selected:i,setSelected:l,block:e},control:v.ObjectiveSuggestionsItem,items:c}),d.default.createElement("div",{className:"section__actions"},d.default.createElement("span",null,t.total,": ",i.size),d.default.createElement("div",{className:"section__actions"},d.default.createElement(m.Button,{disabled:e,onClick:()=>{l(new Set),s(!1),n.clearImprovements()},variant:"primary",bordered:!0},a.removeSuggestions),d.default.createElement(m.Button,{...u,variant:"primary",onClick:async e=>{var t={objective:r.objective,improvements:Array.from(i).map(e=>n.improvements.suggestions[e].suggestion)};await n.generateObjective(t),s(!1),o(e=>({...e,objective:n.model.objective}))}},a.applySuggestions))))):null};var d=e("react"),m=e("pragmate-ui/components"),f=e("pragmate-ui/list"),p=e("../../../context"),v=e("./item")}}),P.set("./views/form/suggestions/list/item",{hash:2063911443,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectiveSuggestionsItem=function(e={}){const{index:t,item:a,block:n,selected:r,setSelected:o}=e,{store:s,texts:{suggestions:i}}=(0,d.useModuleContext)(),l="suggestion__item"+(r.has(t)?" selected":""),c={className:l,"data-index":t};return n||(c.onClick=e=>{e.stopPropagation();var e=parseInt(e.currentTarget.dataset.index),t=r;t.has(e)?t.delete(e):t.add(e),s.improvementsSelected.add(e),o(new Set(t))}),u.default.createElement("div",{className:l,"data-index":t,...c},u.default.createElement("header",null,u.default.createElement("span",{className:"suggestion-label"},i.origin),u.default.createElement("span",{className:"suggestion-reference"},a.reference)),u.default.createElement("div",{className:"item__content"},u.default.createElement("header",null,u.default.createElement("span",{className:"suggestion-label"},i.label)),a.suggestion))};var u=e("react"),d=e("../../../context")}}),P.set("./views/form/suggestions/objective",{hash:4225891460,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectiveImproved=function(){const{texts:{suggestions:{objective:{actions:e}}},store:t,setValues:a,values:n,store:{improvements:r}}=(0,m.useModuleContext)(),{improvedObjective:o,setImprovedObjective:s}=(0,m.useSuggestionsContext)(),i=r.improved,[l,c]=d.default.useState(!1);var u;return!r||o?null:(u=async e=>{c(!0),"true"===e.currentTarget.value&&(await t.save({objective:i}),a({...n,objective:i})),s(!0),c(!1)},d.default.createElement("div",{className:"objective-suggestion "+(l?"is-processing":"")},d.default.createElement("h3",null,i),d.default.createElement("div",{className:"objective-suggestion__actions"},d.default.createElement("span",{className:"primary-text"},e.label),d.default.createElement("div",{className:"section__actions"},d.default.createElement(f.Button,{variant:"primary",bordered:!0,value:"false",onClick:u},e.cancel),d.default.createElement(f.Button,{variant:"primary",value:"true",onClick:u},e.confirm)))))};var d=e("react"),m=e("../../context"),f=e("pragmate-ui/components")}}),P.set("./views/index",{hash:2212543045,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.View=function(e){const t=e.store,[a,n]=i.useState(!1),[,,]=i.useState(t.fetching),[,r]=i.useState({}),o=t.texts;var s;return(0,l.useBinder)([t],()=>{r({})}),t.ready?(s={texts:o,store:t,processing:a,setProcessing:n,ensureCredits:d.LayoutBroker.ensureCredits},i.createElement(i.Fragment,null,i.createElement(m.DraftManagementContext.Provider,{value:s},"confirmed"===t.model.state?i.createElement(u.ActivitiesManagement,{store:t,uri:e.uri}):i.createElement(c.DraftContainer,{store:t,uri:e.uri})))):null};var i=e("react"),l=e("@beyond-js/react-18-widgets/hooks"),c=e("./form/container"),u=e("../management"),d=e("@aimpact/ailearn-app/main-layout.widget"),m=e("./context")}}),P.set("./views/pathway/confirmation",{hash:1814516122,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ConfirmationForm=function({}){const e=(0,o.useModuleContext)().texts,{setView:t,onClose:a}=(0,s.useModalContext)(),[,]=n.default.useState(!1);return n.default.createElement("div",{className:"modal__header"},n.default.createElement("header",null,n.default.createElement("h3",null,e.refine.confirm.title),n.default.createElement("div",{className:"description__content"},n.default.createElement("span",null,e.refine.confirm.description))),n.default.createElement("footer",{className:"actions mt-30 flex-container flex-center"},n.default.createElement(r.Button,{variant:"primary",bordered:!0,onClick:a},e.actions.cancel),n.default.createElement(r.Button,{variant:"primary",onClick:async()=>{t("selection")}},e.actions.confirm)))};var n=e("react"),r=e("pragmate-ui/components"),o=e("../context"),s=e("./context")}}),P.set("./views/pathway/context",{hash:1113930506,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.useModalContext=t.ModalContext=void 0;var a=e("react");const n=t.ModalContext=a.default.createContext({});t.useModalContext=()=>a.default.useContext(n)}}),P.set("./views/pathway/examples",{hash:4146255957,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestionExamples=function(){const t=(0,i.useModuleContext)().texts,{setView:a,setNotes:n}=(0,l.useModalContext)();return r.default.createElement(r.default.Fragment,null,r.default.createElement("div",{className:"modal__content--justified"},r.default.createElement("h3",null,t.refine.examples.title),r.default.createElement(s.List,{className:"modal__list--options-selection",items:t.refine.examples.items,control:({item:e})=>r.default.createElement("li",{className:"list__item"},r.default.createElement("span",null,e),r.default.createElement("div",null,r.default.createElement(o.Button,{bordered:!0,variant:"primary",onClick:()=>{n(e),a("suggestions")}},t.refine.examples.actions.select)))}),r.default.createElement("div",{className:"flex-container flex-end mt-30"},r.default.createElement("div",{className:"modal__actions"},r.default.createElement(o.Button,{variant:"default",onClick:()=>a("selection")},t.refine.examples.actions.back)))))};var r=e("react"),o=e("pragmate-ui/components"),s=e("pragmate-ui/list"),i=e("../context"),l=e("./context")}}),P.set("./views/pathway/forms/ai-form",{hash:1544091719,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AIGenerationForm=function({}){const{texts:e,values:t}=(0,f.useModuleContext)(),{setView:a,notes:n,setNotes:r}=(0,p.useModalContext)(),o=(0,f.useModuleContext)().store,[s,i]=c.default.useState(!1),l={onChange:e=>{r(e.currentTarget.value)},onClick:async()=>{try{i(!0),await o.save({...t}),await o.generateModuleSuggestion({...t,notes:n})}catch(e){console.error(e)}finally{i(!1)}},setView:()=>a("examples"),onBack:()=>a("selection")};return c.default.createElement("div",{className:"modal__form"},c.default.createElement(u.Form,{onSubmit:l.onClick},c.default.createElement("header",null,c.default.createElement("h3",null,e.refine.activities.title)),c.default.createElement(v.TotalActivities,null),c.default.createElement(u.Textarea,{label:e.refine.textarea.label,name:"observations",value:n,floating:!0,onChange:l.onChange,placeholder:e.refine.textarea.placeholder})),c.default.createElement("footer",null,c.default.createElement(m.Button,{variant:"primary",bordered:!0,onClick:l.onBack},e.actions.back),c.default.createElement(m.Button,{variant:"primary",onClick:l.onClick},e.actions.generate)),c.default.createElement(d.ProcessContainer,{fetching:s}))};var c=e("react"),u=e("pragmate-ui/form"),d=e("@aimpact/ailearn-app/components/ui"),m=e("pragmate-ui/components"),f=e("../../context"),p=e("../context"),v=e("./total-activities")}}),P.set("./views/pathway/forms/decision-type",{hash:1447804562,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DecistionType=function({}){const{texts:e,store:t}=(0,d.useModuleContext)(),a=(0,m.useModalContext)().onClose,n=e.setup.generation,r=e.setup.actions,[o,s]=c.default.useState(),i=(0,m.useModalContext)().setView,l=e=>{e=e.currentTarget.value,s(e)};return c.default.createElement("div",{className:"modal__form"},c.default.createElement("header",null,c.default.createElement("h3",null,n.title),c.default.createElement("div",{className:"description__content"},c.default.createElement("span",null,n.subtitle))),c.default.createElement(f.RadioButton,{checked:"yes"===o,onChange:l,label:n.options.ai,value:"yes",name:"generationWay"}),c.default.createElement(f.RadioButton,{checked:"manually"===o,onChange:l,label:n.options.manually,value:"manually",name:"generationWay"}),c.default.createElement("footer",null,c.default.createElement(u.Button,{variant:"primary",bordered:!0,onClick:a},r.cancel),c.default.createElement(u.Button,{variant:"primary",disabled:!o,onClick:()=>{"yes"!==o||t.model.credits.total?i("yes"===o?"ai":"manual"):i("request")}},r.continue)))};var c=e("react"),u=e("pragmate-ui/components"),d=e("../../context"),m=e("../context"),f=e("@aimpact/ailearn-app/components/ui")}}),P.set("./views/pathway/forms/manual",{hash:3962229241,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ManualForm=function({}){let{texts:e,store:t,values:a,setValues:n}=(0,p.useModuleContext)();const r=e.setup.generation,o=t.globalTexts.actions,s=(0,v.useModalContext)().setView,[,i]=m.default.useState(!1),[l,c]=(e=e.pathway,m.default.useState({title:"",description:""})),u=async()=>{try{i(!0),n({...a,title:l.title,description:l.description}),await t.save({...a,title:l.title,description:l.description,state:"confirmed"})}catch(e){console.error(e)}finally{i(!1)}},d=e=>{var{value:e,name:t}=e.currentTarget;c({...l,[t]:e})};return m.default.createElement("div",{className:"modal__form"},m.default.createElement("header",null,m.default.createElement("h3",null,r.title),m.default.createElement("div",{className:"description__content"},m.default.createElement("span",null,r.subtitle))),m.default.createElement(g.Form,{onSubmit:u},m.default.createElement(g.Input,{label:e.manual.title.label,onChange:d,value:l.title??"",name:"title"}),m.default.createElement(g.Textarea,{label:e.manual.description.label,name:"description",variant:"floating",onChange:d,value:l.description??""}),m.default.createElement("footer",null,m.default.createElement(f.Button,{variant:"primary",bordered:!0,onClick:()=>s("selection")},o.back),m.default.createElement(f.Button,{variant:"primary",disabled:!l.description||!l.title,onClick:u},o.continue))))};var m=e("react"),f=e("pragmate-ui/components"),p=e("../../context"),v=e("../context"),g=e("pragmate-ui/form")}}),P.set("./views/pathway/forms/total-activities",{hash:2956698225,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.TotalActivities=function(){let{texts:e,values:t,setValues:n}=(0,s.useModuleContext)();e=e.pathway.ai,console.log(.2,e);const r=[{value:15,label:e.form.size.items.brief,totalActivities:3},{value:45,label:e.form.size.items.standard,totalActivities:5},{value:60,label:e.form.size.items.extended,totalActivities:7}];return t?.audienceIndex&&parseInt(t.duration),t?.duration?.index&&parseInt(t.duration.index),t.duration&&r.find(e=>e.value===t.duration),a.default.createElement("div",null,a.default.createElement("label",{htmlFor:""},e.form.size.placeholder),a.default.createElement(o.ReactSelect,{placeholder:e.form.size.placeholder,onChange:t=>{const a=r.find(e=>e.value===parseInt(t.target.value));n(e=>({...e,duration:t.target.value,totalActivities:a.totalActivities}))},name:"duration",value:t.duration,options:r}))};var a=e("react"),o=e("pragmate-ui/form/react-select"),s=e("../../context")}}),P.set("./views/pathway/index",{hash:3635279439,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PathwayGeneration=function({show:e,onClose:t}){const{texts:a,store:n,improvements:r}=(0,g.useModuleContext)(),[o,,]=f.default.useState(!1),[s,i]=f.default.useState(""),[l,c]=f.default.useState(),[u,d]=f.default.useState("");var m;return e?(m=(m={confirm:E.ConfirmationForm,selection:C.DecistionType,ai:j.AIGenerationForm,manual:w.ManualForm,examples:y.SuggestionExamples,request:_.RequestCreditsContainer})[r&&!l?"confirm":l||"selection"],f.default.createElement(p.Modal,{className:"module-setup__modal",show:!0,onClose:()=>{i(""),c(void 0),t()},closeBackdrop:!(e=async()=>{try{(await n.model.saveDraft({state:"confirmed"})).status?t():d("default")}catch(e){d("default")}})},f.default.createElement(x.ErrorRenderer,{error:u,texts:a.refine.errors}),f.default.createElement(b.ModalContext.Provider,{value:{view:l,onClose:()=>{i(""),c(void 0),t()},setView:c,notes:s,setNotes:i}},f.default.createElement(h.AnimatePresence,null,f.default.createElement(m,{onSave:e,key:"control"}),f.default.createElement(v.ProcessContainer,{key:"container",fetching:o}))))):null};var f=e("react"),p=e("pragmate-ui/modal"),v=e("@aimpact/ailearn-app/components/ui"),g=e("../context"),h=e("framer-motion"),b=e("./context"),y=e("./examples"),x=e("../components/alert"),E=e("./confirmation"),C=e("./forms/decision-type"),w=e("./forms/manual"),j=e("./forms/ai-form"),_=e("./request-credits")}}),P.set("./views/pathway/request-credits",{hash:499826368,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.RequestCreditsContainer=function(){const{onClose:e,setView:t}=(0,s.useModalContext)(),a=(0,i.useModuleContext)().store,n={...a.globalTexts};return n.actions.cancel=a.globalTexts.actions.back,r.default.createElement(r.default.Fragment,null,r.default.createElement(o.RequestCreditsForm,{onConsume:a.model.consumeCoins,globalTexts:n,owner:a.model.owner,onClose:e,onCancel:()=>t("selection"),onSuccess:()=>t("ai")}))};var r=e("react"),o=e("@aimpact/ailearn-app/components/ui"),s=e("./context"),i=e("../context")}}),O.exports.descriptor=[{im:"./controller",from:"Controller",name:"Controller"},{im:"./views/components/ai-button",from:"AIButton",name:"AIButton"},{im:"./views/components/ai-button",from:"AIIconButton",name:"AIIconButton"},{im:"./views/form/confirmation-modal",from:"ConfirmationModal",name:"ConfirmationModal"},{im:"./views/form/container",from:"DraftContainer",name:"DraftContainer"},{im:"./views/form/fields/supporting-text",from:"SupportingText",name:"SupportingText"},{im:"./views/form/image",from:"OwnerImage",name:"OwnerImage"},{im:"./views/index",from:"View",name:"View"}],O.exports.process=function({require:e,prop:t,value:a}){!e&&"Controller"!==t||n("Controller",e?e("./controller").Controller:a),!e&&"AIButton"!==t||n("AIButton",e?e("./views/components/ai-button").AIButton:a),!e&&"AIIconButton"!==t||n("AIIconButton",e?e("./views/components/ai-button").AIIconButton:a),!e&&"ConfirmationModal"!==t||n("ConfirmationModal",e?e("./views/form/confirmation-modal").ConfirmationModal:a),!e&&"DraftContainer"!==t||n("DraftContainer",e?e("./views/form/container").DraftContainer:a),!e&&"SupportingText"!==t||n("SupportingText",e?e("./views/form/fields/supporting-text").SupportingText:a),!e&&"OwnerImage"!==t||n("OwnerImage",e?e("./views/form/image").OwnerImage:a),!e&&"View"!==t||n("View",e?e("./views/index").View:a)},n("__beyond_pkg",O),n("hmr",new function(){this.on=(e,t)=>O.hmr.on(e,t),this.off=(e,t)=>O.hmr.off(e,t)}),O.initialise(P)}}});