System.register(["@beyond-js/widgets@1.1.0/render","@beyond-js/kernel@0.1.9/bundle","@beyond-js/kernel@0.1.9/styles","@beyond-js/react-18-widgets@1.1.2/base","@aimpact/ailearn-sdk@1.0.0/learning-modules","@beyond-js/reactive@1.1.12/model","@aimpact/chat-sdk@1.0.0/session","@aimpact/ailearn-app@0.0.32/coins-layout.widget","@beyond-js/kernel@0.1.9/texts","@beyond-js/kernel@0.1.9/routing","react@18.2.0","pragmate-ui@0.1.1/empty","pragmate-ui@0.1.1/components","pragmate-ui@0.1.1/list","pragmate-ui@0.1.1/form","framer-motion@10.18.0","pragmate-ui@0.1.1/modal","pragmate-ui@0.1.1/icons","@aimpact/ailearn-app@0.0.32/components/icons","pragmate-ui@0.1.1/collapsible","pragmate-ui@0.1.1/toast","pragmate-ui@0.1.1/chips","@aimpact/ailearn-app@0.0.32/components/ui","@aimpact/ailearn-app@0.0.32/config","@aimpact/ailearn-app@0.0.32/modules/management/activity.code","pragmate-ui@0.1.1/alert","@beyond-js/react-18-widgets@1.1.2/hooks","@aimpact/ailearn-app@0.0.32/components/cover-image.code","@aimpact/chat@1.0.1/shared/hooks"],function(i,e){"use strict";var t,a,n,o,l,r,s,c,u,d,m,p,v,f,y,g,h,b,E,w,x,C,M,_,A,k,j,S,B,I,N;return i({Controller:void 0,ActivityView:void 0,AIButton:void 0,AIIconButton:void 0,View:void 0,Header:void 0,ModuleView:void 0}),{setters:[function(e){t=e},function(e){a=e},function(e){n=e},function(e){o=e},function(e){l=e},function(e){r=e},function(e){s=e},function(e){c=e},function(e){u=e},function(e){d=e},function(e){m=e},function(e){p=e},function(e){v=e},function(e){f=e},function(e){y=e},function(e){g=e},function(e){h=e},function(e){b=e},function(e){E=e},function(e){w=e},function(e){x=e},function(e){C=e},function(e){M=e},function(e){_=e},function(e){A=e},function(e){k=e},function(e){j=e},function(e){S=e},function(e){B=e}],execute:function(){N=a.Bundle,(I=new N({module:{vspecifier:"@aimpact/ailearn-app@0.0.32/modules/management/settings",multibundle:!0},type:"widget"},e.meta.url).package()).dependencies.update([["@beyond-js/widgets/render",t],["@beyond-js/kernel/styles",n],["@beyond-js/react-18-widgets/base",o],["@aimpact/ailearn-sdk/learning-modules",l],["@beyond-js/reactive/model",r],["@aimpact/chat-sdk/session",s],["@aimpact/ailearn-app/coins-layout.widget",c],["@beyond-js/kernel/texts",u],["@beyond-js/kernel/routing",d],["react",m],["pragmate-ui/empty",p],["pragmate-ui/components",v],["pragmate-ui/list",f],["pragmate-ui/form",y],["framer-motion",g],["pragmate-ui/modal",h],["pragmate-ui/icons",b],["@aimpact/ailearn-app/components/icons",E],["pragmate-ui/collapsible",w],["pragmate-ui/toast",x],["pragmate-ui/chips",C],["@aimpact/ailearn-app/components/ui",M],["@aimpact/ailearn-app/config",_],["@aimpact/ailearn-app/modules/management/activity.code",A],["pragmate-ui/alert",k],["@beyond-js/react-18-widgets/hooks",j],["@aimpact/ailearn-app/components/cover-image.code",S],["@aimpact/chat/shared/hooks",B]]),brequire("@beyond-js/widgets/render").widgets.register([{name:"app-modules-management",attrs:["id","activityId"],vspecifier:"@aimpact/ailearn-app@0.0.32/modules/management/settings.widget"}]),brequire("@beyond-js/kernel/styles").styles.register("@aimpact/ailearn-app@0.0.32/modules/management/settings.widget"),(N=new Map).set("./controller",{hash:1180616141,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Controller=void 0;var a=e("@beyond-js/react-18-widgets/base"),i=e("./store"),n=e("./views");class o extends a.ReactWidgetController{#store;createStore(){return this.#store=new i.StoreManager(this.attributes),this.#store}get Widget(){return n.View}}t.Controller=o}}),N.set("./store",{hash:942114041,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.StoreManager=void 0;var i=e("@aimpact/ailearn-sdk/learning-modules"),a=e("@beyond-js/reactive/model"),n=e("@aimpact/chat-sdk/session"),o=e("beyond_context"),l=e("@aimpact/ailearn-app/coins-layout.widget"),r=e("@beyond-js/kernel/texts"),s=e("@beyond-js/kernel/routing");class c extends a.ReactiveModel{#model;get model(){return this.#model}get user(){return n.sessionWrapper.user}get values(){return this.saved?this.model.getProperties():this.defaultValues}get ownerships(){return n.sessionWrapper.user.schools?.items??[]}get activityTypes(){return i.ActivityTypes}#texts=new r.CurrentTexts(o.module.specifier);get texts(){return this.#texts?.value}get ready(){return super.ready&&this.#texts.ready}#editActivity;get editActivity(){return this.#editActivity}set editActivity(e){this.#editActivity=e,this.trigger("activity.selected")}get view(){return this.#editActivity?"activity":"module"}constructor(e){super();var t=e.get("id"),e=e.get("activityId");if(this.#texts.on("change",this.triggerEvent),s.routing.on("change",()=>{"/modules/management"===s.routing.uri.pathname&&(s.routing.uri.qs.get("activityId")||(this.editActivity=void 0),s.routing.uri.qs.get("id"))&&this.setBreadcrumb()}),!t)throw new Error("No id provided");this.load(t,e)}clean(){this.#model.activities.clean(),this.#model=void 0,super.ready=!1}validateView(e){}async load(e,t){try{var a="new"===e?{type:"draft"}:{id:e,type:"draft"};"new"===e&&this.#model&&this.clean(),this.model&&this.model.id===e||(this.#model=await i.LearningModule.get(a),super.ready=!0,t&&this.setBreadcrumb(),this.#texts.on("change",this.setBreadcrumb.bind(this)))}catch(e){console.error(e)}}setBreadcrumb(){var e,t;this.#texts.ready&&(e=[[this.texts.breadcrumb.modules,"/modules/list"]],t=this.#editActivity?.title??this.texts.breadcrumb.management,this.#editActivity&&e.push([this.model.title,"/modules/management?id="+this.model.id]),e.push([t]),l.LayoutBroker.breadcrumb=e)}async deleteActivity(e){this.#model.activities.remove(e),await this.#model.saveDraft(),this.trigger("change")}async save(e){return this.fetching=!0,await this.model.saveDraft(e),this.fetching=!1,this.#model}async createActivity(e,t){try{return await this.model.activities.add(e.id,t)}catch(e){console.error(e)}}async publish(){this.fetching=!0;var e=await this.model.publish();return this.fetching=!1,e}}t.StoreManager=c}}),N.set("./views/activities/empty",{hash:4094756849,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyActivityList=function(){const e=(0,s.useModuleContext)().texts,[t,a]=n.default.useState(!1),i=()=>{a(!t)};return n.default.createElement("div",{className:"module-activities__list"},n.default.createElement("header",{className:"module__activity-list__header"},n.default.createElement("h2",null,e.module.activities.title),n.default.createElement("div",null,n.default.createElement(l.Button,{variant:"link",icon:"add",onClick:i},e.module.actions.addActivity))),n.default.createElement(o.Empty,null,n.default.createElement("h4",null,e.module.activities.empty.title),n.default.createElement("span",null,e.module.activities.empty.text)),n.default.createElement(r.ModalSelection,{show:t,onClose:i}))};var n=e("react"),o=e("pragmate-ui/empty"),l=e("pragmate-ui/components"),r=e("./list/selection/modal"),s=e("../context")}}),N.set("./views/activities/index",{hash:2010269373,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleActivities=function(){const{texts:e,activities:t,onSubmit:a,store:i}=(0,p.useModuleContext)(),[n,o]=u.default.useState(!1),[l,r]=u.default.useState(t),[,s]=u.default.useState(null),c=()=>o(e=>!e);return t.length?u.default.createElement(u.default.Fragment,null,u.default.createElement("header",{className:"module__activity-list__header"},u.default.createElement("h2",null,e.activities.title),u.default.createElement(m.Button,{variant:"link",icon:"add",onClick:c},e.actions.add)),u.default.createElement(f.Form,{onSubmit:a},u.default.createElement(h.Reorder.Group,{as:"div",values:l,onReorder:e=>{s(!0),r(e),i.model.activities.reorder(e)}},u.default.createElement(d.List,{className:"module-activity-list",specs:r,items:l,control:v.ModuleActivity}))),u.default.createElement(y.ModalSelection,{show:n,onClose:c})):u.default.createElement(g.EmptyActivityList,null)};var u=e("react"),d=e("pragmate-ui/list"),m=e("pragmate-ui/components"),p=e("../context"),v=e("./list/item"),f=e("pragmate-ui/form"),y=e("./list/selection/modal"),g=e("./empty"),h=e("framer-motion")}}),N.set("./views/activities/list/item/delete-modal",{hash:3159365712,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DeleteModal=function({onClose:e,onConfirm:t}){const{texts:a,texts:{actions:i}}=(0,r.useModuleContext)(),[,n]=l.default.useState(!1);return l.default.createElement(o.ConfirmModal,{onConfirm:async()=>{try{n(!0),await t(),n(!1)}catch(e){console.error(e)}finally{e()}},centered:!0,onCancel:e,actions:{confirm:{variant:"primary",label:i.confirm},cancel:{label:i.cancel,variant:"primary",bordered:!0}},show:!0,title:a.activities.delete.title,text:a.activities.delete.subtitle})};var o=e("pragmate-ui/modal"),l=e("react"),r=e("../../../context")}}),N.set("./views/activities/list/item/header",{hash:3125955121,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ActivityListHeader=function({openDeleteModal:t,activity:a}){const{texts:{actions:e,activities:i},store:n}=(0,s.useModuleContext)(),o="activity-type__image image--"+a.type,l="activity__state state--"+a.state;return r.default.createElement(d.CollapsibleHeader,null,r.default.createElement("header",{className:"flex-container flex-space-between flex-vertical-center"},r.default.createElement("div",{className:"flex-container flex-05 flex-center "},r.default.createElement(c.Icon,{icon:"drag",className:"drag-bullet-point"}),r.default.createElement("section",{className:o},r.default.createElement(u.AppIcon,{icon:u.ICONS[a.type]})),r.default.createElement("div",{className:"activity__data-container flex-container flex-space-between"},r.default.createElement("section",{className:"activity__name"},r.default.createElement("span",{className:"activity__type"},i.types[a.type]),r.default.createElement("h6",null,a.title)))),r.default.createElement("div",{className:"activity-details flex-container flex-vertical-center"},r.default.createElement("div",{className:l},i.states[a.state]),r.default.createElement(c.IconButton,{title:e.edit,icon:"edit",className:"circle",onClick:e=>{e.stopPropagation(),e=n.model.activities.items.find(e=>e.id===a.id),n.editActivity=e,n.model.id,n.setBreadcrumb(),m.routing.pushState(`/modules/management?id=${n.model.id}&activityId=`+a.id)}}),r.default.createElement(c.IconButton,{title:e.delete,icon:"delete",className:"circle",onClick:e=>{e.stopPropagation(),t()}}))))};var r=e("react"),s=e("../../../context"),c=e("pragmate-ui/icons"),u=e("@aimpact/ailearn-app/components/icons"),d=e("pragmate-ui/collapsible"),m=e("@beyond-js/kernel/routing")}}),N.set("./views/activities/list/item/index",{hash:2445005110,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleActivity=function({item:t}){const{texts:{activities:e},store:a}=(0,d.useModuleContext)(),i=(0,c.useRef)(null),[n,o]=c.default.useState(!1),[l,r]=c.default.useState(!1),s=()=>r(!l);return c.default.createElement(g.Reorder.Item,{value:t,className:"activity__item",onDragStart:()=>{o(!0)},onDragEnd:()=>{o(!1)},as:"div"},c.default.createElement(m.CollapsibleContainer,{onToggle:()=>!n},c.default.createElement("article",{className:"activity-item",ref:i},c.default.createElement(p.ActivityListHeader,{openDeleteModal:s,activity:t}),c.default.createElement(m.CollapsibleContent,{className:"activity__pane-content"},c.default.createElement(y.Property,{name:e.objective,value:t.specs.objective}),c.default.createElement(y.Property,{name:e.description,value:t.description}),c.default.createElement(u.ActivitySpecs,{type:t.type,specs:t.specs}))),l&&c.default.createElement(f.DeleteModal,{onConfirm:e=>{try{i.current.classList.add("fade-out"),a.deleteActivity(t.id)}catch(e){console.error(e),v.toast.error(e.message)}},onClose:s})))};var c=e("react"),u=e("./specs"),d=e("../../../context"),m=e("pragmate-ui/collapsible"),p=e("./header"),v=e("pragmate-ui/toast"),f=e("./delete-modal"),y=e("./property"),g=e("framer-motion")}}),N.set("./views/activities/list/item/property",{hash:2437299253,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Property=function({name:e,value:t}){return t?a.default.createElement("div",null,a.default.createElement("h6",null,e),a.default.createElement("span",null,t)):null};var a=e("react")}}),N.set("./views/activities/list/item/specs/index",{hash:1502866493,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ActivitySpecs=function({specs:e,type:t}){return a.default.createElement(a.default.Fragment,null,e.kind&&a.default.createElement(i.Chip,{type:"primary"},e.kind),a.default.createElement(n.SpecsList,{specs:e,type:t}))};var a=e("react"),i=e("pragmate-ui/chips"),n=e("./list")}}),N.set("./views/activities/list/item/specs/list",{hash:3707831496,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SpecsList=function({type:e,specs:t}){var a,i=(0,r.useModuleContext)().texts.activities,n={"content-theory":["topics",s],"multiple-choice":["questions",c],spoken:["criterias",s]};return!n[e]||([n,a]=n[e],!(e="content-theory"===e&&t.hasOwnProperty("keyConcepts")?t.keyConcepts:t[n]))||Array.isArray(e)&&!e.length?null:o.default.createElement(o.default.Fragment,null,o.default.createElement("h6",null,i[n]),o.default.createElement(l.List,{className:"questions-list",items:e,control:a}))};var o=e("react"),l=e("pragmate-ui/list"),r=e("../../../../context");const s=({data:e})=>o.default.createElement("li",null,e),c=({data:e})=>(e=e.question,o.default.createElement("li",null,e))}}),N.set("./views/activities/list/selection/context",{hash:357112821,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.useCreateActivityContext=t.CreateActivityContext=void 0;var a=e("react");const i=t.CreateActivityContext=a.default.createContext({});t.useCreateActivityContext=()=>a.default.useContext(i)}}),N.set("./views/activities/list/selection/item",{hash:2049796178,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionActivityItem=void 0;var l=e("react"),r=e("../../../context"),s=e("@aimpact/ailearn-app/components/icons"),c=e("pragmate-ui/icons");t.SelectionActivityItem=({item:t,specs:{selected:e,setSelected:a}})=>{var i=(0,r.useModuleContext)().texts,e="activity__selection-item activity--"+(n=t.id.replace("/","-"))+(t.id===e?.id?" selected":""),n=s.ICONS[n],o="activity-type__image image--"+t.id;return l.default.createElement("li",{className:e,onClick:e=>{a(t)}},l.default.createElement("div",{className:o},l.default.createElement(c.Icon,{icon:n})),l.default.createElement("div",null,l.default.createElement("h6",null,i.activities.types[t.id]),l.default.createElement("span",null,i.activities.descriptionTypes[t.id])))}}}),N.set("./views/activities/list/selection/list",{hash:3220690026,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ModalActivityList=function({}){const{store:e,texts:t}=(0,s.useModuleContext)(),[a,i]=r.default.useState(null),{setView:n,navigate:o,createActivity:l}=(0,m.useCreateActivityContext)();return r.default.createElement("div",null,r.default.createElement("h3",null,t.activities.createModal.title),r.default.createElement(c.List,{className:"module-activity-list",specs:{selected:a,setSelected:i},items:e.model.activities.types,control:d.SelectionActivityItem}),r.default.createElement("footer",{className:"flex-container flex-end mt-30"},r.default.createElement(p.Button,{variant:"primary",bordered:!0,onClick:async()=>{var e=await l(a,!0);o(e)},disabled:!a},t.actions.manual),r.default.createElement(u.AIButton,{variant:"primary",onClick:async()=>{await l(a),n("ai")},disabled:!a},t.actions.generate)))};var r=e("react"),s=e("../../../context"),c=e("pragmate-ui/list"),u=e("../../../components/ai-button"),d=e("./item"),m=e("./context"),p=e("pragmate-ui/components")}}),N.set("./views/activities/list/selection/modal",{hash:253379527,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ModalSelection=function({show:e,onClose:i}){const{store:n,texts:o}=(0,m.useModuleContext)(),[t,a]=d.default.useState(null),[l,r]=d.default.useState("list");var s,c;return e?(e=async(e,t=!1)=>(e=await n.createActivity(e,t),a(e),e),s=()=>{r("list"),i()},c={list:y.ModalActivityList,ai:h.ModalActivitySuggestions},n.model.valid?d.default.createElement(g.CreateActivityContext.Provider,{value:{onClose:i,activity:t,createActivity:e,setActivity:a,navigate:e=>{e||console.error("Activity not found"),n.editActivity=e;var t="/modules/management?id="+n.model.id,a=o.activities.types[e.type];p.LayoutBroker.addMultipleBreadcrumb([[a,e.id]]),f.routing.pushState(t+"&activityId="+e.id),i()},setView:r}},d.default.createElement(u.Modal,{show:!0,onClose:s},d.default.createElement(c=c[l],null))):d.default.createElement(v.ModalValidation,{onClose:s})):null};var u=e("pragmate-ui/modal"),d=e("react"),m=e("../../../context"),p=e("@aimpact/ailearn-app/coins-layout.widget"),v=e("./validation"),f=e("@beyond-js/kernel/routing"),y=e("./list"),g=e("./context"),h=e("./suggestions")}}),N.set("./views/activities/list/selection/suggestions",{hash:688686659,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ModalActivitySuggestions=function(){const e=(0,m.useModuleContext)().texts,{activity:t,navigate:a}=(0,p.useCreateActivityContext)(),[i,n]=s.default.useState(!1),[o,l]=s.default.useState(""),r={onChange:e=>{l(e.currentTarget.value)},onClick:async e=>{try{n(!0),await t.generate(o),a(t)}catch(e){}finally{setTimeout(()=>{n(!1)},2e3)}}};return s.default.createElement(s.default.Fragment,null,s.default.createElement(c.Form,null,s.default.createElement("header",null,s.default.createElement("h3",null,e.refine.title),s.default.createElement("p",null,e.refine.description),s.default.createElement("p",null,e.refine.description2)),s.default.createElement(c.Textarea,{label:e.refine.textarea.label,name:"observations",value:o,onChange:r.onChange,placeholder:e.refine.textarea.placeholder})),s.default.createElement("footer",{className:"flex-container flex-end mt-15"},s.default.createElement(d.Button,{variant:"primary",onClick:r.onClick},e.actions.generate)),s.default.createElement(u.ProcessContainer,{fetching:i},s.default.createElement(u.RotatingMessage,{time:"8000",content:e.refiningActivity})))};var s=e("react"),c=e("pragmate-ui/form"),u=e("@aimpact/ailearn-app/components/ui"),d=e("pragmate-ui/components"),m=e("../../../context"),p=e("./context")}}),N.set("./views/activities/list/selection/validation",{hash:4222962394,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ModalValidation=function({onClose:e}){var t=(0,n.useModuleContext)().texts;return i.default.createElement(a.AlertModal,{show:!0,onClose:e},i.default.createElement("div",null,i.default.createElement("h3",null,t.activities.createModal.validationTitle),i.default.createElement("p",null,t.activities.createModal.validation)))};var a=e("pragmate-ui/modal"),i=e("react"),n=e("../../../context")}}),N.set("./views/activity",{hash:3256072358,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ActivityView=function({store:e}){return a.createElement(i.ModuleActivityForm,{store:e,activity:e.editActivity})};var a=e("react"),i=e("@aimpact/ailearn-app/modules/management/activity.code")}}),N.set("./views/components/ai-button",{hash:3669703153,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AIButton=function({children:e,onClick:t,...a}){return i.default.createElement(o.Button,{...a,icon:n.ICONS.aiStars,onClick:()=>r.LayoutBroker.ensureCredits(t)},e)},t.AIIconButton=function({children:e,onClick:t,...a}){return i.default.createElement(l.IconButton,{...a,icon:n.ICONS.aiStars,onClick:()=>r.LayoutBroker.ensureCredits(t)},e)};var i=e("react"),n=e("@aimpact/ailearn-app/components/icons"),o=e("pragmate-ui/components"),l=e("pragmate-ui/icons"),r=e("@aimpact/ailearn-app/coins-layout.widget")}}),N.set("./views/components/error",{hash:3301282445,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorRenderer=function({texts:e,error:t}){return a.default.createElement(i.Alert,{variant:"error"},e[t])};var a=e("react"),i=e("pragmate-ui/alert")}}),N.set("./views/context",{hash:1926894984,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.useModuleContext=t.ModuleContext=void 0;var a=e("react");const i=t.ModuleContext=a.default.createContext({});t.useModuleContext=()=>a.default.useContext(i)}}),N.set("./views/index",{hash:2355559764,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.View=function(e){const t=e.store,a=t.texts,[i,n]=r.useState(t.ready),[o,l]=r.useState(t.view);return(0,u.useBinder)([t],()=>{t.ready!==i&&n(t.ready),l(t.view)}),(0,u.useBinder)([t],()=>l(t.view),"activity.selected"),t.ready?"activity"!==o?r.createElement(s.ModuleView,{...e}):r.createElement(d.ActivityView,{...e,texts:a}):r.createElement(c.Spinner,{active:!0})};var r=e("react"),s=e("./module"),c=e("pragmate-ui/components"),u=e("@beyond-js/react-18-widgets/hooks"),d=e("./activity")}}),N.set("./views/module/content-editable",{hash:3809760213,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ContentEditable=void 0;var d=e("react"),m=e("pragmate-ui/icons");t.ContentEditable=({onSave:e,selector:t="div",className:a,children:i,name:n})=>{const[o,l]=(0,d.useState)(!1);var[i,,]=(0,d.useState)("string"==typeof i?i:"");const r=d.default.useRef(null),s=()=>{l(!o),setTimeout(()=>{var e,t,a=r.current;a&&(e=document.createRange(),t=globalThis.getSelection(),e.selectNodeContents(a),e.collapse(!1),t?.removeAllRanges(),t?.addRange(e),a.focus())},0)};var c=o?"save":"edit",u=o?"pui-editable-selector":"";return d.default.createElement("div",{className:"pui-content-editable"+(a?" "+a:"")},d.default.createElement(t,{ref:r,className:u,contentEditable:o,suppressContentEditableWarning:!0},i),d.default.createElement("div",{className:"pui-content-editable__actions"},o&&d.default.createElement(m.IconButton,{icon:"backArrow",onClick:s}),d.default.createElement(m.IconButton,{icon:c,onClick:async()=>{await e({[n]:r.current?.textContent}),s()}})))}}}),N.set("./views/module/description",{hash:273308871,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleDescription=function({}){const{texts:{module:e},store:t}=(0,n.useModuleContext)(),a=t.model.description??e.description;return i.default.createElement("div",{className:"module-property"},i.default.createElement("h5",null,e.description),i.default.createElement(o.ContentEditable,{name:"description",onSave:async({target:e})=>{t.save({[e.name]:e.value})},selector:"p"},a))};var i=e("react"),n=e("../context"),o=e("@aimpact/ailearn-app/components/ui")}}),N.set("./views/module/header",{hash:2642704310,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Header=function(){const{texts:e,store:t,texts:{module:a},ensureCredits:i}=(0,c.useModuleContext)(),n=t.model.title??a.title,[o,l]=s.default.useState(t.model.picture);return(0,m.useBinder)([t.model],()=>l(t.model.picture),"image.generated"),s.default.createElement("section",null,s.default.createElement("header",{className:"header-module__container flex-container flex-space-between"},s.default.createElement("section",{className:"header-container module-header-description "},s.default.createElement(d.CoverImage,{title:e.picture.title,description:e.picture.description,suggestions:t.model.pictureSuggestions,picture:o,onGenerate:e=>i(e=>t.model.generatePicture(e),e)}),s.default.createElement("div",null,s.default.createElement(r.ContentEditable,{name:"title",as:"h3",onSave:e=>{p.LayoutBroker.trimBreadcrumb(1),p.LayoutBroker.addBreadcrumb([e.target.value,""]),t.save({title:e.target.value})}},n),s.default.createElement("div",{className:"module__owner"},s.default.createElement("strong",null,e.module.owner,": "),t.model.owner?.name)),s.default.createElement(u.PublishModule,null))))};var r=e("@aimpact/ailearn-app/components/ui"),s=e("react"),c=e("../context"),u=e("./publish"),d=e("@aimpact/ailearn-app/components/cover-image.code"),m=e("@beyond-js/react-18-widgets/hooks"),p=e("@aimpact/ailearn-app/coins-layout.widget")}}),N.set("./views/module/index",{hash:4210474825,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleView=function(e){const t=e.store,[a,i]=(0,y.useTexts)(g.module.specifier),[n,o]=d.useState(t.fetching),[l]=d.useState(0),[r,s]=d.useState(t.model?.activities?.items),[,c]=d.useState();var u;return(0,m.useBinder)([t.model],()=>o(t?.model?.fetching)),(0,m.useBinder)([t],()=>s(t.model?.activities?.items)),(0,m.useBinder)([t.model],()=>{s(t.model?.activities?.items)},"activities.generated"),(0,m.useBinder)([t],()=>c(t.editActivity),"activity.selected"),a&&t.ready?(e={store:t,fetching:n,texts:i,activePanel:l,activities:r,onSubmit:async e=>{e.preventDefault(),o(!0),await t.save(),globalThis.setTimeout(()=>{o(!1)},1e3)},ensureCredits:v.LayoutBroker.ensureCredits,totalActivities:t.model?.activities?.length},u=" "+(n?"is-fetching":""),d.createElement(f.ModuleContext.Provider,{value:e},d.createElement(h.Header,null),d.createElement(p.PageContainer,{className:u,fetching:n&&!!t.model?.activities.length},d.createElement(b.ModuleManagement,null)))):null};var d=e("react"),m=e("@beyond-js/react-18-widgets/hooks"),p=e("@aimpact/ailearn-app/components/ui"),v=e("@aimpact/ailearn-app/coins-layout.widget"),f=e("../context"),y=e("@aimpact/chat/shared/hooks"),g=e("beyond_context"),h=e("./header"),b=e("./management")}}),N.set("./views/module/management",{hash:476078848,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleManagement=function(){var{store:e,texts:{module:t}}=(0,n.useModuleContext)();return e.model.title??t.title,(0,o.useBinder)([e.model],()=>{},"activities.updated"),a.default.createElement("div",{className:"app-module-creation-page"},a.default.createElement("section",null,a.default.createElement("div",{className:"module-property"},a.default.createElement("h5",null,t.objective,":"),a.default.createElement("p",null," ",e.model.objective)),a.default.createElement(l.ModuleDescription,null)),a.default.createElement(i.ModuleActivities,null))};var a=e("react"),i=e("../activities"),n=e("../context"),o=e("@beyond-js/react-18-widgets/hooks"),l=e("./description")}}),N.set("./views/module/publish",{hash:457822517,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PublishModule=function(){const{store:e,texts:t}=(0,n.useModuleContext)(),a={disabled:"draft"!==e.model.type||!e.model.completed};return i.default.createElement("div",{className:"publish-action__container"},i.default.createElement(o.Button,{fetching:e.fetching,onClick:async()=>{try{(await e.publish()).status?(l.toast.success(t.toast.modulePublished),r.routing.pushState("/modules/list?tab=published")):s.LayoutBroker.showMessage("error",t.errors.CONTACT_ADMIN)}catch(e){console.log("error",e),l.toast.error(t.toast.errorPublishingModule)}},variant:"primary",...a},t.actions.publish))};var i=e("react"),n=e("../context"),o=e("pragmate-ui/components"),l=e("pragmate-ui/toast"),r=e("@beyond-js/kernel/routing"),s=e("@aimpact/ailearn-app/coins-layout.widget")}}),N.set("./views/module/title",{hash:879033848,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleTitle=function({}){const{texts:{module:e},store:t}=(0,n.useModuleContext)(),a=t.model.title??e.title;return i.default.createElement("div",{className:"module-property"},i.default.createElement("strong",null,e.title),i.default.createElement(o.ContentEditable,{name:"title",onSave:async e=>{await t.save(e)},selector:"p"},a))};var i=e("react"),n=e("../context"),o=e("./content-editable")}}),I.exports.descriptor=[{im:"./controller",from:"Controller",name:"Controller"},{im:"./views/activity",from:"ActivityView",name:"ActivityView"},{im:"./views/components/ai-button",from:"AIButton",name:"AIButton"},{im:"./views/components/ai-button",from:"AIIconButton",name:"AIIconButton"},{im:"./views/index",from:"View",name:"View"},{im:"./views/module/header",from:"Header",name:"Header"},{im:"./views/module/index",from:"ModuleView",name:"ModuleView"}],I.exports.process=function({require:e,prop:t,value:a}){!e&&"Controller"!==t||i("Controller",e?e("./controller").Controller:a),!e&&"ActivityView"!==t||i("ActivityView",e?e("./views/activity").ActivityView:a),!e&&"AIButton"!==t||i("AIButton",e?e("./views/components/ai-button").AIButton:a),!e&&"AIIconButton"!==t||i("AIIconButton",e?e("./views/components/ai-button").AIIconButton:a),!e&&"View"!==t||i("View",e?e("./views/index").View:a),!e&&"Header"!==t||i("Header",e?e("./views/module/header").Header:a),!e&&"ModuleView"!==t||i("ModuleView",e?e("./views/module/index").ModuleView:a)},i("__beyond_pkg",I),i("hmr",new function(){this.on=(e,t)=>I.hmr.on(e,t),this.off=(e,t)=>I.hmr.off(e,t)}),I.initialise(N)}}});System.register(["@beyond-js/widgets@1.1.0/render","@beyond-js/kernel@0.1.9/bundle","@beyond-js/kernel@0.1.9/styles","@beyond-js/react-18-widgets@1.1.2/base","@aimpact/ailearn-sdk@1.0.0/learning-modules","@beyond-js/reactive@1.1.12/model","@aimpact/chat-sdk@1.0.0/session","@aimpact/ailearn-app@0.0.32/coins-layout.widget","@beyond-js/kernel@0.1.9/texts","@beyond-js/kernel@0.1.9/routing","react@18.2.0","pragmate-ui@0.1.1/empty","pragmate-ui@0.1.1/components","pragmate-ui@0.1.1/list","pragmate-ui@0.1.1/form","framer-motion@10.18.0","pragmate-ui@0.1.1/modal","pragmate-ui@0.1.1/icons","@aimpact/ailearn-app@0.0.32/components/icons","pragmate-ui@0.1.1/collapsible","pragmate-ui@0.1.1/toast","pragmate-ui@0.1.1/chips","@aimpact/ailearn-app@0.0.32/components/ui","@aimpact/ailearn-app@0.0.32/config","@aimpact/ailearn-app@0.0.32/modules/management/activity.code","pragmate-ui@0.1.1/alert","@beyond-js/react-18-widgets@1.1.2/hooks","@aimpact/ailearn-app@0.0.32/components/cover-image.code","@aimpact/chat@1.0.1/shared/hooks"],function(i,e){"use strict";var t,a,n,o,l,r,s,c,u,d,m,p,v,f,y,g,h,b,E,w,x,C,M,_,A,k,j,S,B,I,N;return i({Controller:void 0,ActivityView:void 0,AIButton:void 0,AIIconButton:void 0,View:void 0,Header:void 0,ModuleView:void 0}),{setters:[function(e){t=e},function(e){a=e},function(e){n=e},function(e){o=e},function(e){l=e},function(e){r=e},function(e){s=e},function(e){c=e},function(e){u=e},function(e){d=e},function(e){m=e},function(e){p=e},function(e){v=e},function(e){f=e},function(e){y=e},function(e){g=e},function(e){h=e},function(e){b=e},function(e){E=e},function(e){w=e},function(e){x=e},function(e){C=e},function(e){M=e},function(e){_=e},function(e){A=e},function(e){k=e},function(e){j=e},function(e){S=e},function(e){B=e}],execute:function(){N=a.Bundle,(I=new N({module:{vspecifier:"@aimpact/ailearn-app@0.0.32/modules/management/settings",multibundle:!0},type:"widget"},e.meta.url).package()).dependencies.update([["@beyond-js/widgets/render",t],["@beyond-js/kernel/styles",n],["@beyond-js/react-18-widgets/base",o],["@aimpact/ailearn-sdk/learning-modules",l],["@beyond-js/reactive/model",r],["@aimpact/chat-sdk/session",s],["@aimpact/ailearn-app/coins-layout.widget",c],["@beyond-js/kernel/texts",u],["@beyond-js/kernel/routing",d],["react",m],["pragmate-ui/empty",p],["pragmate-ui/components",v],["pragmate-ui/list",f],["pragmate-ui/form",y],["framer-motion",g],["pragmate-ui/modal",h],["pragmate-ui/icons",b],["@aimpact/ailearn-app/components/icons",E],["pragmate-ui/collapsible",w],["pragmate-ui/toast",x],["pragmate-ui/chips",C],["@aimpact/ailearn-app/components/ui",M],["@aimpact/ailearn-app/config",_],["@aimpact/ailearn-app/modules/management/activity.code",A],["pragmate-ui/alert",k],["@beyond-js/react-18-widgets/hooks",j],["@aimpact/ailearn-app/components/cover-image.code",S],["@aimpact/chat/shared/hooks",B]]),brequire("@beyond-js/widgets/render").widgets.register([{name:"app-modules-management",attrs:["id","activityId"],vspecifier:"@aimpact/ailearn-app@0.0.32/modules/management/settings.widget"}]),brequire("@beyond-js/kernel/styles").styles.register("@aimpact/ailearn-app@0.0.32/modules/management/settings.widget"),(N=new Map).set("./controller",{hash:1180616141,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Controller=void 0;var a=e("@beyond-js/react-18-widgets/base"),i=e("./store"),n=e("./views");class o extends a.ReactWidgetController{#store;createStore(){return this.#store=new i.StoreManager(this.attributes),this.#store}get Widget(){return n.View}}t.Controller=o}}),N.set("./store",{hash:942114041,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.StoreManager=void 0;var i=e("@aimpact/ailearn-sdk/learning-modules"),a=e("@beyond-js/reactive/model"),n=e("@aimpact/chat-sdk/session"),o=e("beyond_context"),l=e("@aimpact/ailearn-app/coins-layout.widget"),r=e("@beyond-js/kernel/texts"),s=e("@beyond-js/kernel/routing");class c extends a.ReactiveModel{#model;get model(){return this.#model}get user(){return n.sessionWrapper.user}get values(){return this.saved?this.model.getProperties():this.defaultValues}get ownerships(){return n.sessionWrapper.user.schools?.items??[]}get activityTypes(){return i.ActivityTypes}#texts=new r.CurrentTexts(o.module.specifier);get texts(){return this.#texts?.value}get ready(){return super.ready&&this.#texts.ready}#editActivity;get editActivity(){return this.#editActivity}set editActivity(e){this.#editActivity=e,this.trigger("activity.selected")}get view(){return this.#editActivity?"activity":"module"}constructor(e){super();var t=e.get("id"),e=e.get("activityId");if(this.#texts.on("change",this.triggerEvent),s.routing.on("change",()=>{"/modules/management"===s.routing.uri.pathname&&(s.routing.uri.qs.get("activityId")||(this.editActivity=void 0),s.routing.uri.qs.get("id"))&&this.setBreadcrumb()}),!t)throw new Error("No id provided");this.load(t,e)}clean(){this.#model.activities.clean(),this.#model=void 0,super.ready=!1}validateView(e){}async load(e,t){try{var a="new"===e?{type:"draft"}:{id:e,type:"draft"};"new"===e&&this.#model&&this.clean(),this.model&&this.model.id===e||(this.#model=await i.LearningModule.get(a),super.ready=!0,t&&this.setBreadcrumb(),this.#texts.on("change",this.setBreadcrumb.bind(this)))}catch(e){console.error(e)}}setBreadcrumb(){var e,t;this.#texts.ready&&(e=[[this.texts.breadcrumb.modules,"/modules/list"]],t=this.#editActivity?.title??this.texts.breadcrumb.management,this.#editActivity&&e.push([this.model.title,"/modules/management?id="+this.model.id]),e.push([t]),l.LayoutBroker.breadcrumb=e)}async deleteActivity(e){this.#model.activities.remove(e),await this.#model.saveDraft(),this.trigger("change")}async save(e){return this.fetching=!0,await this.model.saveDraft(e),this.fetching=!1,this.#model}async createActivity(e,t){try{return await this.model.activities.add(e.id,t)}catch(e){console.error(e)}}async publish(){this.fetching=!0;var e=await this.model.publish();return this.fetching=!1,e}}t.StoreManager=c}}),N.set("./views/activities/empty",{hash:4094756849,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyActivityList=function(){const e=(0,s.useModuleContext)().texts,[t,a]=n.default.useState(!1),i=()=>{a(!t)};return n.default.createElement("div",{className:"module-activities__list"},n.default.createElement("header",{className:"module__activity-list__header"},n.default.createElement("h2",null,e.module.activities.title),n.default.createElement("div",null,n.default.createElement(l.Button,{variant:"link",icon:"add",onClick:i},e.module.actions.addActivity))),n.default.createElement(o.Empty,null,n.default.createElement("h4",null,e.module.activities.empty.title),n.default.createElement("span",null,e.module.activities.empty.text)),n.default.createElement(r.ModalSelection,{show:t,onClose:i}))};var n=e("react"),o=e("pragmate-ui/empty"),l=e("pragmate-ui/components"),r=e("./list/selection/modal"),s=e("../context")}}),N.set("./views/activities/index",{hash:2010269373,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleActivities=function(){const{texts:e,activities:t,onSubmit:a,store:i}=(0,p.useModuleContext)(),[n,o]=u.default.useState(!1),[l,r]=u.default.useState(t),[,s]=u.default.useState(null),c=()=>o(e=>!e);return t.length?u.default.createElement(u.default.Fragment,null,u.default.createElement("header",{className:"module__activity-list__header"},u.default.createElement("h2",null,e.activities.title),u.default.createElement(m.Button,{variant:"link",icon:"add",onClick:c},e.actions.add)),u.default.createElement(f.Form,{onSubmit:a},u.default.createElement(h.Reorder.Group,{as:"div",values:l,onReorder:e=>{s(!0),r(e),i.model.activities.reorder(e)}},u.default.createElement(d.List,{className:"module-activity-list",specs:r,items:l,control:v.ModuleActivity}))),u.default.createElement(y.ModalSelection,{show:n,onClose:c})):u.default.createElement(g.EmptyActivityList,null)};var u=e("react"),d=e("pragmate-ui/list"),m=e("pragmate-ui/components"),p=e("../context"),v=e("./list/item"),f=e("pragmate-ui/form"),y=e("./list/selection/modal"),g=e("./empty"),h=e("framer-motion")}}),N.set("./views/activities/list/item/delete-modal",{hash:3159365712,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DeleteModal=function({onClose:e,onConfirm:t}){const{texts:a,texts:{actions:i}}=(0,r.useModuleContext)(),[,n]=l.default.useState(!1);return l.default.createElement(o.ConfirmModal,{onConfirm:async()=>{try{n(!0),await t(),n(!1)}catch(e){console.error(e)}finally{e()}},centered:!0,onCancel:e,actions:{confirm:{variant:"primary",label:i.confirm},cancel:{label:i.cancel,variant:"primary",bordered:!0}},show:!0,title:a.activities.delete.title,text:a.activities.delete.subtitle})};var o=e("pragmate-ui/modal"),l=e("react"),r=e("../../../context")}}),N.set("./views/activities/list/item/header",{hash:3125955121,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ActivityListHeader=function({openDeleteModal:t,activity:a}){const{texts:{actions:e,activities:i},store:n}=(0,s.useModuleContext)(),o="activity-type__image image--"+a.type,l="activity__state state--"+a.state;return r.default.createElement(d.CollapsibleHeader,null,r.default.createElement("header",{className:"flex-container flex-space-between flex-vertical-center"},r.default.createElement("div",{className:"flex-container flex-05 flex-center "},r.default.createElement(c.Icon,{icon:"drag",className:"drag-bullet-point"}),r.default.createElement("section",{className:o},r.default.createElement(u.AppIcon,{icon:u.ICONS[a.type]})),r.default.createElement("div",{className:"activity__data-container flex-container flex-space-between"},r.default.createElement("section",{className:"activity__name"},r.default.createElement("span",{className:"activity__type"},i.types[a.type]),r.default.createElement("h6",null,a.title)))),r.default.createElement("div",{className:"activity-details flex-container flex-vertical-center"},r.default.createElement("div",{className:l},i.states[a.state]),r.default.createElement(c.IconButton,{title:e.edit,icon:"edit",className:"circle",onClick:e=>{e.stopPropagation(),e=n.model.activities.items.find(e=>e.id===a.id),n.editActivity=e,n.model.id,n.setBreadcrumb(),m.routing.pushState(`/modules/management?id=${n.model.id}&activityId=`+a.id)}}),r.default.createElement(c.IconButton,{title:e.delete,icon:"delete",className:"circle",onClick:e=>{e.stopPropagation(),t()}}))))};var r=e("react"),s=e("../../../context"),c=e("pragmate-ui/icons"),u=e("@aimpact/ailearn-app/components/icons"),d=e("pragmate-ui/collapsible"),m=e("@beyond-js/kernel/routing")}}),N.set("./views/activities/list/item/index",{hash:2445005110,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleActivity=function({item:t}){const{texts:{activities:e},store:a}=(0,d.useModuleContext)(),i=(0,c.useRef)(null),[n,o]=c.default.useState(!1),[l,r]=c.default.useState(!1),s=()=>r(!l);return c.default.createElement(g.Reorder.Item,{value:t,className:"activity__item",onDragStart:()=>{o(!0)},onDragEnd:()=>{o(!1)},as:"div"},c.default.createElement(m.CollapsibleContainer,{onToggle:()=>!n},c.default.createElement("article",{className:"activity-item",ref:i},c.default.createElement(p.ActivityListHeader,{openDeleteModal:s,activity:t}),c.default.createElement(m.CollapsibleContent,{className:"activity__pane-content"},c.default.createElement(y.Property,{name:e.objective,value:t.specs.objective}),c.default.createElement(y.Property,{name:e.description,value:t.description}),c.default.createElement(u.ActivitySpecs,{type:t.type,specs:t.specs}))),l&&c.default.createElement(f.DeleteModal,{onConfirm:e=>{try{i.current.classList.add("fade-out"),a.deleteActivity(t.id)}catch(e){console.error(e),v.toast.error(e.message)}},onClose:s})))};var c=e("react"),u=e("./specs"),d=e("../../../context"),m=e("pragmate-ui/collapsible"),p=e("./header"),v=e("pragmate-ui/toast"),f=e("./delete-modal"),y=e("./property"),g=e("framer-motion")}}),N.set("./views/activities/list/item/property",{hash:2437299253,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Property=function({name:e,value:t}){return t?a.default.createElement("div",null,a.default.createElement("h6",null,e),a.default.createElement("span",null,t)):null};var a=e("react")}}),N.set("./views/activities/list/item/specs/index",{hash:1502866493,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ActivitySpecs=function({specs:e,type:t}){return a.default.createElement(a.default.Fragment,null,e.kind&&a.default.createElement(i.Chip,{type:"primary"},e.kind),a.default.createElement(n.SpecsList,{specs:e,type:t}))};var a=e("react"),i=e("pragmate-ui/chips"),n=e("./list")}}),N.set("./views/activities/list/item/specs/list",{hash:3707831496,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SpecsList=function({type:e,specs:t}){var a,i=(0,r.useModuleContext)().texts.activities,n={"content-theory":["topics",s],"multiple-choice":["questions",c],spoken:["criterias",s]};return!n[e]||([n,a]=n[e],!(e="content-theory"===e&&t.hasOwnProperty("keyConcepts")?t.keyConcepts:t[n]))||Array.isArray(e)&&!e.length?null:o.default.createElement(o.default.Fragment,null,o.default.createElement("h6",null,i[n]),o.default.createElement(l.List,{className:"questions-list",items:e,control:a}))};var o=e("react"),l=e("pragmate-ui/list"),r=e("../../../../context");const s=({data:e})=>o.default.createElement("li",null,e),c=({data:e})=>(e=e.question,o.default.createElement("li",null,e))}}),N.set("./views/activities/list/selection/context",{hash:357112821,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.useCreateActivityContext=t.CreateActivityContext=void 0;var a=e("react");const i=t.CreateActivityContext=a.default.createContext({});t.useCreateActivityContext=()=>a.default.useContext(i)}}),N.set("./views/activities/list/selection/item",{hash:2049796178,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionActivityItem=void 0;var l=e("react"),r=e("../../../context"),s=e("@aimpact/ailearn-app/components/icons"),c=e("pragmate-ui/icons");t.SelectionActivityItem=({item:t,specs:{selected:e,setSelected:a}})=>{var i=(0,r.useModuleContext)().texts,e="activity__selection-item activity--"+(n=t.id.replace("/","-"))+(t.id===e?.id?" selected":""),n=s.ICONS[n],o="activity-type__image image--"+t.id;return l.default.createElement("li",{className:e,onClick:e=>{a(t)}},l.default.createElement("div",{className:o},l.default.createElement(c.Icon,{icon:n})),l.default.createElement("div",null,l.default.createElement("h6",null,i.activities.types[t.id]),l.default.createElement("span",null,i.activities.descriptionTypes[t.id])))}}}),N.set("./views/activities/list/selection/list",{hash:3220690026,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ModalActivityList=function({}){const{store:e,texts:t}=(0,s.useModuleContext)(),[a,i]=r.default.useState(null),{setView:n,navigate:o,createActivity:l}=(0,m.useCreateActivityContext)();return r.default.createElement("div",null,r.default.createElement("h3",null,t.activities.createModal.title),r.default.createElement(c.List,{className:"module-activity-list",specs:{selected:a,setSelected:i},items:e.model.activities.types,control:d.SelectionActivityItem}),r.default.createElement("footer",{className:"flex-container flex-end mt-30"},r.default.createElement(p.Button,{variant:"primary",bordered:!0,onClick:async()=>{var e=await l(a,!0);o(e)},disabled:!a},t.actions.manual),r.default.createElement(u.AIButton,{variant:"primary",onClick:async()=>{await l(a),n("ai")},disabled:!a},t.actions.generate)))};var r=e("react"),s=e("../../../context"),c=e("pragmate-ui/list"),u=e("../../../components/ai-button"),d=e("./item"),m=e("./context"),p=e("pragmate-ui/components")}}),N.set("./views/activities/list/selection/modal",{hash:253379527,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ModalSelection=function({show:e,onClose:i}){const{store:n,texts:o}=(0,m.useModuleContext)(),[t,a]=d.default.useState(null),[l,r]=d.default.useState("list");var s,c;return e?(e=async(e,t=!1)=>(e=await n.createActivity(e,t),a(e),e),s=()=>{r("list"),i()},c={list:y.ModalActivityList,ai:h.ModalActivitySuggestions},n.model.valid?d.default.createElement(g.CreateActivityContext.Provider,{value:{onClose:i,activity:t,createActivity:e,setActivity:a,navigate:e=>{e||console.error("Activity not found"),n.editActivity=e;var t="/modules/management?id="+n.model.id,a=o.activities.types[e.type];p.LayoutBroker.addMultipleBreadcrumb([[a,e.id]]),f.routing.pushState(t+"&activityId="+e.id),i()},setView:r}},d.default.createElement(u.Modal,{show:!0,onClose:s},d.default.createElement(c=c[l],null))):d.default.createElement(v.ModalValidation,{onClose:s})):null};var u=e("pragmate-ui/modal"),d=e("react"),m=e("../../../context"),p=e("@aimpact/ailearn-app/coins-layout.widget"),v=e("./validation"),f=e("@beyond-js/kernel/routing"),y=e("./list"),g=e("./context"),h=e("./suggestions")}}),N.set("./views/activities/list/selection/suggestions",{hash:688686659,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ModalActivitySuggestions=function(){const e=(0,m.useModuleContext)().texts,{activity:t,navigate:a}=(0,p.useCreateActivityContext)(),[i,n]=s.default.useState(!1),[o,l]=s.default.useState(""),r={onChange:e=>{l(e.currentTarget.value)},onClick:async e=>{try{n(!0),await t.generate(o),a(t)}catch(e){}finally{setTimeout(()=>{n(!1)},2e3)}}};return s.default.createElement(s.default.Fragment,null,s.default.createElement(c.Form,null,s.default.createElement("header",null,s.default.createElement("h3",null,e.refine.title),s.default.createElement("p",null,e.refine.description),s.default.createElement("p",null,e.refine.description2)),s.default.createElement(c.Textarea,{label:e.refine.textarea.label,name:"observations",value:o,onChange:r.onChange,placeholder:e.refine.textarea.placeholder})),s.default.createElement("footer",{className:"flex-container flex-end mt-15"},s.default.createElement(d.Button,{variant:"primary",onClick:r.onClick},e.actions.generate)),s.default.createElement(u.ProcessContainer,{fetching:i},s.default.createElement(u.RotatingMessage,{time:"8000",content:e.refiningActivity})))};var s=e("react"),c=e("pragmate-ui/form"),u=e("@aimpact/ailearn-app/components/ui"),d=e("pragmate-ui/components"),m=e("../../../context"),p=e("./context")}}),N.set("./views/activities/list/selection/validation",{hash:4222962394,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ModalValidation=function({onClose:e}){var t=(0,n.useModuleContext)().texts;return i.default.createElement(a.AlertModal,{show:!0,onClose:e},i.default.createElement("div",null,i.default.createElement("h3",null,t.activities.createModal.validationTitle),i.default.createElement("p",null,t.activities.createModal.validation)))};var a=e("pragmate-ui/modal"),i=e("react"),n=e("../../../context")}}),N.set("./views/activity",{hash:3256072358,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ActivityView=function({store:e}){return a.createElement(i.ModuleActivityForm,{store:e,activity:e.editActivity})};var a=e("react"),i=e("@aimpact/ailearn-app/modules/management/activity.code")}}),N.set("./views/components/ai-button",{hash:3669703153,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AIButton=function({children:e,onClick:t,...a}){return i.default.createElement(o.Button,{...a,icon:n.ICONS.aiStars,onClick:()=>r.LayoutBroker.ensureCredits(t)},e)},t.AIIconButton=function({children:e,onClick:t,...a}){return i.default.createElement(l.IconButton,{...a,icon:n.ICONS.aiStars,onClick:()=>r.LayoutBroker.ensureCredits(t)},e)};var i=e("react"),n=e("@aimpact/ailearn-app/components/icons"),o=e("pragmate-ui/components"),l=e("pragmate-ui/icons"),r=e("@aimpact/ailearn-app/coins-layout.widget")}}),N.set("./views/components/error",{hash:3301282445,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorRenderer=function({texts:e,error:t}){return a.default.createElement(i.Alert,{variant:"error"},e[t])};var a=e("react"),i=e("pragmate-ui/alert")}}),N.set("./views/context",{hash:1926894984,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.useModuleContext=t.ModuleContext=void 0;var a=e("react");const i=t.ModuleContext=a.default.createContext({});t.useModuleContext=()=>a.default.useContext(i)}}),N.set("./views/index",{hash:2355559764,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.View=function(e){const t=e.store,a=t.texts,[i,n]=r.useState(t.ready),[o,l]=r.useState(t.view);return(0,u.useBinder)([t],()=>{t.ready!==i&&n(t.ready),l(t.view)}),(0,u.useBinder)([t],()=>l(t.view),"activity.selected"),t.ready?"activity"!==o?r.createElement(s.ModuleView,{...e}):r.createElement(d.ActivityView,{...e,texts:a}):r.createElement(c.Spinner,{active:!0})};var r=e("react"),s=e("./module"),c=e("pragmate-ui/components"),u=e("@beyond-js/react-18-widgets/hooks"),d=e("./activity")}}),N.set("./views/module/content-editable",{hash:3809760213,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ContentEditable=void 0;var d=e("react"),m=e("pragmate-ui/icons");t.ContentEditable=({onSave:e,selector:t="div",className:a,children:i,name:n})=>{const[o,l]=(0,d.useState)(!1);var[i,,]=(0,d.useState)("string"==typeof i?i:"");const r=d.default.useRef(null),s=()=>{l(!o),setTimeout(()=>{var e,t,a=r.current;a&&(e=document.createRange(),t=globalThis.getSelection(),e.selectNodeContents(a),e.collapse(!1),t?.removeAllRanges(),t?.addRange(e),a.focus())},0)};var c=o?"save":"edit",u=o?"pui-editable-selector":"";return d.default.createElement("div",{className:"pui-content-editable"+(a?" "+a:"")},d.default.createElement(t,{ref:r,className:u,contentEditable:o,suppressContentEditableWarning:!0},i),d.default.createElement("div",{className:"pui-content-editable__actions"},o&&d.default.createElement(m.IconButton,{icon:"backArrow",onClick:s}),d.default.createElement(m.IconButton,{icon:c,onClick:async()=>{await e({[n]:r.current?.textContent}),s()}})))}}}),N.set("./views/module/description",{hash:273308871,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleDescription=function({}){const{texts:{module:e},store:t}=(0,n.useModuleContext)(),a=t.model.description??e.description;return i.default.createElement("div",{className:"module-property"},i.default.createElement("h5",null,e.description),i.default.createElement(o.ContentEditable,{name:"description",onSave:async({target:e})=>{t.save({[e.name]:e.value})},selector:"p"},a))};var i=e("react"),n=e("../context"),o=e("@aimpact/ailearn-app/components/ui")}}),N.set("./views/module/header",{hash:2642704310,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Header=function(){const{texts:e,store:t,texts:{module:a},ensureCredits:i}=(0,c.useModuleContext)(),n=t.model.title??a.title,[o,l]=s.default.useState(t.model.picture);return(0,m.useBinder)([t.model],()=>l(t.model.picture),"image.generated"),s.default.createElement("section",null,s.default.createElement("header",{className:"header-module__container flex-container flex-space-between"},s.default.createElement("section",{className:"header-container module-header-description "},s.default.createElement(d.CoverImage,{title:e.picture.title,description:e.picture.description,suggestions:t.model.pictureSuggestions,picture:o,onGenerate:e=>i(e=>t.model.generatePicture(e),e)}),s.default.createElement("div",null,s.default.createElement(r.ContentEditable,{name:"title",as:"h3",onSave:e=>{p.LayoutBroker.trimBreadcrumb(1),p.LayoutBroker.addBreadcrumb([e.target.value,""]),t.save({title:e.target.value})}},n),s.default.createElement("div",{className:"module__owner"},s.default.createElement("strong",null,e.module.owner,": "),t.model.owner?.name)),s.default.createElement(u.PublishModule,null))))};var r=e("@aimpact/ailearn-app/components/ui"),s=e("react"),c=e("../context"),u=e("./publish"),d=e("@aimpact/ailearn-app/components/cover-image.code"),m=e("@beyond-js/react-18-widgets/hooks"),p=e("@aimpact/ailearn-app/coins-layout.widget")}}),N.set("./views/module/index",{hash:4210474825,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleView=function(e){const t=e.store,[a,i]=(0,y.useTexts)(g.module.specifier),[n,o]=d.useState(t.fetching),[l]=d.useState(0),[r,s]=d.useState(t.model?.activities?.items),[,c]=d.useState();var u;return(0,m.useBinder)([t.model],()=>o(t?.model?.fetching)),(0,m.useBinder)([t],()=>s(t.model?.activities?.items)),(0,m.useBinder)([t.model],()=>{s(t.model?.activities?.items)},"activities.generated"),(0,m.useBinder)([t],()=>c(t.editActivity),"activity.selected"),a&&t.ready?(e={store:t,fetching:n,texts:i,activePanel:l,activities:r,onSubmit:async e=>{e.preventDefault(),o(!0),await t.save(),globalThis.setTimeout(()=>{o(!1)},1e3)},ensureCredits:v.LayoutBroker.ensureCredits,totalActivities:t.model?.activities?.length},u=" "+(n?"is-fetching":""),d.createElement(f.ModuleContext.Provider,{value:e},d.createElement(h.Header,null),d.createElement(p.PageContainer,{className:u,fetching:n&&!!t.model?.activities.length},d.createElement(b.ModuleManagement,null)))):null};var d=e("react"),m=e("@beyond-js/react-18-widgets/hooks"),p=e("@aimpact/ailearn-app/components/ui"),v=e("@aimpact/ailearn-app/coins-layout.widget"),f=e("../context"),y=e("@aimpact/chat/shared/hooks"),g=e("beyond_context"),h=e("./header"),b=e("./management")}}),N.set("./views/module/management",{hash:476078848,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleManagement=function(){var{store:e,texts:{module:t}}=(0,n.useModuleContext)();return e.model.title??t.title,(0,o.useBinder)([e.model],()=>{},"activities.updated"),a.default.createElement("div",{className:"app-module-creation-page"},a.default.createElement("section",null,a.default.createElement("div",{className:"module-property"},a.default.createElement("h5",null,t.objective,":"),a.default.createElement("p",null," ",e.model.objective)),a.default.createElement(l.ModuleDescription,null)),a.default.createElement(i.ModuleActivities,null))};var a=e("react"),i=e("../activities"),n=e("../context"),o=e("@beyond-js/react-18-widgets/hooks"),l=e("./description")}}),N.set("./views/module/publish",{hash:457822517,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PublishModule=function(){const{store:e,texts:t}=(0,n.useModuleContext)(),a={disabled:"draft"!==e.model.type||!e.model.completed};return i.default.createElement("div",{className:"publish-action__container"},i.default.createElement(o.Button,{fetching:e.fetching,onClick:async()=>{try{(await e.publish()).status?(l.toast.success(t.toast.modulePublished),r.routing.pushState("/modules/list?tab=published")):s.LayoutBroker.showMessage("error",t.errors.CONTACT_ADMIN)}catch(e){console.log("error",e),l.toast.error(t.toast.errorPublishingModule)}},variant:"primary",...a},t.actions.publish))};var i=e("react"),n=e("../context"),o=e("pragmate-ui/components"),l=e("pragmate-ui/toast"),r=e("@beyond-js/kernel/routing"),s=e("@aimpact/ailearn-app/coins-layout.widget")}}),N.set("./views/module/title",{hash:879033848,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleTitle=function({}){const{texts:{module:e},store:t}=(0,n.useModuleContext)(),a=t.model.title??e.title;return i.default.createElement("div",{className:"module-property"},i.default.createElement("strong",null,e.title),i.default.createElement(o.ContentEditable,{name:"title",onSave:async e=>{await t.save(e)},selector:"p"},a))};var i=e("react"),n=e("../context"),o=e("./content-editable")}}),I.exports.descriptor=[{im:"./controller",from:"Controller",name:"Controller"},{im:"./views/activity",from:"ActivityView",name:"ActivityView"},{im:"./views/components/ai-button",from:"AIButton",name:"AIButton"},{im:"./views/components/ai-button",from:"AIIconButton",name:"AIIconButton"},{im:"./views/index",from:"View",name:"View"},{im:"./views/module/header",from:"Header",name:"Header"},{im:"./views/module/index",from:"ModuleView",name:"ModuleView"}],I.exports.process=function({require:e,prop:t,value:a}){!e&&"Controller"!==t||i("Controller",e?e("./controller").Controller:a),!e&&"ActivityView"!==t||i("ActivityView",e?e("./views/activity").ActivityView:a),!e&&"AIButton"!==t||i("AIButton",e?e("./views/components/ai-button").AIButton:a),!e&&"AIIconButton"!==t||i("AIIconButton",e?e("./views/components/ai-button").AIIconButton:a),!e&&"View"!==t||i("View",e?e("./views/index").View:a),!e&&"Header"!==t||i("Header",e?e("./views/module/header").Header:a),!e&&"ModuleView"!==t||i("ModuleView",e?e("./views/module/index").ModuleView:a)},i("__beyond_pkg",I),i("hmr",new function(){this.on=(e,t)=>I.hmr.on(e,t),this.off=(e,t)=>I.hmr.off(e,t)}),I.initialise(N)}}});