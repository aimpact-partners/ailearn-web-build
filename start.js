System.register(["@beyond-js/kernel@0.1.9/bundle","@beyond-js/kernel@0.1.9/transversals","@beyond-js/widgets@1.1.0/render","@aimpact/ailearn-app@0.1.6-dev.28/model/wrapper","@aimpact/chat-sdk@1.1.0/session","@beyond-js/kernel@0.1.9/routing","react@18.2.0","pragmate-ui@1.0.0-beta.6/icons","pragmate-ui@1.0.0-beta.6/image","@beyond-js/reactive@1.2.0/model","@aimpact/ailearn-app@0.1.6-dev.28/model/gclassroom","@aimpact/ailearn-sdk@1.0.0/core","@aimpact/ailearn-app@0.1.6-dev.28/config","@aimpact/chat-sdk@1.1.0/startup"],function(a,e){"use strict";var i,t,s,r,n,o,p,c,l,m,u,d,g,v,h;return{setters:[function(a){},function(a){i=a},function(a){t=a},function(a){s=a},function(a){r=a},function(a){n=a},function(a){o=a},function(a){p=a},function(a){c=a},function(a){l=a},function(a){m=a},function(a){u=a},function(a){d=a},function(a){g=a}],execute:function(){v=brequire("@beyond-js/kernel/transversals").Transversal,a("__beyond_transversal",v=new v("start","")),v.dependencies.update([["@beyond-js/kernel/transversals",i],["@beyond-js/widgets/render",t],["@aimpact/ailearn-app/model/wrapper",s],["@aimpact/chat-sdk/session",r],["@beyond-js/kernel/routing",n],["react",o],["pragmate-ui/icons",p],["pragmate-ui/image",c],["@beyond-js/reactive/model",l],["@aimpact/ailearn-app/model/gclassroom",m],["@aimpact/ailearn-sdk/core",u],["@aimpact/ailearn-app/config",d],["@aimpact/chat-sdk/startup",g]]),(h=brequire("@beyond-js/widgets/render").widgets).register([{name:"auth-layout",vspecifier:"@aimpact/auth@0.0.1/auth-layout",is:"layout"},{name:"auth-login-page",vspecifier:"@aimpact/auth@0.0.1/auth-login.widget",is:"page",route:"/auth/login",layout:"auth-layout"},{name:"aimpact-login-presentation",attrs:["dynamic-children"],vspecifier:"@aimpact/auth@0.0.1/auth/login/presentation.widget"},{name:"auth-recover-password-page",vspecifier:"@aimpact/auth@0.0.1/auth-recover-password.widget",is:"page",route:"/auth/recover-password",layout:"auth-layout"},{name:"auth-recovery-page",vspecifier:"@aimpact/auth@0.0.1/auth-recovery.widget",is:"page",route:"/auth/recovery",layout:"auth-layout"},{name:"auth-register-page",vspecifier:"@aimpact/auth@0.0.1/auth-register.widget",is:"page",route:"/auth/register",layout:"auth-layout"},{name:"chat-sdk-markdown-page",vspecifier:"@aimpact/chat-sdk@1.1.0/tests/markdown",is:"page",route:"/chat/sdk/markdown",layout:"general-layout"},{name:"chat-sdk-playable",vspecifier:"@aimpact/chat-sdk@1.1.0/tests/playable",is:"page",route:"/chat/sdk/playable"},{name:"coming-soon",vspecifier:"pragmate-ui@1.0.0-beta.6/coming-soon",is:"page",route:"/components/coming-soon"},{name:"pui-template-view-widget",vspecifier:"pragmate-ui@1.0.0-beta.6/pui/template/palette"},{name:"app-ailearn-components-page",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/components/ui/page",is:"page",route:"/ui/components/test"},{name:"ailearn-session-dashboard",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/assignments/dashboard.widget",is:"page",route:"/assignments/${id}/dashboard/classroom",layout:"dashboard-layout"},{name:"old-assignment-dashboard-participant",attrs:["id","participant-id"],vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/assignment-dashboard-participant.widget",is:"page",route:"/assignments/${assignmentId}/dashboard/participant/${participantId}",layout:"dashboard-layout"},{name:"dashboard-wall",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/dashboard-wall.widget",is:"page",route:"/assignments/${id}/wall",layout:"dashboard-layout"},{name:"ailearn-sessions-access",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/sessions/access.widget",is:"page",route:"/sessions/access/${id}",layout:"chat-layout"},{name:"ailearn-assignments-all-in-one",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/assignments/all-in-one.widget",is:"page",route:"/assignments/${assignmentId}/all-in-one/${id}",layout:"chat-layout"},{name:"ailearn-assignments-assessment",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/assignments/assessment.widget",is:"page",route:"/assignments/${assignmentId}/assessment/${id}",layout:"main-layout"},{name:"ailearn-character-talk",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/assignments/character-talk.widget",is:"page",route:"/assignments/${assignmentId}/character-talk/${activityId}/chat/${chatId}",layout:"main-layout"},{name:"ailearn-content-theory-page",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/assignments/content-theory.widget",is:"page",route:"/assignments/${assignmentId}/content-theory/${activityId}/chat/${chatId}",layout:"main-layout"},{name:"ailearn-debate-activity-page",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/assignments/debate.widget",is:"page",route:"/assignments/${assignmentId}/debate/${activityId}/chat/${chatId}",layout:"main-layout"},{name:"ailearn-assignments-spoken",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/assignments/spoken.widget",is:"page",route:"/assignments/${assignmentId}/spoken/${id}",layout:"main-layout"},{name:"ailearn-assignments-coach-list",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/assignments/coach/list.widget",is:"page",route:"/assignments/${id}/coach/list",layout:"main-layout"},{name:"ailearn-assignments-student-list",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/assignments/student/list.widget",is:"page",route:"/assignments/${id}/student/list",layout:"main-layout"},{name:"ailearn-gclassroom-permissions",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/gclassroom-permissions.widget"},{name:"ailearn-assignment-view",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/assignment/view.widget",is:"page",route:"/assignments/${id}",layout:"main-layout"},{name:"ailearn-gclassrooms-access",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/gclassroom/access.widget",is:"page",route:"/gclassroom/access",layout:"chat-layout"},{name:"app-classrooms-create",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/classrooms/create.widget",is:"page",route:"/classrooms/create",layout:"main-layout"},{name:"ailearn-gclassroom-explorer",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/gclassroom-explorer.widget"},{name:"ailearn-classroom-join",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/classrooms/join.widget",is:"page",route:"/classrooms/join",layout:"main-layout"},{name:"ailearn-classroom-list",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/classrooms/list.widget",is:"page",route:"/classrooms/list",layout:"main-layout"},{name:"app-classrooms-view",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/classrooms/view.widget",is:"page",route:"/classrooms/view/${id}",layout:"main-layout"},{name:"ailearn-community-modules",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/community.widget",is:"page",route:"/community",layout:"main-layout"},{name:"ailearn-modules-list",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/modules/list.widget",is:"page",route:"/modules/list",layout:"main-layout"},{name:"app-modules-management",attrs:["id","activityId"],vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/modules/management/settings.widget"},{name:"app-module-objective-management",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/modules/draft.widget",is:"page",route:"/modules/management",layout:"main-layout"},{name:"app-organizations-create",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/organizations/create.widget",is:"page",route:"/organizations/create",layout:"main-layout"},{name:"ailearn-organization-join",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/organizations/join.widget",is:"page",route:"/organizations/join",layout:"main-layout"},{name:"ailearn-organizations-list",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/organizations/list.widget",is:"page",route:"/organizations/list",layout:"main-layout"},{name:"app-organizations-view",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/organizations/view.widget",is:"page",route:"/organizations/view/${id}",layout:"main-layout"},{name:"ailearn-user-profile",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/user/profile.widget",is:"page",route:"/users/me",layout:"main-layout"},{name:"dashboard-layout",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/dashboard-layout.widget",is:"layout"},{name:"ailearn-empty-layout",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/layout/empty",is:"layout"},{name:"main-layout",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/main-layout.widget",is:"layout"},{name:"app-policies-page",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/pages/age.widget",is:"page",route:"/user-validation"},{name:"app-not-allowed",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/not-allowed-control.widget"},{name:"app-not-allowed-page",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/not-allowed-page.widget"},{name:"app-missing-control",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/missing.widget"},{name:"app-missing-page",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/missing-page.widget",is:"page",route:"/error-404",layout:"main-layout"},{name:"app-system-error-control",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/system-error-widget.widget"},{name:"app-system-error-page",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/system-error.widget",is:"page",route:"/error-500",layout:"main-layout"},{name:"student-home",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/home.widget",is:"page",route:"/",layout:"main-layout"},{name:"ailearn-identify-page",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/identify.widget",is:"page",route:"/next-steps"},{name:"privacy-page",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/pages/privacy",is:"page",route:"/privacy"},{name:"ailearn-terms-and-conditions-page",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/pages/terms",is:"page",route:"/terms-and-conditions"},{name:"app-template-bottom-bar",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/template/bottom-bar",is:"page",route:"/template/bottom-bar"},{name:"ailearn-ui-components",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/ui/components",is:"page",route:"/ui/components",layout:"main-layout"},{name:"app-updating-page",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/pages/updating.widget",is:"page",route:"/updating"},{name:"app-test-components",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/test/blank",is:"page",route:"/tests/blank"},{name:"app-test-web-component",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/test/web-component"},{name:"app-breadcrumb",vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/widgets/breadcrumb.widget"}]),(h=[]).push([{module:{vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/routing"},type:"start"},function(a,e){return a.set("./handlers/home",{hash:3464692361,creator:function(a,e){Object.defineProperty(e,"__esModule",{value:!0}),e.checkHome=async function({},a,e){return e()}}}),a.set("./handlers/policies",{hash:779423052,creator:function(a,e){Object.defineProperty(e,"__esModule",{value:!0}),e.checkPolicies=async function(a,e,i){await o.sessionWrapper.isReady,await o.sessionWrapper?.user?.isReady;var{pathname:t,uri:s}=a,{termsAccepted:r,age:n}=o.sessionWrapper.user;return p.PUBLIC_ROUTES.includes(t)?s:!r&&17<n||!n?(t&&"/user-validation"!==t&&(e.previous=a),{pathname:"/user-validation"}):"/user-validation"===t&&r&&17<n?{pathname:"/"}:i()};var o=a("@aimpact/chat-sdk/session"),p=a("../public-routes")}}),a.set("./handlers/roles",{hash:2363238694,creator:function(a,e){Object.defineProperty(e,"__esModule",{value:!0}),e.checkRoles=async function(a,e,i){var t=a.pathname;return await s.sessionWrapper.isReady,/^\/assignments\/.+$/.test(t)?i():"/next-steps"===t&&s.sessionWrapper.user?.roles.length?{pathname:"/"}:s.sessionWrapper.user.roles.length||function(a){for(const e of["/users/me","/organizations/create","/organizations/join"])if(a.includes(e))return 1}(a.uri)?i():{pathname:"/next-steps"}};var s=a("@aimpact/chat-sdk/session")}}),a.set("./handlers/session",{hash:753105696,creator:function(a,e){Object.defineProperty(e,"__esModule",{value:!0}),e.checkSession=async function(a,e,i){var t=a.pathname;return await s.sessionWrapper.isReady,!s.sessionWrapper.logged&&r.PUBLIC_ROUTES.includes(t)?{pathname:t}:s.sessionWrapper.logged&&s.sessionWrapper.user?.outdated?{pathname:"/updating"}:s.sessionWrapper.logged&&r.AUTH_ROUTES.includes(t)?{pathname:"/"}:!r.AUTH_ROUTES.includes(t)&&r.PUBLIC_ROUTES.includes(t)||s.sessionWrapper.logged?i(n.Router.getAndCleanPreviousUrl()):("/"!==t&&(e.previous=a),{pathname:o})};var s=a("@aimpact/chat-sdk/session"),i=a("@beyond-js/kernel/routing"),r=a("../public-routes"),n=a("../router");const o="/auth/login";s.sessionWrapper.on("logout",()=>{i.routing.replaceState({},"","/")})}}),a.set("./public-routes",{hash:2866617319,creator:function(a,e){Object.defineProperty(e,"__esModule",{value:!0}),e.PUBLIC_ROUTES=e.AUTH_ROUTES=void 0,e.PUBLIC_ROUTES=["/auth/login","/auth/register","/auth/recovery","/auth/recover-password","/documents/access","/privacy","/terms-and-conditions","/reactive/testing"],e.AUTH_ROUTES=["/auth/login","/auth/register","/auth/recovery","/auth/recover-password"]}}),a.set("./router",{hash:3798936497,creator:function(a,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Router=void 0;let i;e.Router=class{#isDefault;get isDefault(){return"/"===this.#pathname}#pathname;get pathname(){return this.#pathname}#data;get data(){return this.#data}#previous;get previous(){return i}set previous(a){"/"!==a?.pathname&&a?.uri!==this.#previous?.uri&&(this.#previous=a,i=a)}#index;#handlers;constructor(a){if(!Array.isArray(a))throw new Error("handlers must be an array");a.forEach(a=>{if("function"!=typeof a)throw new Error("handlers must be an array of functions")}),this.#handlers=a}async process(e,i){return this.#handlers.length?await this.#handlers[e](i,this,async a=>(a=a||i,e<this.#handlers.length-1?this.process(e+1,a):a)):i.uri}async validate(a){return this.#handlers.length?this.process(0,a):a}static getPreviousUrl(){return i}static getAndCleanPreviousUrl(){var a=i;return i=void 0,a}static cleanPreviousUrl(){i=void 0}}}}),a.set("./routing",{hash:228018459,creator:function(a,e){var i=a("@beyond-js/kernel/routing"),t=a("./handlers/policies"),s=a("./handlers/roles"),r=a("./handlers/session"),n=a("./router"),o=a("@aimpact/chat-sdk/session"),a=[r.checkSession,t.checkPolicies,s.checkRoles];const p=new n.Router(a);globalThis.router=p,i.routing.redirect=async function(a){try{return o.sessionWrapper.on("logout",()=>{i.routing.replaceState({},"","/"),p.previous=void 0}),(await p.validate(a)).pathname}catch(a){return console.error(a),"/error-500"}},i.routing.missing=async function(){return"app-missing-page"}}}),e.descriptor=[{im:"./router",from:"Router",name:"Router"}],{dependencies:["@aimpact/ailearn-app/model/wrapper","@aimpact/chat-sdk/session","@beyond-js/kernel/routing"]}}]),h.push([{module:{vspecifier:"@aimpact/ailearn-app@0.1.6-dev.28/initialize-app"},type:"start"},function(a,e){return a.set("./extensions",{hash:2049006555,creator:function(a,e){}}),a.set("./icons/profile",{hash:2038903291,creator:function(a,e){Object.defineProperty(e,"__esModule",{value:!0}),e.ProfileIcon=void 0;var s=a("react"),r=a("pragmate-ui/icons"),n=a("@aimpact/chat-sdk/session"),o=a("pragmate-ui/image");e.ProfileIcon=({onClick:a})=>{const[e,i]=s.default.useState(!1);var t;if(n.sessionWrapper.user)return t=n.sessionWrapper.user.getProperties(),s.default.createElement("div",{className:"aside-item",onClick:a},e?s.default.createElement(r.Icon,{className:"lg",icon:"user"}):s.default.createElement(o.Image,{alt:"user image profile",src:t.photoURL,onError:()=>i(!0)}))}}}),a.set("./index",{hash:1018057204,creator:function(a,e){a=a("./startup"),globalThis.localStorage?.setItem("chat.app.user.default.profile","/assets/rvd-profile-blue.png"),a.Startup.setup()}}),a.set("./startup",{hash:2790733772,creator:function(a,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Startup=void 0;var i=a("@beyond-js/reactive/model"),t=a("@beyond-js/widgets/render"),s=a("@aimpact/ailearn-app/model/gclassroom"),r=a("@aimpact/chat-sdk/session"),n=a("@aimpact/ailearn-sdk/core"),o=a("@aimpact/ailearn-app/config"),p=a("@aimpact/chat-sdk/startup");class c extends i.ReactiveModel{constructor(){super(),this.#start()}#initSDK=async()=>{var a=o.default.environment;await p.sdkConfig.initialize({environment:a,userModel:n.User})};#start=async()=>{await this.#initSDK();var a=[s.gclassroom.isReady,r.sessionWrapper.isReady];await Promise.all(a),this.checkMode()};checkMode(){var a=localStorage.getItem("aimpact.accessibility.mode")?localStorage.getItem("aimpact.accessibility.mode"):"normal",e=document.querySelector("html");e&&(e.setAttribute("data-accessibility-mode",a),t.widgets.attributes.add("data-accessibility-mode",a))}static setup(){new c}}e.Startup=c}}),e.descriptor=[{im:"./icons/profile",from:"ProfileIcon",name:"ProfileIcon"}],{dependencies:["react","pragmate-ui/icons","@aimpact/chat-sdk/session","pragmate-ui/image","@beyond-js/reactive/model","@beyond-js/widgets/render","@aimpact/ailearn-app/model/gclassroom","@aimpact/ailearn-sdk/core","@aimpact/ailearn-app/config","@aimpact/chat-sdk/startup"]}}]),v.initialise(h)}}});