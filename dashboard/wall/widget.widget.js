System.register(["@beyond-js/widgets@1.1.0/render","@beyond-js/kernel@0.1.9/bundle","@beyond-js/kernel@0.1.9/styles","@beyond-js/react-18-widgets@1.1.2/base","@aimpact/ailearn-app@0.1.13/dashboard-layout.widget","@aimpact/ailearn-sdk@1.0.0/core","@beyond-js/reactive@1.2.0/model","@beyond-js/kernel@0.1.9/texts","react@18.2.0","@aimpact/chat-sdk@1.3.0/session","@aimpact/ailearn-app@0.1.13/components/icons","pragmate-ui@1.0.0-beta.6/list","pragmate-ui@1.0.0-beta.6/icons","@aimpact/ailearn-app@0.1.13/components/ui","@aimpact/ailearn-app@0.1.13/components/navbar-header.code","@aimpact/ailearn-app@0.1.13/config","@beyond-js/react-18-widgets@1.1.2/hooks","react@18.2.0/jsx-runtime"],function(n,e){var t,a,r,s,o,i,l,c,d,u,m,p,f,h,g,v,b,w,y,x;return n({Controller:void 0,Content:void 0,Header:void 0,View:void 0}),{setters:[function(e){t=e},function(e){a=e},function(e){r=e},function(e){s=e},function(e){o=e},function(e){i=e},function(e){l=e},function(e){c=e},function(e){d=e},function(e){u=e},function(e){m=e},function(e){p=e},function(e){f=e},function(e){h=e},function(e){g=e},function(e){v=e},function(e){b=e},function(e){w=e}],execute:function(){x=a.Bundle,(y=new x({module:{vspecifier:"@aimpact/ailearn-app@0.1.13/dashboard/wall/widget",multibundle:!0},type:"widget"},e.meta.url).package()).dependencies.update([["@beyond-js/widgets/render",t],["@beyond-js/kernel/styles",r],["@beyond-js/react-18-widgets/base",s],["@aimpact/ailearn-app/dashboard-layout.widget",o],["@aimpact/ailearn-sdk/core",i],["@beyond-js/reactive/model",l],["@beyond-js/kernel/texts",c],["react",d],["@aimpact/chat-sdk/session",u],["@aimpact/ailearn-app/components/icons",m],["pragmate-ui/list",p],["pragmate-ui/icons",f],["@aimpact/ailearn-app/components/ui",h],["@aimpact/ailearn-app/components/navbar-header.code",g],["@aimpact/ailearn-app/config",v],["@beyond-js/react-18-widgets/hooks",b],["react/jsx-runtime",w]]),brequire("@beyond-js/widgets/render").widgets.register([{name:"app-dashboard-wall",attrs:["id"],vspecifier:"@aimpact/ailearn-app@0.1.13/dashboard/wall/widget.widget"}]),brequire("@beyond-js/kernel/styles").styles.register("@aimpact/ailearn-app@0.1.13/dashboard/wall/widget.widget"),(x=new Map).set("./controller",{hash:1186926415,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Controller=void 0;var a=e("@beyond-js/react-18-widgets/base"),n=e("./store"),r=e("./views"),s=e("@aimpact/ailearn-app/dashboard-layout.widget");class o extends a.ReactWidgetController{#store;createStore(){return this.#store=new n.StoreManager(this.attributes),this.#store}get Widget(){return r.View}show(){this.#store.load(this.uri.vars.get("id"))}hide(){s.LayoutBroker.removeOverlay()}}t.Controller=o}}),x.set("./interface",{hash:3506573663,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}}),x.set("./store",{hash:50706083,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.StoreManager=void 0;var a=e("@aimpact/ailearn-sdk/core"),n=e("@beyond-js/reactive/model"),r=e("@beyond-js/kernel/texts"),s=e("beyond_context");class o extends n.ReactiveModel{#model;get model(){return this.#model}#items;get items(){return this.#items}#id;get id(){return this.#id}#assignment;get assignment(){return this.#assignment}#texts=new r.CurrentTexts(s.module.specifier);get texts(){return this.#texts?.value}get ready(){return super.ready&&this.#texts.ready}constructor(e){super(),this.#texts.on("change",this.triggerEvent),this.load(e.get("id"))}refresh=async()=>{try{this.fetching=!0;var e=(await this.model.load({id:this.#id})).messages;this.#items=e}catch(e){console.error(e)}finally{this.fetching=!1}};async load(e){try{this.#assignment=new a.Assignment({id:e}),this.#model=new a.DashboardWall,this.#id=e;var t=(await this.#model.load({id:e})).messages;await this.#assignment.load({id:e}),this.#items=t,super.ready=!0,this.triggerEvent()}catch(e){console.error(e)}}}t.StoreManager=o}}),x.set("./views/components/profile-icon",{hash:1084605189,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ProfileIcon=function({role:e}){let[t,a]=(0,s.useState)(!1),n=("user"!==e&&globalThis.localStorage.getItem("chat.app.user.default.profile"),o.sessionWrapper.user.getProperties()),r="user"===e?n.photoURL:globalThis.localStorage.getItem("chat.app.user.default.profile");return s.default.createElement("picture",{className:"picture__container"},n.photoURL&&!t||"user"!==e?s.default.createElement("img",{alt:"user image profile",src:r,onError:()=>a(!0)}):s.default.createElement(i.AppIcon,{className:"lg",icon:"user"}))};var s=e("react"),o=e("@aimpact/chat-sdk/session"),i=e("@aimpact/ailearn-app/components/icons")}}),x.set("./views/content/index",{hash:2680141398,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Content=void 0;var a=e("react"),n=e("../context"),r=e("./item"),s=e("pragmate-ui/list");t.Content=()=>{var e=(0,n.useWallDashboardContext)().items;return a.default.createElement(s.List,{className:"wall__container",items:e,control:r.Item})}}}),x.set("./views/content/item",{hash:1300636804,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Item=function({data:e}){var{}=(0,n.useWallDashboardContext)();return a.default.createElement("div",{className:"wall-container",id:e.time},a.default.createElement("p",{className:"title-activity h3"},e.activity.title),a.default.createElement(r.Message,{role:"user",text:e.prompt.content,user:e.user}),a.default.createElement(r.Message,{role:"system",text:e.answer.content,user:void 0}))};var a=e("react"),n=e("../context"),r=e("./message")}}),x.set("./views/content/message",{hash:2364017378,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Message=function({role:e,text:t,user:a}){let[n,r]=(0,o.useState)(!1),s="wall "+e;return o.default.createElement("div",{className:s},o.default.createElement("section",{className:"picture__container"},o.default.createElement(i.ProfileIcon,{role:e,photoUrl:a?.photoUrl})),o.default.createElement("section",{className:"wall-message__container"},o.default.createElement("div",{className:"message-text__container expand-"+n},a&&o.default.createElement("p",{className:"message-user__label-text p2"},a.name),o.default.createElement("p",{className:"message__label-text p2 expand-"+n},(e=n?5e3:280,(a=t).length>e?a.slice(0,e)+"...":a)))),o.default.createElement("section",{className:"wall-actions__container"},o.default.createElement(l.IconButton,{onClick:function(){r(!n)},className:"md",icon:n?"arrowDropUp":"arrowDropDown"})))};var o=e("react"),i=e("../components/profile-icon"),l=e("pragmate-ui/icons")}}),x.set("./views/context",{hash:1277739422,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.useWallDashboardContext=t.WallDashboardContext=void 0;var a=e("react");let n=t.WallDashboardContext=a.default.createContext({});t.useWallDashboardContext=()=>a.default.useContext(n)}}),x.set("./views/empty",{hash:3693986805,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyList=function(){var e=(0,r.useWallDashboardContext)().texts;return a.default.createElement(n.EmptyCard,{text:e.emptyTitle,description:e.empty,icon:"info"})};var a=e("react"),n=e("@aimpact/ailearn-app/components/ui"),r=e("./context")}}),x.set("./views/header",{hash:2381242925,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Header=function(){var e=(0,r.useWallDashboardContext)().store;return n.default.createElement(n.default.Fragment,null,n.default.createElement(a.NavbarHeader,{breadcrumb:[["Assignment",`/assignments/${e.id}/dashboard/classroom`],["Wall",""]]},n.default.createElement(s.IconButton,{icon:"refresh",onClick:e.refresh})))};var a=e("@aimpact/ailearn-app/components/navbar-header.code"),n=e("react"),r=e("./context"),s=e("pragmate-ui/icons")}}),x.set("./views/index",{hash:4201799843,creator:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.View=function({store:e}){let[t,a]=i.default.useState({});var n,r;return(0,o.useBinder)([e],()=>{a({ready:e.ready,fetching:e.fetching,items:e.items})}),t.ready?(r=e.items.length,n={texts:n=e.texts,store:e,items:e.items,fetching:e.fetching,totalItems:r},r=0<e.items.length?c.Content:d.EmptyList,i.default.createElement(l.WallDashboardContext.Provider,{value:n},i.default.createElement(s.PageContainer,null,i.default.createElement(r,null)))):i.default.createElement(s.PageLoader,{fetching:t.fetching})};var s=e("@aimpact/ailearn-app/components/ui"),o=e("@beyond-js/react-18-widgets/hooks"),i=e("react"),l=e("./context"),c=e("./content"),d=e("./empty")}}),y.exports.descriptor=[{im:"./controller",from:"Controller",name:"Controller"},{im:"./views/content/index",from:"Content",name:"Content"},{im:"./views/header",from:"Header",name:"Header"},{im:"./views/index",from:"View",name:"View"}],y.exports.process=function({require:e,prop:t,value:a}){!e&&"Controller"!==t||n("Controller",e?e("./controller").Controller:a),!e&&"Content"!==t||n("Content",e?e("./views/content/index").Content:a),!e&&"Header"!==t||n("Header",e?e("./views/header").Header:a),!e&&"View"!==t||n("View",e?e("./views/index").View:a)},n("__beyond_pkg",y),n("hmr",new function(){this.on=(e,t)=>y.hmr.on(e,t),this.off=(e,t)=>y.hmr.off(e,t)}),y.initialise(x)}}});